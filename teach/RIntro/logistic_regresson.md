---
title: "DFO training: Logistic Regression"
date: "2024-06-28"
output:
  html_document:
    toc: true
    toc_depth: 3
    number_sections: true
    keep_md: true
    toc_float:
      collapsed: false
      smooth_scroll: false
  pdf_document:
    toc: true
    toc_depth: '3'
  word_document:
    toc: true
    toc_depth: '3'
---



# **Logistic regression**

## Objectives

* Learn main uses of logistic regressions  
* Describe logistic regression assumptions    
* Apply models to your own data using R programming language  
* Interpret model fits and results   

## What is a logistic regression?

* Used to understand association between binary response variable and predictors 
* Example: species distribution models 
    + Binary response variable: presence (1) or absence (0) of species in area
    + Results in predictions of habitat suitability

## How are logistic regressions different from linear regressions?

*Linear regression*  
- Quantitative outcomes are predicted based on value of predictors using straight line  
- We calculate correlation and test for significance of regression  
- We compare different types of model, from more simple, with single predictors, to more complicated, with several predictors and interactions, and then find the ones that provide a best fit to our data  

*Logistic regression*  
- We can also do all of that!  
- Main difference: our outcomes are *binary* as opposed to continuous measurements  
- Examples of binary outcomes: presence versus absence; positive to a disease versus negative; dead versus alive  
- Outcomes can be categorized as 1 (e.g., success) and 0 (e.g., failure)
- In the case of Hamilton Harbour dataset, let's suppose that it becomes hard for zooplankton to eat when there are more "less edible" algae than "edible" algae in the environment (that was the criteria for populating the column "Easy to eat":)


| Nitrate/nitrite|  Edible| Less edible|Easy to eat |
|---------------:|-------:|-----------:|:-----------|
|            2.23|  884.60|      1645.7|yes         |
|            2.50|  900.00|      1133.3|yes         |
|            2.50|  923.20|       939.9|yes         |
|            2.13| 1546.40|      1312.0|no          |
|            2.13|  811.90|       454.1|no          |
|            2.62|  339.16|       308.2|no          |
|            2.67| 1376.80|       552.2|no          |

When we plot this type of binary data, we see that observations are either of the two outcome possibilities.


```{=html}
<div class="plotly html-widget html-fill-item" id="htmlwidget-7467c7c65297c0f2e666" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7467c7c65297c0f2e666">{"x":{"visdat":{"3d2879104474":["function () ","plotlyVisDat"],"3d28454f399a":["function () ","data"]},"cur_data":"3d28454f399a","attrs":{"3d28454f399a":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","text":{},"textposition":"middle right","hoverinfo":"text","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":80,"r":10},"title":"Comparison of edible and less edible phytoplankton","xaxis":{"domain":[0,1],"automargin":true,"title":"Nitrite + Nitrate (mg/L)","gridcolor":"rgba(0,0,0,0)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"How easy is it to eat?","range":[-0.10000000000000001,1.1000000000000001],"gridcolor":"rgba(0,0,0,0)"},"legend":{"orientation":"h","x":0,"y":1},"font":{"size":16},"showlegend":false,"plot_bgcolor":"rgba(0,0,0,0)","paper_bgcolor":"rgba(0,0,0,0)","hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2.5800000000000001,2.4300000000000002,2.23,2.23,2.5,2.5,2.1299999999999999,2.1299999999999999,2.6200000000000001,2.6699999999999999,2.1800000000000002,2.3199999999999998,2.8599999999999999,2.8399999999999999,2.7599999999999998,2.6099999999999999,2.6499999999999999,2.4399999999999999,2.5499999999999998,2.4399999999999999,2.7999999999999998,2.4399999999999999,2.0899999999999999,3.1699999999999999,2.6299999999999999,2,2,2.3199999999999998,2.5800000000000001,2.5800000000000001,2.2000000000000002,2.54,3.3799999999999999,2.6499999999999999,1.8600000000000001,1.8600000000000001,2.1000000000000001,2.1000000000000001,2.04,2.6800000000000002,2.2400000000000002,1.8999999999999999,2.4300000000000002,1.9099999999999999,3.1800000000000002,1.8700000000000001,2.3100000000000001,2.3100000000000001,2.1600000000000001,1.8500000000000001,1.5,2.7200000000000002,2.48,2.48,1.77,2,1.6899999999999999,2.0699999999999998,2.4700000000000002,2.4700000000000002,2.27,1.54,2.2999999999999998,1.9199999999999999,1.74,2.0800000000000001,2.3799999999999999,1.8999999999999999,2.8300000000000001,1.6899999999999999,1.96,3.0800000000000001,1.6799999999999999,1.6599999999999999,1.51,2.0800000000000001,2.3599999999999999,1.74,2.6200000000000001,2.6499999999999999,2.04,2.96,1.6399999999999999,1.78,1.54,1.6799999999999999,1.4299999999999999,1.5600000000000001,1.6399999999999999,1.6499999999999999,1.6499999999999999,1.77,1.75,1.6299999999999999,1.3500000000000001,2.3700000000000001,1.97,2.1099999999999999,1.9399999999999999,2.2400000000000002,2.0499999999999998,2.0499999999999998,1.72,1.8999999999999999,2.7599999999999998,1.4199999999999999,2.0800000000000001,1.52,1.6100000000000001,2.04,2.1299999999999999,1.4099999999999999,1.3899999999999999,1.71,1.4399999999999999,1.8100000000000001,1.72,1.99,3.1000000000000001],"y":[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,1,1,0,0,0,0,1,1,0,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1,0,1,0,1,1,0,1,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,1,1,0,1,0,0,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0],"type":"scatter","mode":"markers","text":["Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat"],"textposition":["middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

This type of data is best fit by an s-shaped curve instead of a line. And this is another difference between linear and logistic regressions.
 
## What does the logistic curve mean?


```{=html}
<div class="plotly html-widget html-fill-item" id="htmlwidget-b4c79b86040623934af3" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b4c79b86040623934af3">{"x":{"visdat":{"3d2813ce5926":["function () ","plotlyVisDat"],"3d2863d72607":["function () ","data"]},"cur_data":"3d2863d72607","attrs":{"3d2813ce5926":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1.3500000000000001,1.3672033898305085,1.3844067796610171,1.4016101694915255,1.4188135593220339,1.4360169491525425,1.4532203389830509,1.4704237288135593,1.4876271186440679,1.5048305084745763,1.522033898305085,1.5392372881355934,1.5564406779661017,1.5736440677966104,1.5908474576271188,1.6080508474576272,1.6252542372881358,1.6424576271186442,1.6596610169491526,1.6768644067796612,1.6940677966101696,1.711271186440678,1.7284745762711866,1.745677966101695,1.7628813559322034,1.780084745762712,1.7972881355932204,1.8144915254237288,1.8316949152542374,1.8488983050847458,1.8661016949152542,1.8833050847457629,1.9005084745762713,1.9177118644067797,1.9349152542372883,1.9521186440677967,1.9693220338983051,1.9865254237288137,2.0037288135593219,2.0209322033898305,2.0381355932203391,2.0553389830508477,2.0725423728813559,2.0897457627118645,2.1069491525423727,2.1241525423728813,2.1413559322033899,2.1585593220338986,2.1757627118644067,2.1929661016949153,2.2101694915254235,2.2273728813559321,2.2445762711864408,2.2617796610169494,2.2789830508474576,2.2961864406779662,2.3133898305084744,2.330593220338983,2.3477966101694916,2.3650000000000002,2.3822033898305088,2.399406779661017,2.4166101694915252,2.4338135593220338,2.4510169491525424,2.468220338983051,2.4854237288135597,2.5026271186440678,2.519830508474576,2.5370338983050846,2.5542372881355933,2.5714406779661019,2.5886440677966105,2.6058474576271187,2.6230508474576268,2.6402542372881355,2.6574576271186441,2.6746610169491527,2.6918644067796613,2.7090677966101695,2.7262711864406781,2.7434745762711863,2.7606779661016949,2.7778813559322035,2.7950847457627122,2.8122881355932203,2.8294915254237289,2.8466949152542371,2.8638983050847457,2.8811016949152544,2.898305084745763,2.9155084745762712,2.9327118644067798,2.949915254237288,2.9671186440677966,2.9843220338983052,3.0015254237288138,3.018728813559322,3.0359322033898306,3.0531355932203388,3.0703389830508474,3.087542372881356,3.1047457627118646,3.1219491525423728,3.1391525423728814,3.1563559322033896,3.1735593220338982,3.1907627118644069,3.2079661016949155,3.2251694915254236,3.2423728813559323,3.2595762711864404,3.2767796610169491,3.2939830508474577,3.3111864406779663,3.3283898305084749,3.3455932203389831,3.3627966101694917,3.3799999999999999],"y":[0.92206453347252348,0.91892952240140702,0.91567993543226311,0.91231252307049093,0.90882402002850338,0.90521115222535053,0.9014706443961733,0.8975992283295311,0.89359365174813499,0.88945068784554882,0.88516714548797049,0.88073988008624737,0.87616580513879005,0.87144190444102143,0.86656524495139819,0.86153299029790709,0.85634241490222196,0.85099091869146659,0.84547604235976503,0.83979548313351238,0.83394711098562324,0.82792898523496417,0.8217393714578336,0.81537675862881187,0.80883987639866406,0.80212771240737546,0.79523952952096599,0.78817488287161264,0.78093363657199411,0.77351597996681831,0.76592244327739489,0.75815391248907604,0.75021164332658929,0.74209727415893278,0.7338128376737878,0.72536077116149378,0.71674392525070585,0.70796557094205026,0.69902940479251541,0.68993955211207203,0.68070056804513324,0.67131743642294728,0.66179556628883929,0.65214078601627368,0.64235933495986419,0.63245785260151333,0.62244336517758703,0.61232326979810292,0.60210531609502571,0.59179758546350936,0.58140846798691714,0.57094663716322169,0.56042102257652227,0.54984078068240261,0.53921526389930152,0.52855398821948096,0.51786659957219394,0.50716283918786575,0.49645250822524006,0.48574543193317099,0.47505142362494651,0.46438024874552541,0.45374158931082437,0.44314500899324794,0.43259991911907603,0.42211554583132288,0.41170089865647053,0.40136474069537309,0.39111556063796976,0.38096154677865646,0.37091056318462501,0.36097012814369606,0.35114739499155889,0.34144913539136551,0.33188172511174641,0.32245113232295042,0.31316290840533806,0.30402218124024866,0.29503365093061179,0.28620158787785294,0.27752983312285895,0.26902180084218386,0.26068048287638945,0.2525084551555043,0.24450788587702918,0.23668054528472107,0.22902781689144408,0.22155070998660942,0.21424987326797237,0.2071256094386919,0.20017789061336838,0.19340637438111641,0.1868104203793664,0.18038910723885815,0.17414124976796533,0.16806541625291449,0.16215994575941864,0.15642296533059616,0.15085240698560495,0.14544602443306662,0.14020140942293746,0.13511600766991105,0.1301871342905887,0.12541198870546988,0.12078766896521016,0.1163111854685276,0.1119794740465595,0.10778940839536547,0.10373781184460495,0.099821468456199713,0.096037133452008747,0.092381542974215289,0.088851423186258244,0.085443498725762998,0.082154500524050503,0.078981173009472799,0.075920280714043983,0.0729686143046651,0.070122996061686843],"type":"scatter","mode":"lines","line":{"color":"black","width":2},"text":"Predicted probabilities","textposition":"middle right","hoverinfo":"text","inherit":true},"3d2813ce5926.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1.3500000000000001,1.3672033898305085,1.3844067796610171,1.4016101694915255,1.4188135593220339,1.4360169491525425,1.4532203389830509,1.4704237288135593,1.4876271186440679,1.5048305084745763,1.522033898305085,1.5392372881355934,1.5564406779661017,1.5736440677966104,1.5908474576271188,1.6080508474576272,1.6252542372881358,1.6424576271186442,1.6596610169491526,1.6768644067796612,1.6940677966101696,1.711271186440678,1.7284745762711866,1.745677966101695,1.7628813559322034,1.780084745762712,1.7972881355932204,1.8144915254237288,1.8316949152542374,1.8488983050847458,1.8661016949152542,1.8833050847457629,1.9005084745762713,1.9177118644067797,1.9349152542372883,1.9521186440677967,1.9693220338983051,1.9865254237288137,2.0037288135593219,2.0209322033898305,2.0381355932203391,2.0553389830508477,2.0725423728813559,2.0897457627118645,2.1069491525423727,2.1241525423728813,2.1413559322033899,2.1585593220338986,2.1757627118644067,2.1929661016949153,2.2101694915254235,2.2273728813559321,2.2445762711864408,2.2617796610169494,2.2789830508474576,2.2961864406779662,2.3133898305084744,2.330593220338983,2.3477966101694916,2.3650000000000002,2.3822033898305088,2.399406779661017,2.4166101694915252,2.4338135593220338,2.4510169491525424,2.468220338983051,2.4854237288135597,2.5026271186440678,2.519830508474576,2.5370338983050846,2.5542372881355933,2.5714406779661019,2.5886440677966105,2.6058474576271187,2.6230508474576268,2.6402542372881355,2.6574576271186441,2.6746610169491527,2.6918644067796613,2.7090677966101695,2.7262711864406781,2.7434745762711863,2.7606779661016949,2.7778813559322035,2.7950847457627122,2.8122881355932203,2.8294915254237289,2.8466949152542371,2.8638983050847457,2.8811016949152544,2.898305084745763,2.9155084745762712,2.9327118644067798,2.949915254237288,2.9671186440677966,2.9843220338983052,3.0015254237288138,3.018728813559322,3.0359322033898306,3.0531355932203388,3.0703389830508474,3.087542372881356,3.1047457627118646,3.1219491525423728,3.1391525423728814,3.1563559322033896,3.1735593220338982,3.1907627118644069,3.2079661016949155,3.2251694915254236,3.2423728813559323,3.2595762711864404,3.2767796610169491,3.2939830508474577,3.3111864406779663,3.3283898305084749,3.3455932203389831,3.3627966101694917,3.3799999999999999],"y":[0.87390050118898011,0.86988990443495973,0.86575564229913071,0.86149479844122712,0.85710447108310706,0.85258178113615413,0.8479238809128965,0.84312796343264518,0.83819127232778001,0.83311111235368474,0.82788486050123122,0.82250997770612488,0.81698402114432778,0.8113046570971868,0.80546967436377881,0.79947699819140605,0.79332470468808514,0.78701103567335928,0.78053441391583545,0.77389345869755588,0.76708700163674337,0.76011410269166557,0.7529740662594574,0.74566645727481973,0.73819111720470254,0.73054817982651288,0.7227380866692269,0.71476160198916028,0.70661982714527571,0.69831421423292239,0.68984657883000922,0.68121911170600813,0.67243438934202282,0.66349538310964362,0.65440546695759672,0.64516842345842962,0.63578844807279411,0.62627015149639509,0.61661855996441317,0.60683911340025642,0.5969376613098113,0.58692045633888856,0.576794145430231,0.56656575853707281,0.55624269487264111,0.54583270669890682,0.53534388068303262,0.52478461687597433,0.51416360539420869,0.50348980091215167,0.49277239509907733,0.4820207871597767,0.47124455266239107,0.46045341085930869,0.44965719072736759,0.43886579597139319,0.42808916925001084,0.41733725589435089,0.40661996739851658,0.39594714496524824,0.38532852339106222,0.37477369557217405,0.36429207790578627,0.35389287685097393,0.34358505689957991,0.33337731019054323,0.3232780279812123,0.31329527416683012,0.30343676101492589,0.29370982725528016,0.28412141863886614,0.27467807105124264,0.26538589623771941,0.25625057016970321,0.24727732405440006,0.23847093796390267,0.22983573703497606,0.22137559016790856,0.21309391113185946,0.20499366196543733,0.19707735854492547,0.18934707817874333,0.1818044690754323,0.17445076152369615,0.16728678061673496,0.16031296034923159,0.15352935891372485,0.14693567502360858,0.14053126509242428,0.13431516110330619,0.12828608900814503,0.12244248750308598,0.11678252703511914,0.11130412890357132,0.10600498433003654,0.1008825733805216,0.095934183634117723,0.091156928503203269,0.086547765120858239,0.082103511721711916,0.077820864452718574,0.073696413560278465,0.069726658909591677,0.065908024801099946,0.062236874057274204,0.058709521360813331,0.055322245832500831,0.052071302843520857,0.048952935062944694,0.045963382746388136,0.04309889327650962,0.040355729970098723,0.037730180170014872,0.035218562643213214,0.032817234308562697,0.030522596320168925,0.028331099533480196,0.026239249382635145,0.024243610198325459],"type":"scatter","mode":"lines","line":{"color":"blue","width":2,"dash":"dash"},"text":"Lower bound","textposition":"middle right","hoverinfo":"text","inherit":true},"3d2813ce5926.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1.3500000000000001,1.3672033898305085,1.3844067796610171,1.4016101694915255,1.4188135593220339,1.4360169491525425,1.4532203389830509,1.4704237288135593,1.4876271186440679,1.5048305084745763,1.522033898305085,1.5392372881355934,1.5564406779661017,1.5736440677966104,1.5908474576271188,1.6080508474576272,1.6252542372881358,1.6424576271186442,1.6596610169491526,1.6768644067796612,1.6940677966101696,1.711271186440678,1.7284745762711866,1.745677966101695,1.7628813559322034,1.780084745762712,1.7972881355932204,1.8144915254237288,1.8316949152542374,1.8488983050847458,1.8661016949152542,1.8833050847457629,1.9005084745762713,1.9177118644067797,1.9349152542372883,1.9521186440677967,1.9693220338983051,1.9865254237288137,2.0037288135593219,2.0209322033898305,2.0381355932203391,2.0553389830508477,2.0725423728813559,2.0897457627118645,2.1069491525423727,2.1241525423728813,2.1413559322033899,2.1585593220338986,2.1757627118644067,2.1929661016949153,2.2101694915254235,2.2273728813559321,2.2445762711864408,2.2617796610169494,2.2789830508474576,2.2961864406779662,2.3133898305084744,2.330593220338983,2.3477966101694916,2.3650000000000002,2.3822033898305088,2.399406779661017,2.4166101694915252,2.4338135593220338,2.4510169491525424,2.468220338983051,2.4854237288135597,2.5026271186440678,2.519830508474576,2.5370338983050846,2.5542372881355933,2.5714406779661019,2.5886440677966105,2.6058474576271187,2.6230508474576268,2.6402542372881355,2.6574576271186441,2.6746610169491527,2.6918644067796613,2.7090677966101695,2.7262711864406781,2.7434745762711863,2.7606779661016949,2.7778813559322035,2.7950847457627122,2.8122881355932203,2.8294915254237289,2.8466949152542371,2.8638983050847457,2.8811016949152544,2.898305084745763,2.9155084745762712,2.9327118644067798,2.949915254237288,2.9671186440677966,2.9843220338983052,3.0015254237288138,3.018728813559322,3.0359322033898306,3.0531355932203388,3.0703389830508474,3.087542372881356,3.1047457627118646,3.1219491525423728,3.1391525423728814,3.1563559322033896,3.1735593220338982,3.1907627118644069,3.2079661016949155,3.2251694915254236,3.2423728813559323,3.2595762711864404,3.2767796610169491,3.2939830508474577,3.3111864406779663,3.3283898305084749,3.3455932203389831,3.3627966101694917,3.3799999999999999],"y":[0.97022856575606686,0.96796914036785431,0.96560422856539552,0.96313024769975475,0.9605435689738997,0.95784052331454694,0.95501740787945011,0.95207049322641701,0.94899603116848996,0.9457902633374129,0.94244943047470975,0.93896978246636986,0.93534758913325233,0.93157915178485606,0.92766081553901758,0.92358898240440812,0.91936012511635878,0.9149708017095739,0.91041767080369462,0.90569750756946887,0.90080722033450311,0.89574386777826276,0.8905046766562098,0.88508705998280401,0.87948863559262558,0.87370724498823804,0.86774097237270509,0.861588163754065,0.8552474459987125,0.84871774570071423,0.84199830772478057,0.83508871327214396,0.82798889731115577,0.82069916520822195,0.81322020838997888,0.80555311886455794,0.79769940242861759,0.78966099038770543,0.78144024962061764,0.77303999082388763,0.76446347478045518,0.75571441650700599,0.74679698714744758,0.73771581349547455,0.72847597504708728,0.71908299850411983,0.70954284967214143,0.69986192272023151,0.69004702679584273,0.68010537001486704,0.67004454087475696,0.65987248716666669,0.64959749249065346,0.63922815050549653,0.62877333707123551,0.61824218046756874,0.60764402989437705,0.59698842248138062,0.58628504905196355,0.57554371890109379,0.56477432385883075,0.55398680191887684,0.54319110071586252,0.53239714113552195,0.5216147813385722,0.51085378147210259,0.50012376933172875,0.48943420722391606,0.47879436026101363,0.46821326630203275,0.45769970773038388,0.44726218523614947,0.43690889374539837,0.42664770061302781,0.41648612616909275,0.40643132668199816,0.39649007977570006,0.38666877231258878,0.37697339072936409,0.36740951379026854,0.35798230770079242,0.34869652350562441,0.33955649667734661,0.33056614878731244,0.32172899113732339,0.31304813022021055,0.30452627486916328,0.29616574494961023,0.2879684814435205,0.2799360577740776,0.27206969221859173,0.26437026125914687,0.25683831372361365,0.24947408557414497,0.24227751520589413,0.23524825912530739,0.22838570788471957,0.22168900215798903,0.21515704885035167,0.2087885371444213,0.20258195439315635,0.19653560177954366,0.19064760967158573,0.18491595260983981,0.17933846387314611,0.17391284957624187,0.16863670226061817,0.16350751394721008,0.15852268862626523,0.15367955416601128,0.14897537362750787,0.14440735597833185,0.13997266620250162,0.13566843480831278,0.1314917667395383,0.12743974969877667,0.12350946189460776,0.11969797922669506,0.11600238192504822],"type":"scatter","mode":"lines","line":{"color":"blue","width":2,"dash":"dash"},"text":"Upper bound","textposition":"middle right","hoverinfo":"text","inherit":true},"3d2863d72607":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","text":{},"textposition":"middle right","hoverinfo":"text","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":80,"r":10},"title":"Comparison of edible and less edible phytoplankton","xaxis":{"domain":[0,1],"automargin":true,"title":"Nitrite + Nitrate (mg/L)","gridcolor":"rgba(0,0,0,0)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Predicted probability","range":[-0.10000000000000001,1.1000000000000001],"gridcolor":"rgba(0,0,0,0)"},"legend":{"orientation":"h","x":0,"y":1},"font":{"size":16},"showlegend":false,"plot_bgcolor":"rgba(0,0,0,0)","paper_bgcolor":"rgba(0,0,0,0)","hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1.3500000000000001,1.3672033898305085,1.3844067796610171,1.4016101694915255,1.4188135593220339,1.4360169491525425,1.4532203389830509,1.4704237288135593,1.4876271186440679,1.5048305084745763,1.522033898305085,1.5392372881355934,1.5564406779661017,1.5736440677966104,1.5908474576271188,1.6080508474576272,1.6252542372881358,1.6424576271186442,1.6596610169491526,1.6768644067796612,1.6940677966101696,1.711271186440678,1.7284745762711866,1.745677966101695,1.7628813559322034,1.780084745762712,1.7972881355932204,1.8144915254237288,1.8316949152542374,1.8488983050847458,1.8661016949152542,1.8833050847457629,1.9005084745762713,1.9177118644067797,1.9349152542372883,1.9521186440677967,1.9693220338983051,1.9865254237288137,2.0037288135593219,2.0209322033898305,2.0381355932203391,2.0553389830508477,2.0725423728813559,2.0897457627118645,2.1069491525423727,2.1241525423728813,2.1413559322033899,2.1585593220338986,2.1757627118644067,2.1929661016949153,2.2101694915254235,2.2273728813559321,2.2445762711864408,2.2617796610169494,2.2789830508474576,2.2961864406779662,2.3133898305084744,2.330593220338983,2.3477966101694916,2.3650000000000002,2.3822033898305088,2.399406779661017,2.4166101694915252,2.4338135593220338,2.4510169491525424,2.468220338983051,2.4854237288135597,2.5026271186440678,2.519830508474576,2.5370338983050846,2.5542372881355933,2.5714406779661019,2.5886440677966105,2.6058474576271187,2.6230508474576268,2.6402542372881355,2.6574576271186441,2.6746610169491527,2.6918644067796613,2.7090677966101695,2.7262711864406781,2.7434745762711863,2.7606779661016949,2.7778813559322035,2.7950847457627122,2.8122881355932203,2.8294915254237289,2.8466949152542371,2.8638983050847457,2.8811016949152544,2.898305084745763,2.9155084745762712,2.9327118644067798,2.949915254237288,2.9671186440677966,2.9843220338983052,3.0015254237288138,3.018728813559322,3.0359322033898306,3.0531355932203388,3.0703389830508474,3.087542372881356,3.1047457627118646,3.1219491525423728,3.1391525423728814,3.1563559322033896,3.1735593220338982,3.1907627118644069,3.2079661016949155,3.2251694915254236,3.2423728813559323,3.2595762711864404,3.2767796610169491,3.2939830508474577,3.3111864406779663,3.3283898305084749,3.3455932203389831,3.3627966101694917,3.3799999999999999],"y":[0.92206453347252348,0.91892952240140702,0.91567993543226311,0.91231252307049093,0.90882402002850338,0.90521115222535053,0.9014706443961733,0.8975992283295311,0.89359365174813499,0.88945068784554882,0.88516714548797049,0.88073988008624737,0.87616580513879005,0.87144190444102143,0.86656524495139819,0.86153299029790709,0.85634241490222196,0.85099091869146659,0.84547604235976503,0.83979548313351238,0.83394711098562324,0.82792898523496417,0.8217393714578336,0.81537675862881187,0.80883987639866406,0.80212771240737546,0.79523952952096599,0.78817488287161264,0.78093363657199411,0.77351597996681831,0.76592244327739489,0.75815391248907604,0.75021164332658929,0.74209727415893278,0.7338128376737878,0.72536077116149378,0.71674392525070585,0.70796557094205026,0.69902940479251541,0.68993955211207203,0.68070056804513324,0.67131743642294728,0.66179556628883929,0.65214078601627368,0.64235933495986419,0.63245785260151333,0.62244336517758703,0.61232326979810292,0.60210531609502571,0.59179758546350936,0.58140846798691714,0.57094663716322169,0.56042102257652227,0.54984078068240261,0.53921526389930152,0.52855398821948096,0.51786659957219394,0.50716283918786575,0.49645250822524006,0.48574543193317099,0.47505142362494651,0.46438024874552541,0.45374158931082437,0.44314500899324794,0.43259991911907603,0.42211554583132288,0.41170089865647053,0.40136474069537309,0.39111556063796976,0.38096154677865646,0.37091056318462501,0.36097012814369606,0.35114739499155889,0.34144913539136551,0.33188172511174641,0.32245113232295042,0.31316290840533806,0.30402218124024866,0.29503365093061179,0.28620158787785294,0.27752983312285895,0.26902180084218386,0.26068048287638945,0.2525084551555043,0.24450788587702918,0.23668054528472107,0.22902781689144408,0.22155070998660942,0.21424987326797237,0.2071256094386919,0.20017789061336838,0.19340637438111641,0.1868104203793664,0.18038910723885815,0.17414124976796533,0.16806541625291449,0.16215994575941864,0.15642296533059616,0.15085240698560495,0.14544602443306662,0.14020140942293746,0.13511600766991105,0.1301871342905887,0.12541198870546988,0.12078766896521016,0.1163111854685276,0.1119794740465595,0.10778940839536547,0.10373781184460495,0.099821468456199713,0.096037133452008747,0.092381542974215289,0.088851423186258244,0.085443498725762998,0.082154500524050503,0.078981173009472799,0.075920280714043983,0.0729686143046651,0.070122996061686843],"type":"scatter","mode":"lines","line":{"color":"black","width":2},"text":["Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities","Predicted probabilities"],"textposition":["middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.3500000000000001,1.3672033898305085,1.3844067796610171,1.4016101694915255,1.4188135593220339,1.4360169491525425,1.4532203389830509,1.4704237288135593,1.4876271186440679,1.5048305084745763,1.522033898305085,1.5392372881355934,1.5564406779661017,1.5736440677966104,1.5908474576271188,1.6080508474576272,1.6252542372881358,1.6424576271186442,1.6596610169491526,1.6768644067796612,1.6940677966101696,1.711271186440678,1.7284745762711866,1.745677966101695,1.7628813559322034,1.780084745762712,1.7972881355932204,1.8144915254237288,1.8316949152542374,1.8488983050847458,1.8661016949152542,1.8833050847457629,1.9005084745762713,1.9177118644067797,1.9349152542372883,1.9521186440677967,1.9693220338983051,1.9865254237288137,2.0037288135593219,2.0209322033898305,2.0381355932203391,2.0553389830508477,2.0725423728813559,2.0897457627118645,2.1069491525423727,2.1241525423728813,2.1413559322033899,2.1585593220338986,2.1757627118644067,2.1929661016949153,2.2101694915254235,2.2273728813559321,2.2445762711864408,2.2617796610169494,2.2789830508474576,2.2961864406779662,2.3133898305084744,2.330593220338983,2.3477966101694916,2.3650000000000002,2.3822033898305088,2.399406779661017,2.4166101694915252,2.4338135593220338,2.4510169491525424,2.468220338983051,2.4854237288135597,2.5026271186440678,2.519830508474576,2.5370338983050846,2.5542372881355933,2.5714406779661019,2.5886440677966105,2.6058474576271187,2.6230508474576268,2.6402542372881355,2.6574576271186441,2.6746610169491527,2.6918644067796613,2.7090677966101695,2.7262711864406781,2.7434745762711863,2.7606779661016949,2.7778813559322035,2.7950847457627122,2.8122881355932203,2.8294915254237289,2.8466949152542371,2.8638983050847457,2.8811016949152544,2.898305084745763,2.9155084745762712,2.9327118644067798,2.949915254237288,2.9671186440677966,2.9843220338983052,3.0015254237288138,3.018728813559322,3.0359322033898306,3.0531355932203388,3.0703389830508474,3.087542372881356,3.1047457627118646,3.1219491525423728,3.1391525423728814,3.1563559322033896,3.1735593220338982,3.1907627118644069,3.2079661016949155,3.2251694915254236,3.2423728813559323,3.2595762711864404,3.2767796610169491,3.2939830508474577,3.3111864406779663,3.3283898305084749,3.3455932203389831,3.3627966101694917,3.3799999999999999],"y":[0.87390050118898011,0.86988990443495973,0.86575564229913071,0.86149479844122712,0.85710447108310706,0.85258178113615413,0.8479238809128965,0.84312796343264518,0.83819127232778001,0.83311111235368474,0.82788486050123122,0.82250997770612488,0.81698402114432778,0.8113046570971868,0.80546967436377881,0.79947699819140605,0.79332470468808514,0.78701103567335928,0.78053441391583545,0.77389345869755588,0.76708700163674337,0.76011410269166557,0.7529740662594574,0.74566645727481973,0.73819111720470254,0.73054817982651288,0.7227380866692269,0.71476160198916028,0.70661982714527571,0.69831421423292239,0.68984657883000922,0.68121911170600813,0.67243438934202282,0.66349538310964362,0.65440546695759672,0.64516842345842962,0.63578844807279411,0.62627015149639509,0.61661855996441317,0.60683911340025642,0.5969376613098113,0.58692045633888856,0.576794145430231,0.56656575853707281,0.55624269487264111,0.54583270669890682,0.53534388068303262,0.52478461687597433,0.51416360539420869,0.50348980091215167,0.49277239509907733,0.4820207871597767,0.47124455266239107,0.46045341085930869,0.44965719072736759,0.43886579597139319,0.42808916925001084,0.41733725589435089,0.40661996739851658,0.39594714496524824,0.38532852339106222,0.37477369557217405,0.36429207790578627,0.35389287685097393,0.34358505689957991,0.33337731019054323,0.3232780279812123,0.31329527416683012,0.30343676101492589,0.29370982725528016,0.28412141863886614,0.27467807105124264,0.26538589623771941,0.25625057016970321,0.24727732405440006,0.23847093796390267,0.22983573703497606,0.22137559016790856,0.21309391113185946,0.20499366196543733,0.19707735854492547,0.18934707817874333,0.1818044690754323,0.17445076152369615,0.16728678061673496,0.16031296034923159,0.15352935891372485,0.14693567502360858,0.14053126509242428,0.13431516110330619,0.12828608900814503,0.12244248750308598,0.11678252703511914,0.11130412890357132,0.10600498433003654,0.1008825733805216,0.095934183634117723,0.091156928503203269,0.086547765120858239,0.082103511721711916,0.077820864452718574,0.073696413560278465,0.069726658909591677,0.065908024801099946,0.062236874057274204,0.058709521360813331,0.055322245832500831,0.052071302843520857,0.048952935062944694,0.045963382746388136,0.04309889327650962,0.040355729970098723,0.037730180170014872,0.035218562643213214,0.032817234308562697,0.030522596320168925,0.028331099533480196,0.026239249382635145,0.024243610198325459],"type":"scatter","mode":"lines","line":{"color":"blue","width":2,"dash":"dash"},"text":["Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound","Lower bound"],"textposition":["middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.3500000000000001,1.3672033898305085,1.3844067796610171,1.4016101694915255,1.4188135593220339,1.4360169491525425,1.4532203389830509,1.4704237288135593,1.4876271186440679,1.5048305084745763,1.522033898305085,1.5392372881355934,1.5564406779661017,1.5736440677966104,1.5908474576271188,1.6080508474576272,1.6252542372881358,1.6424576271186442,1.6596610169491526,1.6768644067796612,1.6940677966101696,1.711271186440678,1.7284745762711866,1.745677966101695,1.7628813559322034,1.780084745762712,1.7972881355932204,1.8144915254237288,1.8316949152542374,1.8488983050847458,1.8661016949152542,1.8833050847457629,1.9005084745762713,1.9177118644067797,1.9349152542372883,1.9521186440677967,1.9693220338983051,1.9865254237288137,2.0037288135593219,2.0209322033898305,2.0381355932203391,2.0553389830508477,2.0725423728813559,2.0897457627118645,2.1069491525423727,2.1241525423728813,2.1413559322033899,2.1585593220338986,2.1757627118644067,2.1929661016949153,2.2101694915254235,2.2273728813559321,2.2445762711864408,2.2617796610169494,2.2789830508474576,2.2961864406779662,2.3133898305084744,2.330593220338983,2.3477966101694916,2.3650000000000002,2.3822033898305088,2.399406779661017,2.4166101694915252,2.4338135593220338,2.4510169491525424,2.468220338983051,2.4854237288135597,2.5026271186440678,2.519830508474576,2.5370338983050846,2.5542372881355933,2.5714406779661019,2.5886440677966105,2.6058474576271187,2.6230508474576268,2.6402542372881355,2.6574576271186441,2.6746610169491527,2.6918644067796613,2.7090677966101695,2.7262711864406781,2.7434745762711863,2.7606779661016949,2.7778813559322035,2.7950847457627122,2.8122881355932203,2.8294915254237289,2.8466949152542371,2.8638983050847457,2.8811016949152544,2.898305084745763,2.9155084745762712,2.9327118644067798,2.949915254237288,2.9671186440677966,2.9843220338983052,3.0015254237288138,3.018728813559322,3.0359322033898306,3.0531355932203388,3.0703389830508474,3.087542372881356,3.1047457627118646,3.1219491525423728,3.1391525423728814,3.1563559322033896,3.1735593220338982,3.1907627118644069,3.2079661016949155,3.2251694915254236,3.2423728813559323,3.2595762711864404,3.2767796610169491,3.2939830508474577,3.3111864406779663,3.3283898305084749,3.3455932203389831,3.3627966101694917,3.3799999999999999],"y":[0.97022856575606686,0.96796914036785431,0.96560422856539552,0.96313024769975475,0.9605435689738997,0.95784052331454694,0.95501740787945011,0.95207049322641701,0.94899603116848996,0.9457902633374129,0.94244943047470975,0.93896978246636986,0.93534758913325233,0.93157915178485606,0.92766081553901758,0.92358898240440812,0.91936012511635878,0.9149708017095739,0.91041767080369462,0.90569750756946887,0.90080722033450311,0.89574386777826276,0.8905046766562098,0.88508705998280401,0.87948863559262558,0.87370724498823804,0.86774097237270509,0.861588163754065,0.8552474459987125,0.84871774570071423,0.84199830772478057,0.83508871327214396,0.82798889731115577,0.82069916520822195,0.81322020838997888,0.80555311886455794,0.79769940242861759,0.78966099038770543,0.78144024962061764,0.77303999082388763,0.76446347478045518,0.75571441650700599,0.74679698714744758,0.73771581349547455,0.72847597504708728,0.71908299850411983,0.70954284967214143,0.69986192272023151,0.69004702679584273,0.68010537001486704,0.67004454087475696,0.65987248716666669,0.64959749249065346,0.63922815050549653,0.62877333707123551,0.61824218046756874,0.60764402989437705,0.59698842248138062,0.58628504905196355,0.57554371890109379,0.56477432385883075,0.55398680191887684,0.54319110071586252,0.53239714113552195,0.5216147813385722,0.51085378147210259,0.50012376933172875,0.48943420722391606,0.47879436026101363,0.46821326630203275,0.45769970773038388,0.44726218523614947,0.43690889374539837,0.42664770061302781,0.41648612616909275,0.40643132668199816,0.39649007977570006,0.38666877231258878,0.37697339072936409,0.36740951379026854,0.35798230770079242,0.34869652350562441,0.33955649667734661,0.33056614878731244,0.32172899113732339,0.31304813022021055,0.30452627486916328,0.29616574494961023,0.2879684814435205,0.2799360577740776,0.27206969221859173,0.26437026125914687,0.25683831372361365,0.24947408557414497,0.24227751520589413,0.23524825912530739,0.22838570788471957,0.22168900215798903,0.21515704885035167,0.2087885371444213,0.20258195439315635,0.19653560177954366,0.19064760967158573,0.18491595260983981,0.17933846387314611,0.17391284957624187,0.16863670226061817,0.16350751394721008,0.15852268862626523,0.15367955416601128,0.14897537362750787,0.14440735597833185,0.13997266620250162,0.13566843480831278,0.1314917667395383,0.12743974969877667,0.12350946189460776,0.11969797922669506,0.11600238192504822],"type":"scatter","mode":"lines","line":{"color":"blue","width":2,"dash":"dash"},"text":["Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound","Upper bound"],"textposition":["middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2.5800000000000001,2.4300000000000002,2.23,2.23,2.5,2.5,2.1299999999999999,2.1299999999999999,2.6200000000000001,2.6699999999999999,2.1800000000000002,2.3199999999999998,2.8599999999999999,2.8399999999999999,2.7599999999999998,2.6099999999999999,2.6499999999999999,2.4399999999999999,2.5499999999999998,2.4399999999999999,2.7999999999999998,2.4399999999999999,2.0899999999999999,3.1699999999999999,2.6299999999999999,2,2,2.3199999999999998,2.5800000000000001,2.5800000000000001,2.2000000000000002,2.54,3.3799999999999999,2.6499999999999999,1.8600000000000001,1.8600000000000001,2.1000000000000001,2.1000000000000001,2.04,2.6800000000000002,2.2400000000000002,1.8999999999999999,2.4300000000000002,1.9099999999999999,3.1800000000000002,1.8700000000000001,2.3100000000000001,2.3100000000000001,2.1600000000000001,1.8500000000000001,1.5,2.7200000000000002,2.48,2.48,1.77,2,1.6899999999999999,2.0699999999999998,2.4700000000000002,2.4700000000000002,2.27,1.54,2.2999999999999998,1.9199999999999999,1.74,2.0800000000000001,2.3799999999999999,1.8999999999999999,2.8300000000000001,1.6899999999999999,1.96,3.0800000000000001,1.6799999999999999,1.6599999999999999,1.51,2.0800000000000001,2.3599999999999999,1.74,2.6200000000000001,2.6499999999999999,2.04,2.96,1.6399999999999999,1.78,1.54,1.6799999999999999,1.4299999999999999,1.5600000000000001,1.6399999999999999,1.6499999999999999,1.6499999999999999,1.77,1.75,1.6299999999999999,1.3500000000000001,2.3700000000000001,1.97,2.1099999999999999,1.9399999999999999,2.2400000000000002,2.0499999999999998,2.0499999999999998,1.72,1.8999999999999999,2.7599999999999998,1.4199999999999999,2.0800000000000001,1.52,1.6100000000000001,2.04,2.1299999999999999,1.4099999999999999,1.3899999999999999,1.71,1.4399999999999999,1.8100000000000001,1.72,1.99,3.1000000000000001],"y":[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,1,1,0,0,0,0,1,1,0,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1,0,1,0,1,1,0,1,1,0,0,1,0,1,0,1,1,1,0,1,0,1,0,1,1,0,1,0,0,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0],"type":"scatter","mode":"markers","text":["Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Hard to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Easy to eat","Hard to eat"],"textposition":["middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right","middle right"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

* It represents the *probability* of positive outcomes depending on predictors  
* Hover your mouse over the logistic curve: as we move along the curve and our predictor values change, we go from 0 to 100% probability of our outcome  

## Mathematical representation

* Before we can correlate variables in our models: the code we use to run logistic regressions transforms the response variable to get a linear relationship between variables  
* This transformation is called logit (log of probability of success/probability of failure)
* Our explanatory variable is in log(odds)  

This is the equation for the logistic regression:

$$ Log (p/1-p) = b0+b1*x1+e $$
*Log (p/1-p)*: response variable  
*b0*: y intercept  
*x*: predictor variable  
*b1*: slope for explanatory variable 1  
*e*: error  

If we had more explanatory variables, we could keep adding them to the equation above as b2*x2 and so forth.
 
## What kind of predictors can we have in a logistic regression?

Just like in a linear regression, we can use continuous and/or discrete variables to make predictions. Here are some examples:

**Continuous variables**

+ Temperature  

+ Precipitation  

+ Water depth  

+ Nitrogen concentration  

**Discrete variables**  

+ Levels of aquatic vegetation  

+ Soil type 

+ Water body type  

## Key binomial logistic model assumptions  

- Dependent variable has 2 levels or is a proportion of successes  

- Observations are independent  

- Normal distribution of data or residuals is not needed  

## Aquatic ecology studies using logistic regression  

- The distribution of gammarid species was predicted using logistic regressions, where current velocity was the most important factor explaining their distribution [(Peeters & Gardeniers, 1998)](https://onlinelibrary.wiley.com/doi/epdf/10.1046/j.1365-2427.1998.00304.x)  

- Foraging shift behaviour from the benthos to the water surface in brown trout (1 = surface prey consumed, 0 = no surface prey consumed) was predicted using fish length as a predictor in a logistic regression [(Snchez-Hernndez & Cobo, 2017)](https://cdnsciencepub.com/doi/full/10.1139/cjfas-2017-0021])

![[Amphipod Gammaridae](https://commons.wikimedia.org/wiki/File:Amphipod_Gammaridae_%288741971996%29.jpg); [Brown Trout, USFWS Mountain-Prairie](https://www.flickr.com/photos/usfwsmtnprairie/49860328703)](https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic_studies_example.jpg)

## Practice time: run your own logistic model

### Steps to run a logistic model in R

1. Select potentially interesting predictors
2. Format predictors to correspond to binomial levels
3. Select time period and location
4. Run model
5. Interpret model
6. Plot results

### Let's create this first model together

First, we are going to have a look at some potentially interesting variables:


```r
knitr::kable(ham[c(25:30), c(2,8,26,47,98)],row.names = FALSE, digits=2, align=rep('c', 3),
             col.names = c("Location", "Season", "Total phosphorus", "Filamentous diatom biomass", "Epilimnion temperat."))
```



| Location | Season | Total phosphorus | Filamentous diatom biomass | Epilimnion temperat. |
|:--------:|:------:|:----------------:|:--------------------------:|:--------------------:|
|   deep   |   2    |       0.01       |            0.00            |        21.79         |
|   deep   |   2    |       0.01       |            3.10            |        21.83         |
|    NE    |   1    |       0.02       |             NA             |        19.89         |
|   deep   |   1    |       0.02       |             NA             |        19.71         |
|    NE    |   1    |        NA        |             NA             |        13.90         |
|   deep   |   1    |        NA        |           287.18           |        16.05         |

Let's consider that filamentous diatom is our response variable of interest, as this food source is hard for zooplankton to consume. We will look at epilimnion temperature as a potential explanatory variable.

First, let's create a copy of the original dataset so that we can introduce modifications but keep the original data in case we need it.


```r
filam_diatom <- ham
```

Before we can get started with the analysis, we need to remove NA data. We will now do that for the potential response variable filamentous diatom column, and for the potential explanatory variable epilimnion temperature:


```r
filam_diatom <- filam_diatom[!is.na(filam_diatom$filamentous_Diatom), ]
filam_diatom <- filam_diatom[!is.na(filam_diatom$mean_mixing_depth_temp), ]
```


*Practice time*: Now you can do this last step (removing NA data) for total phosphorus ("TP dissolved_ECCC1m"), as we will consider this as another potential explanatory variable later on. 


```r
# Use the original dataset "ham" to subset this data, and give this new  dataset a name, like "filam_diatom_P"

# Don't forget to remove NA data from both the response and the explanatory variables
```



Let's go back to our "filam_diatom" dataset. Now we will create a new column to describe presence or absence of filamentous diatoms.

Ensure the reference group ("absent") is the first to be shown:


```r
filam_diatom$filam_presence <- ifelse(filam_diatom$filamentous_Diatom > 0, "present", "absent")
filam_diatom$filam_presence <- factor(filam_diatom$filam_presence)
levels(filam_diatom$filam_presence)
```

```
## [1] "absent"  "present"
```

Subset to analyse at specific times of the year and at specific locations
Here I selected summer conditions. Ideally we should also subset by station (column "Station_Acronym"), but because there's not enough data to do that, let's subset by depth, by removing records in deep locations:


```r
filam_diatom <- subset(filam_diatom, (season==2 | season==3) & (!area_group=="deep"))
```

Run model using glm function and family binomial


```r
model <- glm(filam_presence ~ mean_mixing_depth_temp,
             data = filam_diatom, family = binomial)
```

Now we can check the model results


```r
summary(model)
```

```
## 
## Call:
## glm(formula = filam_presence ~ mean_mixing_depth_temp, family = binomial, 
##     data = filam_diatom)
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(>|z|)   
## (Intercept)             10.1581     3.8402   2.645  0.00816 **
## mean_mixing_depth_temp  -0.4202     0.1736  -2.420  0.01551 * 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 79.807  on 69  degrees of freedom
## Residual deviance: 72.195  on 68  degrees of freedom
## AIC: 76.195
## 
## Number of Fisher Scoring iterations: 5
```

So we can see that our p-value for the epilimnion temperature predictor is smaller than 0.05, which means that the presence of filamentous diatoms can be predicted by temperatures. 

Let's see what each component of the model result summary means:

![](https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/model_output_description.jpg)


We are ready for the best part: plotting model predictions  

The dotted curves are confidence intervals, which show us the range in which we are 95% sure about the location of true values, based on our data


```r
# Now, let's calculate predicted probabilities for different values of mean_mixing_depth_temp

# Create a sequence of values for mean_mixing_depth_temp
mean_mixing_depth_temp_values <- seq(min(filam_diatom$mean_mixing_depth_temp), max(filam_diatom$mean_mixing_depth_temp), length.out = length(filam_diatom$mean_mixing_depth_temp))

# Create a data frame with mean_mixing_depth_temp values
newdata <- data.frame(mean_mixing_depth_temp = mean_mixing_depth_temp_values)

# Predict probabilities for each value of mean_mixing_depth_temp
predicted_probabilities_filam <- predict(model, newdata = newdata, type = "response")

# Calculate confidence intervals manually
z <- qnorm(1 - (1 - 0.95) / 2)  # 95% confidence level
se <- sqrt(predicted_probabilities_filam * (1 - predicted_probabilities_filam) / nrow(filam_diatom))
lower_bound <- predicted_probabilities_filam - z * se
upper_bound <- predicted_probabilities_filam + z * se

# Convert "present" and "absent" to 1 and 0
presence_numeric_filam <- ifelse(filam_diatom$filam_presence == "present", 1, 0)

# Plot the predicted probabilities with confidence intervals
plot(mean_mixing_depth_temp_values, predicted_probabilities_filam, type = "l",
     main = "Filamentous diatom presence",
     xlab = "Epilimnion temperature (\u00B0C)", ylab = "Predicted probability", cex.axis = 1.5, ylim = c(0, 1), lwd = 2)
lines(mean_mixing_depth_temp_values, lower_bound, col = "blue", lty = 2)
lines(mean_mixing_depth_temp_values, upper_bound, col = "blue", lty = 2)
points(filam_diatom$mean_mixing_depth_temp, presence_numeric_filam)
```

![](https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/plot1.png)

*Practice time*:

### Create your own model

Now it's your turn! Run your own logistic model using total phosphorus as a predictor, and filamentous diatoms as the response variable again.

*Formatting* 

Do you remember how you previously labeled your dataset for the phosphorus analysis? You can use that for this exercise. You have already removed NA data, but before proceeding, let's relabel the response variable to remove empty spaces, which may cause errors going forward:


```r
names(filam_diatom_P)[names(filam_diatom_P) == "TP dissolved_ECCC1m"] <- "Total_phosphorus"
```

Now you can create a new column that describes the presence or the absence of filamentous diatoms across the dataset:


```r
# To create a new column, first type the label you chose previously for the dataframe related to the phosphorus analysis (something like "filam_diatom_P"), then create a column name, and use the function "ifelse" to label all observations where measurements were greater than zero as "present", and all observations where measurements were equal to zero as "absent":

your_dataset_name$new_column_name <- ifelse(your_dataset_name$filamentous_Diatom > 0, "present", "absent")
```

Format this new column as a factor


```r
# use the factor function here

# and check how it looks by calling:
levels(your_dataset_name$filamentous_Diatom)
```




*Select time periods and locations*

You can choose to select summer, or another time period. Because we have more data for phosphorus, you can select a single station (column 5: "Station_Acronym")


```r
# Use the subset function to select desired periods of time and locations. You can use "&" for more than one selection at the same time, and "|" for selecting either one or other option:
your_dataset_name <- subset(your_dataset_name, (season=="your selection" | season=="your selection") & (Station_Acronym=="your selection"))
```




*Run model*


```r
# Use glm function and family binomial
your_model_name <- glm("response variable" ~ "explanatory variable",
             data = your_dataset_name, family = binomial)
```




Check model results using the summary function


```r
summary(your_model_name)
```

How well did this predictor do? 

*Plot model predictions*


```r
# Create a sequence of values for Total_phosphorus
Total_phosphorus_values <- seq(min(filam_diatom_P$Total_phosphorus), max(filam_diatom_P$Total_phosphorus), length.out = length(filam_diatom_P$Total_phosphorus))

# Create a data frame with Total_phosphorus values
newdata <- data.frame(Total_phosphorus = Total_phosphorus_values)

# Predict probabilities for each value of Total_phosphorus
predicted_probabilities_P <- predict(model, newdata = newdata, type = "response")

# Calculate confidence intervals manually
z <- qnorm(1 - (1 - 0.95) / 2)  # 95% confidence level
se <- sqrt(predicted_probabilities_P * (1 - predicted_probabilities_P) / nrow(filam_diatom))
lower_bound <- predicted_probabilities_P - z * se
upper_bound <- predicted_probabilities_P + z * se

# Convert "present" and "absent" to 1 and 0
presence_numeric_P <- ifelse(filam_diatom_P$filam_presence == "present", 1, 0)

# Plot the predicted probabilities with confidence intervals
plot(Total_phosphorus_values, predicted_probabilities_P, type = "l", 
     main = "Filamentous diatom presence",
     xlab = "Total phosphorous (dissolved fraction) (mg/L)", ylab = "Predicted probability", cex.axis = 1.5, ylim = c(0, 1), lwd = 2)
lines(Total_phosphorus_values, lower_bound, col = "blue", lty = 2)
lines(Total_phosphorus_values, upper_bound, col = "blue", lty = 2)
points(filam_diatom_P$Total_phosphorus, presence_numeric_P)
```

![](https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/plot2.png)

## Evaluating the accuracy of logistic models

Our last topic will be how to evaluate model accuracy: AUC, or the Area Under the Curve (AUC), is a widely used metric which compares the probabilities we predicted to the actual data. It evaluates how well the model can correctly classify positive cases versus how often the model makes mistakes by classifying negatives as positives. It does that across different thresholds (from zero to one). 

AUC goes from zero to one, with values close to 1 designating models with high accuracy, and values at 0.5 meaning that the model is not classifying better than a random classification.


| Phyto.nitrate| Diatom.temperature| Diatom.phosphorus|
|-------------:|------------------:|-----------------:|
|          0.63|               0.53|              0.47|

As you can see, none of our models have great accuracy. This could be improved by adding data (especially if there is an imbalance between positive and negative observations), choosing different or additional predictors, subsetting to more specific stations or locations, or periods of time.  

## What could go wrong?

- *Mixing up predictors and response variables in the logistic model equation*
    + If you get a warning when running your logistic model, you may have mixed up the predictors and the response variables. The response variable should be the first one to appear after the opening parenthesis 
    + In addition to the variable mix-up, this warning tells us that we may be using quantitative measures as our response variable, which is not appropriate for a logistic regression. See how this error looks like:


```r
model <- glm(Total_phosphorus ~ filam_presence,
             data = filam_diatom_P, family = binomial)
```

```
## Warning in eval(family$initialize): non-integer #successes in a binomial glm!
```

- *Incorrectly coding data so that it is not independent*

Imagine you have counts of living and dead organisms in your dataset:


```r
example_independence <- data.frame(date=rep("Jan-1-2024", times=3), location=c("station-1","station-2", "station-3"), living_daphnia=floor(runif(3, min=0, max=101)),dead_daphnia=floor(runif(3, min=0, max=101)))
# runif function generates random numbers within the range established by "min" and "max" values
knitr::kable(head(example_independence))
```



|date       |location  | living_daphnia| dead_daphnia|
|:----------|:---------|--------------:|------------:|
|Jan-1-2024 |station-1 |             53|           99|
|Jan-1-2024 |station-2 |             81|           26|
|Jan-1-2024 |station-3 |             33|           10|

In this case, instead of considering each individual as "living" or "dead", you should calculate the proportion of living organisms *per replicate* like this:
    

```r
example_independence$proportion <- round(example_independence$living_daphnia/(example_independence$living_daphnia+example_independence$dead_daphnia),2)
# the round function ensures we have 2 decimals in our proportion values

knitr::kable(head(example_independence))
```



|date       |location  | living_daphnia| dead_daphnia| proportion|
|:----------|:---------|--------------:|------------:|----------:|
|Jan-1-2024 |station-1 |             53|           99|       0.35|
|Jan-1-2024 |station-2 |             81|           26|       0.76|
|Jan-1-2024 |station-3 |             33|           10|       0.77|

This proportion will be your response variable for the logistic model. When using proportions, you should also provide the "weights" information in the glm formula (i.e., a dataset with total number of trials per replicate, or the sum of events where we got success + events where we got failure).

- *Categorical response variable is formatted as character instead of factor* 
    + Formatting data as factors allows for defining order or reference group for statistical testing  


```r
# Here we are selecting and formatting the binomial data as we did before, but now we accidentally forget to format the new column as "factor" 
example <- ham

example$filam_presence <- ifelse(example$filamentous_Diatom > 0, "present", "absent")

model <- glm(filam_presence ~ mean_mixing_depth_temp,
             data = example, family = binomial)
```

```
## Error in eval(family$initialize): y values must be 0 <= y <= 1
```

Check the data in the problematic column:
    

```r
str(example$filam_presence)
```

```
##  chr [1:742] "present" NA NA "present" NA NA NA NA NA NA NA NA "present" NA ...
```

See how we need to remove NA data and format the column as factor for our model to run nicely:


```r
example <- example[!is.na(example$filamentous_Diatom), ]

example$filam_presence <- factor(example$filam_presence)

levels(example$filam_presence)
```

```
## [1] "absent"  "present"
```

```r
model <- glm(filam_presence ~ mean_mixing_depth_temp,
             data = example, family = binomial)
```

No more errors now!

That's it for now, but if you are interested in more complex logistic models, here are some resources:

## R resources 

*Multiple logistic regression*

- [Building Skills in Quantitative Biology (Cuddington, Edwards, & Ingalls, 2022)](https://www.quantitative-biology.ca/machine-learning-and-classification.html#multiple-logistic-regression)  

- [Getting started with Multivariate Multiple Regression (Ford, 2024)](https://library.virginia.edu/data/articles/getting-started-with-multivariate-multiple-regression)  


*Multinomial logistic regression*

- [Multinomial logistic regression (Russell, 2022)](https://ladal.edu.au/regression.html#Mixed-Effects_Binomial_Logistic_Regression)  

*Mixed-effects logistic regression*

- [Mixed-Effects Binomial Logistic Regression (Schweinberger, 2022 )](https://stats4nr.com/logistic-regression#modeling-more-than-two-responses)   

- [Mixed-effects logistic regression (Sonderegger, Wagner, & Torreira, 2018)](https://people.linguistics.mcgill.ca/~morgan/qmld-book/mixed-effects-logistic-regression.html)   
