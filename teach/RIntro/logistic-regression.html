<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Logistic regression | R Intro Workshop</title>
  <meta name="description" content="Building Skills in Quantitative Biology" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Logistic regression | R Intro Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Building Skills in Quantitative Biology" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Logistic regression | R Intro Workshop" />
  
  <meta name="twitter:description" content="Building Skills in Quantitative Biology" />
  

<meta name="author" content="The Cuddington Lab" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-linear-regression-model.html"/>
<link rel="next" href="multivariate-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to our Workshop!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Get ready for the workshop</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#r-from-zero-warmup"><i class="fa fa-check"></i><b>2.0.1</b> R from zero warmup</a></li>
<li class="chapter" data-level="2.0.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#download-needed-files-and-packages"><i class="fa fa-check"></i><b>2.0.2</b> Download needed files and packages</a></li>
<li class="chapter" data-level="2.0.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#package-to-read-.xlsx-files"><i class="fa fa-check"></i><b>2.0.3</b> Package to read .xlsx files</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>3</b> Basic R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-r.html"><a href="basic-r.html#data-import-packages"><i class="fa fa-check"></i><b>3.1</b> Data import &amp; packages</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r.html"><a href="basic-r.html#wheres-my-file"><i class="fa fa-check"></i><b>3.1.1</b> Where’s my file??</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r.html"><a href="basic-r.html#did-the-import-work"><i class="fa fa-check"></i><b>3.1.2</b> Did the import work??</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r.html"><a href="basic-r.html#data-in-r"><i class="fa fa-check"></i><b>3.2</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r.html"><a href="basic-r.html#selecting-portions-of-a-dataframe"><i class="fa fa-check"></i><b>3.2.1</b> Selecting portions of a dataframe</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-r.html"><a href="basic-r.html#using-conditional-statements-to-access-data"><i class="fa fa-check"></i><b>3.2.2</b> Using conditional statements to access data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r.html"><a href="basic-r.html#functions-in-r"><i class="fa fa-check"></i><b>3.3</b> Functions in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-r.html"><a href="basic-r.html#summarizing-data"><i class="fa fa-check"></i><b>3.3.1</b> Summarizing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-r.html"><a href="basic-r.html#plotting-data"><i class="fa fa-check"></i><b>3.4</b> Plotting data</a></li>
<li class="chapter" data-level="3.5" data-path="basic-r.html"><a href="basic-r.html#the-editor-window"><i class="fa fa-check"></i><b>3.5</b> The Editor window</a></li>
<li class="chapter" data-level="3.6" data-path="basic-r.html"><a href="basic-r.html#simple-tests"><i class="fa fa-check"></i><b>3.6</b> Simple tests</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction"><i class="fa fa-check"></i><b>4.0.1</b> Introduction</a></li>
<li class="chapter" data-level="4.0.2" data-path="linear-regression.html"><a href="linear-regression.html#data-import-packages-1"><i class="fa fa-check"></i><b>4.0.2</b> Data import &amp; packages</a></li>
<li class="chapter" data-level="4.0.3" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-using-water-level-and-total-zooplankton"><i class="fa fa-check"></i><b>4.0.3</b> Linear regression using water level and total zooplankton</a></li>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#what-does-this-output-tell-us"><i class="fa fa-check"></i><b>4.1</b> What does this output tell us?</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="linear-regression.html"><a href="linear-regression.html#what-does-the-summary-output-tell-us-about-the-relationship-between-water-level-and-total-zooplankton"><i class="fa fa-check"></i><b>4.1.1</b> What does the summary output tell us about the relationship between water level and total zooplankton?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#what-are-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.2</b> What are the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#how-do-you-evaluate-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.3</b> How do you evaluate the assumptions of a linear regression?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="linear-regression.html"><a href="linear-regression.html#lets-try"><i class="fa fa-check"></i><b>4.3.1</b> Let’s try…</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-regression.html"><a href="linear-regression.html#section"><i class="fa fa-check"></i><b>4.3.2</b> 1.</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-regression.html"><a href="linear-regression.html#section-1"><i class="fa fa-check"></i><b>4.3.3</b> 2.</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-regression.html"><a href="linear-regression.html#section-2"><i class="fa fa-check"></i><b>4.3.4</b> 3.</a></li>
<li class="chapter" data-level="4.3.5" data-path="linear-regression.html"><a href="linear-regression.html#section-3"><i class="fa fa-check"></i><b>4.3.5</b> 4.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression.html"><a href="linear-regression.html#how-can-we-plot-this-linear-regression"><i class="fa fa-check"></i><b>4.4</b> How can we plot this linear regression?</a></li>
<li class="chapter" data-level="4.5" data-path="linear-regression.html"><a href="linear-regression.html#references-and-resources"><i class="fa fa-check"></i><b>4.5</b> References and resources</a></li>
<li class="chapter" data-level="4.6" data-path="linear-regression.html"><a href="linear-regression.html#alternative-resource"><i class="fa fa-check"></i><b>4.6</b> Alternative resource:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html"><i class="fa fa-check"></i><b>5</b> Multiple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#what-is-a-mulitple-linear-regression-model"><i class="fa fa-check"></i><b>5.1.1</b> What is a Mulitple Linear Regression Model</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#recipe-for-multi-variate-model-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Recipe for multi-variate model in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#data-preparation"><i class="fa fa-check"></i><b>5.2</b> Data preparation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#check-data-type"><i class="fa fa-check"></i><b>5.2.1</b> Check data type</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-building"><i class="fa fa-check"></i><b>5.3</b> Model building</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-output"><i class="fa fa-check"></i><b>5.4</b> Model output</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-assumptions"><i class="fa fa-check"></i><b>5.4.1</b> Model assumptions</a></li>
<li class="chapter" data-level="5.4.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#evaluate-model-assumptions"><i class="fa fa-check"></i><b>5.4.2</b> Evaluate model assumptions</a></li>
<li class="chapter" data-level="5.4.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#output-interpretation"><i class="fa fa-check"></i><b>5.4.3</b> Output interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#what-could-go-wrong"><i class="fa fa-check"></i><b>5.5</b> What could go wrong?</a></li>
<li class="chapter" data-level="5.6" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#references-and-resources-1"><i class="fa fa-check"></i><b>5.6</b> References and Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> <strong>Logistic regression</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-is-a-logistic-regression"><i class="fa fa-check"></i><b>6.1</b> What is a logistic regression?</a></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#how-are-logistic-regressions-different-from-linear-regressions"><i class="fa fa-check"></i><b>6.2</b> How are logistic regressions different from linear regressions?</a></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#how-does-this-type-of-data-look-like"><i class="fa fa-check"></i><b>6.3</b> How does this type of data look like?</a></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#what-does-the-logistic-curve-mean"><i class="fa fa-check"></i><b>6.4</b> What does the logistic curve mean?</a></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#mathematical-representation"><i class="fa fa-check"></i><b>6.5</b> Mathematical representation</a></li>
<li class="chapter" data-level="6.6" data-path="logistic-regression.html"><a href="logistic-regression.html#what-kind-of-predictors-can-we-have-in-a-logistic-regression"><i class="fa fa-check"></i><b>6.6</b> What kind of predictors can we have in a logistic regression?</a></li>
<li class="chapter" data-level="6.7" data-path="logistic-regression.html"><a href="logistic-regression.html#key-binomial-logistic-model-assumptions"><i class="fa fa-check"></i><b>6.7</b> Key binomial logistic model assumptions</a></li>
<li class="chapter" data-level="6.8" data-path="logistic-regression.html"><a href="logistic-regression.html#aquatic-ecology-studies-using-logistic-regressions"><i class="fa fa-check"></i><b>6.8</b> Aquatic ecology studies using logistic regressions</a></li>
<li class="chapter" data-level="6.9" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9</b> Creating a logistic model in R</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#steps-to-run-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9.1</b> Steps to run a logistic model in R</a></li>
<li class="chapter" data-level="6.9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#lets-create-this-first-model-together"><i class="fa fa-check"></i><b>6.9.2</b> Let’s create this first model together</a></li>
<li class="chapter" data-level="6.9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-your-logistic-model"><i class="fa fa-check"></i><b>6.9.3</b> Creating your logistic model</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="logistic-regression.html"><a href="logistic-regression.html#what-could-go-wrong-1"><i class="fa fa-check"></i><b>6.10</b> What could go wrong?</a></li>
<li class="chapter" data-level="6.11" data-path="logistic-regression.html"><a href="logistic-regression.html#r-resources"><i class="fa fa-check"></i><b>6.11</b> R resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>7</b> Multivariate analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#libraries-and-imports"><i class="fa fa-check"></i><b>7.1</b> Libraries and imports</a></li>
<li class="chapter" data-level="7.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#introduction-to-multivariate-analysis"><i class="fa fa-check"></i><b>7.2</b> Introduction to multivariate analysis</a></li>
<li class="chapter" data-level="7.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>7.3</b> Principle Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#correlation-examination"><i class="fa fa-check"></i><b>7.3.1</b> Correlation examination</a></li>
<li class="chapter" data-level="7.3.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-standardized-data"><i class="fa fa-check"></i><b>7.3.2</b> PCA with standardized data</a></li>
<li class="chapter" data-level="7.3.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#screeplot"><i class="fa fa-check"></i><b>7.3.3</b> Screeplot</a></li>
<li class="chapter" data-level="7.3.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-pca"><i class="fa fa-check"></i><b>7.3.4</b> Plot ordination for PCA</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-metric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>7.4</b> Non-metric multidimensional scaling (nMDS)</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#shepard-plot"><i class="fa fa-check"></i><b>7.4.1</b> Shepard Plot</a></li>
<li class="chapter" data-level="7.4.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-nmds"><i class="fa fa-check"></i><b>7.4.2</b> Plot ordination for nMDS</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#other-resources"><i class="fa fa-check"></i><b>7.5</b> Other resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Intro Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> <strong>Logistic regression</strong><a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-is-a-logistic-regression" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> What is a logistic regression?<a href="logistic-regression.html#what-is-a-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Association between binary response variable and predictors</li>
<li>Example: species distribution models
<ul>
<li>Binary response variable: presence (1) or absence (0) of species in area</li>
<li>Predictions of habitat suitability</li>
</ul></li>
</ul>
</div>
<div id="how-are-logistic-regressions-different-from-linear-regressions" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> How are logistic regressions different from linear regressions?<a href="logistic-regression.html#how-are-logistic-regressions-different-from-linear-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Linear regression</em><br />
- Quantitative predictions: straight line<br />
- Correlation and test for significance of regression<br />
- Model comparison (eg., single versus several predictors)</p>
<p><em>Logistic regression</em><br />
- We can also do all of that!<br />
- Main difference: our outcomes are now <em>binary</em>
- Examples of binary outcomes: presence versus absence; positive to a disease versus negative; dead versus alive<br />
- Outcomes can be categorized as 1 (e.g., success) and 0 (e.g., failure)</p>
</div>
<div id="how-does-this-type-of-data-look-like" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> How does this type of data look like?<a href="logistic-regression.html#how-does-this-type-of-data-look-like" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Hamilton Harbour dataset: let’s suppose that it becomes hard for zooplankton to eat when there are more “less edible” algae than “edible” algae in the environment</li>
<li>That was the criteria for populating the column “Easy to eat”:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">Nitrate/nitrite</th>
<th align="right">Edible</th>
<th align="right">Less edible</th>
<th align="left">Easy to eat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.23</td>
<td align="right">884.60</td>
<td align="right">1645.7</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="right">2.50</td>
<td align="right">900.00</td>
<td align="right">1133.3</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="right">2.50</td>
<td align="right">923.20</td>
<td align="right">939.9</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="right">2.13</td>
<td align="right">1546.40</td>
<td align="right">1312.0</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="right">2.13</td>
<td align="right">811.90</td>
<td align="right">454.1</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="right">2.62</td>
<td align="right">339.16</td>
<td align="right">308.2</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="right">2.67</td>
<td align="right">1376.80</td>
<td align="right">552.2</td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<p>When we plot this type of binary data, we see that observations are either of the two outcome possibilities:</p>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic1.png" /></p>
<p>This type of data is best fit by an s-shaped curve instead of a line. And this is another difference between linear and logistic regressions.</p>
</div>
<div id="what-does-the-logistic-curve-mean" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> What does the logistic curve mean?<a href="logistic-regression.html#what-does-the-logistic-curve-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic2.png" /></p>
<ul>
<li>It represents the <em>probability</em> of positive outcomes depending on predictors<br />
</li>
<li>As we move along the curve and our predictor values change, we go from 0 to 100% probability of our outcome</li>
</ul>
</div>
<div id="mathematical-representation" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Mathematical representation<a href="logistic-regression.html#mathematical-representation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Logistic regression: transformation of response variable to get linear relationship<br />
</li>
<li>logit (log of probability of success/probability of failure)</li>
<li>Explanatory variable is in log(odds)</li>
</ul>
<p>Equation for logistic regression:</p>
<p><span class="math display">\[ Log (p/1-p) = b0+b1*x1+e \]</span>
<em>Log (p/1-p)</em>: response variable<br />
<em>b0</em>: y intercept<br />
<em>x</em>: predictor variable<br />
<em>b1</em>: slope for explanatory variable 1<br />
<em>e</em>: error</p>
<p>If we had more explanatory variables, we could keep adding them to the equation above as b2*x2 and so forth.</p>
</div>
<div id="what-kind-of-predictors-can-we-have-in-a-logistic-regression" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> What kind of predictors can we have in a logistic regression?<a href="logistic-regression.html#what-kind-of-predictors-can-we-have-in-a-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just like in a linear regression, we can use continuous and/or discrete variables to make predictions. Here are some examples:</p>
<p><strong>Continuous variables</strong></p>
<ul>
<li><p>Temperature</p></li>
<li><p>Precipitation</p></li>
<li><p>Water depth</p></li>
<li><p>Nitrogen concentration</p></li>
</ul>
<p><strong>Discrete variables</strong></p>
<ul>
<li><p>Levels of aquatic vegetation</p></li>
<li><p>Soil type</p></li>
<li><p>Water body type</p></li>
</ul>
</div>
<div id="key-binomial-logistic-model-assumptions" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Key binomial logistic model assumptions<a href="logistic-regression.html#key-binomial-logistic-model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Dependent variable has 2 levels or is a proportion of successes</p></li>
<li><p>Observations are independent</p></li>
<li><p>Normal distribution of data or residuals is not needed</p></li>
</ul>
</div>
<div id="aquatic-ecology-studies-using-logistic-regressions" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Aquatic ecology studies using logistic regressions<a href="logistic-regression.html#aquatic-ecology-studies-using-logistic-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>The distribution of gammarid species was predicted using logistic regressions, where current velocity was the most important factor explaining their distribution <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1046/j.1365-2427.1998.00304.x">(Peeters &amp; Gardeniers, 1998)</a></p></li>
<li><p>Foraging shift behaviour from the benthos to the water surface in brown trout (1 = surface prey consumed, 0 = no surface prey consumed) was predicted using fish length as a predictor in a logistic regression <a href="https://cdnsciencepub.com/doi/full/10.1139/cjfas-2017-0021%5D">(Sánchez-Hernández &amp; Cobo, 2017)</a></p></li>
</ul>
<div class="figure">
<img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic_studies_example.jpg" alt="" />
<p class="caption"><a href="https://commons.wikimedia.org/wiki/File:Amphipod_Gammaridae_%288741971996%29.jpg">Amphipod Gammaridae</a>; <a href="https://www.flickr.com/photos/usfwsmtnprairie/49860328703">Brown Trout, USFWS Mountain-Prairie</a></p>
</div>
</div>
<div id="creating-a-logistic-model-in-r" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Creating a logistic model in R<a href="logistic-regression.html#creating-a-logistic-model-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="steps-to-run-a-logistic-model-in-r" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Steps to run a logistic model in R<a href="logistic-regression.html#steps-to-run-a-logistic-model-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Select potentially interesting predictors</li>
<li>Format predictors to correspond to binomial levels</li>
<li>Select time period and location</li>
<li>Run model</li>
<li>Interpret model</li>
<li>Plot results</li>
</ol>
</div>
<div id="lets-create-this-first-model-together" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Let’s create this first model together<a href="logistic-regression.html#lets-create-this-first-model-together" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we are going to have a look at some potentially interesting variables:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="logistic-regression.html#cb36-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ham[<span class="fu">c</span>(<span class="dv">25</span><span class="sc">:</span><span class="dv">30</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">26</span>, <span class="dv">47</span>, <span class="dv">98</span>)], <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb36-2"><a href="logistic-regression.html#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">3</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Location&quot;</span>, </span>
<span id="cb36-3"><a href="logistic-regression.html#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Season&quot;</span>, <span class="st">&quot;Total phosphorus&quot;</span>, <span class="st">&quot;Filamentous diatom biomass&quot;</span>, </span>
<span id="cb36-4"><a href="logistic-regression.html#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Epilimnion temperat.&quot;</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="20%" />
<col width="32%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Location</th>
<th align="center">Season</th>
<th align="center">Total phosphorus</th>
<th align="center">Filamentous diatom biomass</th>
<th align="center">Epilimnion temperat.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">deep</td>
<td align="center">2</td>
<td align="center">0.01</td>
<td align="center">0.00</td>
<td align="center">21.79</td>
</tr>
<tr class="even">
<td align="center">deep</td>
<td align="center">2</td>
<td align="center">0.01</td>
<td align="center">3.10</td>
<td align="center">21.83</td>
</tr>
<tr class="odd">
<td align="center">NE</td>
<td align="center">1</td>
<td align="center">0.02</td>
<td align="center">NA</td>
<td align="center">19.89</td>
</tr>
<tr class="even">
<td align="center">deep</td>
<td align="center">1</td>
<td align="center">0.02</td>
<td align="center">NA</td>
<td align="center">19.71</td>
</tr>
<tr class="odd">
<td align="center">NE</td>
<td align="center">1</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">13.90</td>
</tr>
<tr class="even">
<td align="center">deep</td>
<td align="center">1</td>
<td align="center">NA</td>
<td align="center">287.18</td>
<td align="center">16.05</td>
</tr>
</tbody>
</table>
<p>Let’s consider that filamentous diatom is our response variable of interest, as this food source is hard for zooplankton to consume. We will look at epilimnion temperature as a potential explanatory variable.</p>
<p>First, let’s create a copy of the original dataset so that we can introduce modifications but keep the original data in case we need it.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="logistic-regression.html#cb37-1" aria-hidden="true" tabindex="-1"></a>filam_diatom <span class="ot">&lt;-</span> ham</span></code></pre></div>
<p>Before we can get started with the analysis, we need to remove NA data. We will now do that for the potential response variable filamentous diatom column, and for the potential explanatory variable epilimnion temperature:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="logistic-regression.html#cb38-1" aria-hidden="true" tabindex="-1"></a>filam_diatom <span class="ot">&lt;-</span> filam_diatom[<span class="sc">!</span><span class="fu">is.na</span>(filam_diatom<span class="sc">$</span>filamentous_Diatom), </span>
<span id="cb38-2"><a href="logistic-regression.html#cb38-2" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb38-3"><a href="logistic-regression.html#cb38-3" aria-hidden="true" tabindex="-1"></a>filam_diatom <span class="ot">&lt;-</span> filam_diatom[<span class="sc">!</span><span class="fu">is.na</span>(filam_diatom<span class="sc">$</span>mean_mixing_depth_temp), </span>
<span id="cb38-4"><a href="logistic-regression.html#cb38-4" aria-hidden="true" tabindex="-1"></a>    ]</span></code></pre></div>
<div id="try-it-now-13" class="section level4 hasAnchor" number="6.9.2.1">
<h4><span class="header-section-number">6.9.2.1</span> Try it now<a href="logistic-regression.html#try-it-now-13" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now you can do this last step (removing NA data) for total phosphorus (“TP dissolved_ECCC1m”), as we will consider this as another potential explanatory variable later on.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="logistic-regression.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the original dataset &#39;ham&#39; to subset this data, and</span></span>
<span id="cb39-2"><a href="logistic-regression.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># give this new dataset a name, like &#39;filam_diatom_P&#39;</span></span>
<span id="cb39-3"><a href="logistic-regression.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="logistic-regression.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Don&#39;t forget to remove NA data from both the response and</span></span>
<span id="cb39-5"><a href="logistic-regression.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the explanatory variables</span></span></code></pre></div>
<p>Let’s go back to our “filam_diatom” dataset. Now we will create a new column to describe presence or absence of filamentous diatoms.</p>
<p>Ensure the reference group (“absent”) is the first to be shown:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="logistic-regression.html#cb40-1" aria-hidden="true" tabindex="-1"></a>filam_diatom<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filam_diatom<span class="sc">$</span>filamentous_Diatom <span class="sc">&gt;</span> </span>
<span id="cb40-2"><a href="logistic-regression.html#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>)</span>
<span id="cb40-3"><a href="logistic-regression.html#cb40-3" aria-hidden="true" tabindex="-1"></a>filam_diatom<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">factor</span>(filam_diatom<span class="sc">$</span>filam_presence)</span>
<span id="cb40-4"><a href="logistic-regression.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(filam_diatom<span class="sc">$</span>filam_presence)</span></code></pre></div>
<pre><code>[1] &quot;absent&quot;  &quot;present&quot;</code></pre>
<p>Subset to analyse at specific times of the year and at specific locations
Here I selected summer conditions. Ideally we should also subset by station (column “Station_Acronym”), but because there’s not enough data to do that, let’s subset by depth, by removing records in deep locations:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="logistic-regression.html#cb42-1" aria-hidden="true" tabindex="-1"></a>filam_diatom <span class="ot">&lt;-</span> <span class="fu">subset</span>(filam_diatom, (season <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> season <span class="sc">==</span> </span>
<span id="cb42-2"><a href="logistic-regression.html#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>) <span class="sc">&amp;</span> (<span class="sc">!</span>area_group <span class="sc">==</span> <span class="st">&quot;deep&quot;</span>))</span></code></pre></div>
<p>Run model using glm function and family binomial</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="logistic-regression.html#cb43-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> mean_mixing_depth_temp, <span class="at">data =</span> filam_diatom, </span>
<span id="cb43-2"><a href="logistic-regression.html#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Now we can check the model results</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="logistic-regression.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>
Call:
glm(formula = filam_presence ~ mean_mixing_depth_temp, family = binomial, 
    data = filam_diatom)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9998  -0.8972   0.5144   0.8733   1.2380  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)             10.1581     3.8402   2.645  0.00816 **
mean_mixing_depth_temp  -0.4202     0.1736  -2.420  0.01551 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 79.807  on 69  degrees of freedom
Residual deviance: 72.195  on 68  degrees of freedom
AIC: 76.195

Number of Fisher Scoring iterations: 5</code></pre>
<p>So we can see that our p-value for the epilimnion temperature predictor is smaller than 0.05, which means that the presence of filamentous diatoms can be predicted by temperatures.</p>
<p>Let’s see what each component of the model result summary means:</p>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic_model_output.jpg" /></p>
<p>We are ready for the best part: plotting model predictions</p>
<p>The dotted curves are confidence intervals, which show us the range in which we are 95% sure about the location of true values, based on our data</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="logistic-regression.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, let&#39;s calculate predicted probabilities for different</span></span>
<span id="cb46-2"><a href="logistic-regression.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># values of mean_mixing_depth_temp</span></span>
<span id="cb46-3"><a href="logistic-regression.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="logistic-regression.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values for mean_mixing_depth_temp</span></span>
<span id="cb46-5"><a href="logistic-regression.html#cb46-5" aria-hidden="true" tabindex="-1"></a>mean_mixing_depth_temp_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(filam_diatom<span class="sc">$</span>mean_mixing_depth_temp), </span>
<span id="cb46-6"><a href="logistic-regression.html#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(filam_diatom<span class="sc">$</span>mean_mixing_depth_temp), <span class="at">length.out =</span> <span class="fu">length</span>(filam_diatom<span class="sc">$</span>mean_mixing_depth_temp))</span>
<span id="cb46-7"><a href="logistic-regression.html#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="logistic-regression.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with mean_mixing_depth_temp values</span></span>
<span id="cb46-9"><a href="logistic-regression.html#cb46-9" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean_mixing_depth_temp =</span> mean_mixing_depth_temp_values)</span>
<span id="cb46-10"><a href="logistic-regression.html#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="logistic-regression.html#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities for each value of</span></span>
<span id="cb46-12"><a href="logistic-regression.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_mixing_depth_temp</span></span>
<span id="cb46-13"><a href="logistic-regression.html#cb46-13" aria-hidden="true" tabindex="-1"></a>predicted_probabilities_filam <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> newdata, </span>
<span id="cb46-14"><a href="logistic-regression.html#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb46-15"><a href="logistic-regression.html#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="logistic-regression.html#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate confidence intervals manually</span></span>
<span id="cb46-17"><a href="logistic-regression.html#cb46-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>)<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 95% confidence level</span></span>
<span id="cb46-18"><a href="logistic-regression.html#cb46-18" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(predicted_probabilities_filam <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> predicted_probabilities_filam)<span class="sc">/</span><span class="fu">nrow</span>(filam_diatom))</span>
<span id="cb46-19"><a href="logistic-regression.html#cb46-19" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> predicted_probabilities_filam <span class="sc">-</span> z <span class="sc">*</span> se</span>
<span id="cb46-20"><a href="logistic-regression.html#cb46-20" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> predicted_probabilities_filam <span class="sc">+</span> z <span class="sc">*</span> se</span>
<span id="cb46-21"><a href="logistic-regression.html#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="logistic-regression.html#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;present&#39; and &#39;absent&#39; to 1 and 0</span></span>
<span id="cb46-23"><a href="logistic-regression.html#cb46-23" aria-hidden="true" tabindex="-1"></a>presence_numeric_filam <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filam_diatom<span class="sc">$</span>filam_presence <span class="sc">==</span> </span>
<span id="cb46-24"><a href="logistic-regression.html#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;present&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb46-25"><a href="logistic-regression.html#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="logistic-regression.html#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predicted probabilities with confidence intervals</span></span>
<span id="cb46-27"><a href="logistic-regression.html#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mean_mixing_depth_temp_values, predicted_probabilities_filam, </span>
<span id="cb46-28"><a href="logistic-regression.html#cb46-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Filamentous diatom presence&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Epilimnion temperature (°C)&quot;</span>, </span>
<span id="cb46-29"><a href="logistic-regression.html#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Predicted probability&quot;</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb46-30"><a href="logistic-regression.html#cb46-30" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb46-31"><a href="logistic-regression.html#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mean_mixing_depth_temp_values, lower_bound, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb46-32"><a href="logistic-regression.html#cb46-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb46-33"><a href="logistic-regression.html#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mean_mixing_depth_temp_values, upper_bound, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb46-34"><a href="logistic-regression.html#cb46-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb46-35"><a href="logistic-regression.html#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(filam_diatom<span class="sc">$</span>mean_mixing_depth_temp, presence_numeric_filam)</span></code></pre></div>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic3.png" /></p>
</div>
<div id="try-it-now-14" class="section level4 hasAnchor" number="6.9.2.2">
<h4><span class="header-section-number">6.9.2.2</span> Try it now<a href="logistic-regression.html#try-it-now-14" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="creating-your-logistic-model" class="section level3 hasAnchor" number="6.9.3">
<h3><span class="header-section-number">6.9.3</span> Creating your logistic model<a href="logistic-regression.html#creating-your-logistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now it’s your turn! Run this next logistic model using total phosphorus as a predictor, and filamentous diatoms as the response variable again.</p>
<p><em>Formatting</em></p>
<p>Do you remember how you previously labeled your dataset for the phosphorus analysis? You can use that for this exercise. You have already removed NA data, but before proceeding, let’s relabel the response variable to remove empty spaces, which may cause errors going forward:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="logistic-regression.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(filam_diatom_P)[<span class="fu">names</span>(filam_diatom_P) <span class="sc">==</span> <span class="st">&quot;TP dissolved_ECCC1m&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Total_phosphorus&quot;</span></span></code></pre></div>
<p>Now you can create a new column that describes the presence or the absence of filamentous diatoms across the dataset:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="logistic-regression.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To create a new column, first type the label you chose</span></span>
<span id="cb48-2"><a href="logistic-regression.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># previously for the dataframe related to the phosphorus</span></span>
<span id="cb48-3"><a href="logistic-regression.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># analysis (something like &#39;filam_diatom_P&#39;), then create a</span></span>
<span id="cb48-4"><a href="logistic-regression.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># column name, and use the function &#39;ifelse&#39; to label all</span></span>
<span id="cb48-5"><a href="logistic-regression.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># observations where measurements were greater than zero as</span></span>
<span id="cb48-6"><a href="logistic-regression.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;present&#39;, and all observations where measurements were</span></span>
<span id="cb48-7"><a href="logistic-regression.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># equal to zero as &#39;absent&#39;:</span></span>
<span id="cb48-8"><a href="logistic-regression.html#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="logistic-regression.html#cb48-9" aria-hidden="true" tabindex="-1"></a>your_dataset_name<span class="sc">$</span>new_column_name <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(your_dataset_name<span class="sc">$</span>filamentous_Diatom <span class="sc">&gt;</span> </span>
<span id="cb48-10"><a href="logistic-regression.html#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>)</span></code></pre></div>
<p>Format this new column as a factor</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="logistic-regression.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the factor function here</span></span>
<span id="cb49-2"><a href="logistic-regression.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="logistic-regression.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and check how it looks by calling:</span></span>
<span id="cb49-4"><a href="logistic-regression.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(your_dataset_name<span class="sc">$</span>filamentous_Diatom)</span></code></pre></div>
<p><em>Select time periods and locations</em></p>
<p>You can choose to select summer, or another time period. Because we have more data for phosphorus, you can select a single station (column 5: “Station_Acronym”)</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="logistic-regression.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the subset function to select desired periods of time</span></span>
<span id="cb50-2"><a href="logistic-regression.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and locations. You can use &#39;&amp;&#39; for more than one selection</span></span>
<span id="cb50-3"><a href="logistic-regression.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># at the same time, and &#39;|&#39; for selecting either one or other</span></span>
<span id="cb50-4"><a href="logistic-regression.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># option:</span></span>
<span id="cb50-5"><a href="logistic-regression.html#cb50-5" aria-hidden="true" tabindex="-1"></a>your_dataset_name <span class="ot">&lt;-</span> <span class="fu">subset</span>(your_dataset_name, (season <span class="sc">==</span> <span class="st">&quot;your selection&quot;</span> <span class="sc">|</span> </span>
<span id="cb50-6"><a href="logistic-regression.html#cb50-6" aria-hidden="true" tabindex="-1"></a>    season <span class="sc">==</span> <span class="st">&quot;your selection&quot;</span>) <span class="sc">&amp;</span> (Station_Acronym <span class="sc">==</span> <span class="st">&quot;your selection&quot;</span>))</span></code></pre></div>
<p><em>Run model</em></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="logistic-regression.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use glm function and family binomial</span></span>
<span id="cb51-2"><a href="logistic-regression.html#cb51-2" aria-hidden="true" tabindex="-1"></a>your_model_name <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="st">&quot;response variable&quot;</span> <span class="sc">~</span> <span class="st">&quot;explanatory variable&quot;</span>, </span>
<span id="cb51-3"><a href="logistic-regression.html#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> your_dataset_name, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Check model results using the summary function</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="logistic-regression.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(your_model_name)</span></code></pre></div>
<p>How well did this predictor do?</p>
<p><em>Plot model predictions</em></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="logistic-regression.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values for Total_phosphorus</span></span>
<span id="cb53-2"><a href="logistic-regression.html#cb53-2" aria-hidden="true" tabindex="-1"></a>Total_phosphorus_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(filam_diatom_P<span class="sc">$</span>Total_phosphorus), </span>
<span id="cb53-3"><a href="logistic-regression.html#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(filam_diatom_P<span class="sc">$</span>Total_phosphorus), <span class="at">length.out =</span> <span class="fu">length</span>(filam_diatom_P<span class="sc">$</span>Total_phosphorus))</span>
<span id="cb53-4"><a href="logistic-regression.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="logistic-regression.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with Total_phosphorus values</span></span>
<span id="cb53-6"><a href="logistic-regression.html#cb53-6" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Total_phosphorus =</span> Total_phosphorus_values)</span>
<span id="cb53-7"><a href="logistic-regression.html#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="logistic-regression.html#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities for each value of Total_phosphorus</span></span>
<span id="cb53-9"><a href="logistic-regression.html#cb53-9" aria-hidden="true" tabindex="-1"></a>predicted_probabilities_P <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> newdata, </span>
<span id="cb53-10"><a href="logistic-regression.html#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb53-11"><a href="logistic-regression.html#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="logistic-regression.html#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate confidence intervals manually</span></span>
<span id="cb53-13"><a href="logistic-regression.html#cb53-13" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>)<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 95% confidence level</span></span>
<span id="cb53-14"><a href="logistic-regression.html#cb53-14" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(predicted_probabilities_P <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> predicted_probabilities_P)<span class="sc">/</span><span class="fu">nrow</span>(filam_diatom))</span>
<span id="cb53-15"><a href="logistic-regression.html#cb53-15" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> predicted_probabilities_P <span class="sc">-</span> z <span class="sc">*</span> se</span>
<span id="cb53-16"><a href="logistic-regression.html#cb53-16" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> predicted_probabilities_P <span class="sc">+</span> z <span class="sc">*</span> se</span>
<span id="cb53-17"><a href="logistic-regression.html#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="logistic-regression.html#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;present&#39; and &#39;absent&#39; to 1 and 0</span></span>
<span id="cb53-19"><a href="logistic-regression.html#cb53-19" aria-hidden="true" tabindex="-1"></a>presence_numeric_P <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filam_diatom_P<span class="sc">$</span>filam_presence <span class="sc">==</span> </span>
<span id="cb53-20"><a href="logistic-regression.html#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;present&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb53-21"><a href="logistic-regression.html#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="logistic-regression.html#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predicted probabilities with confidence intervals</span></span>
<span id="cb53-23"><a href="logistic-regression.html#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Total_phosphorus_values, predicted_probabilities_P, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb53-24"><a href="logistic-regression.html#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Filamentous diatom presence&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Total phosphorous (dissolved fraction) (mg/L)&quot;</span>, </span>
<span id="cb53-25"><a href="logistic-regression.html#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Predicted probability&quot;</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb53-26"><a href="logistic-regression.html#cb53-26" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-27"><a href="logistic-regression.html#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Total_phosphorus_values, lower_bound, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb53-28"><a href="logistic-regression.html#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Total_phosphorus_values, upper_bound, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb53-29"><a href="logistic-regression.html#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(filam_diatom_P<span class="sc">$</span>Total_phosphorus, presence_numeric_P)</span></code></pre></div>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic4.png" /></p>
</div>
</div>
<div id="what-could-go-wrong-1" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> What could go wrong?<a href="logistic-regression.html#what-could-go-wrong-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><em>Mixing up predictors and response variables in the logistic model equation</em>
<ul>
<li>If you get a warning when running your logistic model, you may have mixed up the predictors and the response variables. The response variable should be the first one to appear after the opening parenthesis</li>
<li>In addition to the variable mix-up, this warning tells us that we may be using quantitative measures as our response variable, which is not appropriate for a logistic regression. See how this error looks like:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="logistic-regression.html#cb54-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Total_phosphorus <span class="sc">~</span> filam_presence, <span class="at">data =</span> filam_diatom_P, </span>
<span id="cb54-2"><a href="logistic-regression.html#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
<ul>
<li><em>Incorrectly coding data so that it is not independent</em></li>
</ul>
<p>Imagine you have counts of living and dead organisms in your dataset:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="logistic-regression.html#cb56-1" aria-hidden="true" tabindex="-1"></a>example_independence <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">rep</span>(<span class="st">&quot;Jan-1-2024&quot;</span>, <span class="at">times =</span> <span class="dv">3</span>), </span>
<span id="cb56-2"><a href="logistic-regression.html#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">location =</span> <span class="fu">c</span>(<span class="st">&quot;station-1&quot;</span>, <span class="st">&quot;station-2&quot;</span>, <span class="st">&quot;station-3&quot;</span>), <span class="at">living_daphnia =</span> <span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">3</span>, </span>
<span id="cb56-3"><a href="logistic-regression.html#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">101</span>)), <span class="at">dead_daphnia =</span> <span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">3</span>, <span class="at">min =</span> <span class="dv">0</span>, </span>
<span id="cb56-4"><a href="logistic-regression.html#cb56-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">max =</span> <span class="dv">101</span>)))</span>
<span id="cb56-5"><a href="logistic-regression.html#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># runif function generates random numbers within the range</span></span>
<span id="cb56-6"><a href="logistic-regression.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># established by &#39;min&#39; and &#39;max&#39; values</span></span>
<span id="cb56-7"><a href="logistic-regression.html#cb56-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(example_independence))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="left">location</th>
<th align="right">living_daphnia</th>
<th align="right">dead_daphnia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jan-1-2024</td>
<td align="left">station-1</td>
<td align="right">20</td>
<td align="right">53</td>
</tr>
<tr class="even">
<td align="left">Jan-1-2024</td>
<td align="left">station-2</td>
<td align="right">36</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Jan-1-2024</td>
<td align="left">station-3</td>
<td align="right">55</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
<p>In this case, instead of considering each individual as “living” or “dead”, you should calculate the proportion of living organisms <em>per replicate</em> like this:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="logistic-regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a>example_independence<span class="sc">$</span>proportion <span class="ot">&lt;-</span> <span class="fu">round</span>(example_independence<span class="sc">$</span>living_daphnia<span class="sc">/</span>(example_independence<span class="sc">$</span>living_daphnia <span class="sc">+</span> </span>
<span id="cb57-2"><a href="logistic-regression.html#cb57-2" aria-hidden="true" tabindex="-1"></a>    example_independence<span class="sc">$</span>dead_daphnia), <span class="dv">2</span>)</span>
<span id="cb57-3"><a href="logistic-regression.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the round function ensures we have 2 decimals in our</span></span>
<span id="cb57-4"><a href="logistic-regression.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># proportion values</span></span>
<span id="cb57-5"><a href="logistic-regression.html#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="logistic-regression.html#cb57-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(example_independence))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="left">location</th>
<th align="right">living_daphnia</th>
<th align="right">dead_daphnia</th>
<th align="right">proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jan-1-2024</td>
<td align="left">station-1</td>
<td align="right">20</td>
<td align="right">53</td>
<td align="right">0.27</td>
</tr>
<tr class="even">
<td align="left">Jan-1-2024</td>
<td align="left">station-2</td>
<td align="right">36</td>
<td align="right">2</td>
<td align="right">0.95</td>
</tr>
<tr class="odd">
<td align="left">Jan-1-2024</td>
<td align="left">station-3</td>
<td align="right">55</td>
<td align="right">100</td>
<td align="right">0.35</td>
</tr>
</tbody>
</table>
<p>This proportion will be your response variable for the logistic model. When using proportions, you should also provide the “weights” information in the glm formula (i.e., a dataset with total number of trials per replicate, or the sum of events where we got success + events where we got failure).</p>
<ul>
<li><em>Categorical response variable is formatted as character instead of factor</em>
<ul>
<li>Formatting data as factors allows for defining order or reference group for statistical testing</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="logistic-regression.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we are selecting and formatting the binomial data as</span></span>
<span id="cb58-2"><a href="logistic-regression.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we did before, but now we accidentally forget to format the</span></span>
<span id="cb58-3"><a href="logistic-regression.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new column as &#39;factor&#39;</span></span>
<span id="cb58-4"><a href="logistic-regression.html#cb58-4" aria-hidden="true" tabindex="-1"></a>example <span class="ot">&lt;-</span> ham</span>
<span id="cb58-5"><a href="logistic-regression.html#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="logistic-regression.html#cb58-6" aria-hidden="true" tabindex="-1"></a>example<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(example<span class="sc">$</span>filamentous_Diatom <span class="sc">&gt;</span> </span>
<span id="cb58-7"><a href="logistic-regression.html#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>)</span>
<span id="cb58-8"><a href="logistic-regression.html#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="logistic-regression.html#cb58-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> mean_mixing_depth_temp, <span class="at">data =</span> example, </span>
<span id="cb58-10"><a href="logistic-regression.html#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<pre><code>Error in eval(family$initialize): y values must be 0 &lt;= y &lt;= 1</code></pre>
<p>Check the data in the problematic column:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="logistic-regression.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(example<span class="sc">$</span>filam_presence)</span></code></pre></div>
<pre><code> chr [1:742] &quot;present&quot; NA NA &quot;present&quot; NA NA NA NA NA NA NA NA &quot;present&quot; NA ...</code></pre>
<p>See how we need to remove NA data and format the column as factor for our model to run nicely:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="logistic-regression.html#cb62-1" aria-hidden="true" tabindex="-1"></a>example <span class="ot">&lt;-</span> example[<span class="sc">!</span><span class="fu">is.na</span>(example<span class="sc">$</span>filamentous_Diatom), ]</span>
<span id="cb62-2"><a href="logistic-regression.html#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="logistic-regression.html#cb62-3" aria-hidden="true" tabindex="-1"></a>example<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">factor</span>(example<span class="sc">$</span>filam_presence)</span>
<span id="cb62-4"><a href="logistic-regression.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="logistic-regression.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(example<span class="sc">$</span>filam_presence)</span></code></pre></div>
<pre><code>[1] &quot;absent&quot;  &quot;present&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="logistic-regression.html#cb64-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> mean_mixing_depth_temp, <span class="at">data =</span> example, </span>
<span id="cb64-2"><a href="logistic-regression.html#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<p>No more errors now!</p>
<p>That’s it for now, but if you are interested in more complex logistic models, here are some resources:</p>
</div>
<div id="r-resources" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> R resources<a href="logistic-regression.html#r-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Multiple logistic regression</em></p>
<ul>
<li><p><a href="https://www.quantitative-biology.ca/machine-learning-and-classification.html#multiple-logistic-regression">Building Skills in Quantitative Biology (Cuddington, Edwards, &amp; Ingalls, 2022)</a></p></li>
<li><p><a href="https://library.virginia.edu/data/articles/getting-started-with-multivariate-multiple-regression">Getting started with Multivariate Multiple Regression (Ford, 2024)</a></p></li>
</ul>
<p><em>Multinomial logistic regression</em></p>
<ul>
<li><a href="https://ladal.edu.au/regression.html#Mixed-Effects_Binomial_Logistic_Regression">Multinomial logistic regression (Russell, 2022)</a></li>
</ul>
<p><em>Mixed-effects logistic regression</em></p>
<ul>
<li><p><a href="https://stats4nr.com/logistic-regression#modeling-more-than-two-responses">Mixed-Effects Binomial Logistic Regression (Schweinberger, 2022 )</a></p></li>
<li><p><a href="https://people.linguistics.mcgill.ca/~morgan/qmld-book/mixed-effects-logistic-regression.html">Mixed-effects logistic regression (Sonderegger, Wagner, &amp; Torreira, 2018)</a></p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-linear-regression-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
