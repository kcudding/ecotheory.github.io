<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Logistic regression | R Intro Workshop</title>
  <meta name="description" content="Building Skills in Quantitative Biology" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Logistic regression | R Intro Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Building Skills in Quantitative Biology" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Logistic regression | R Intro Workshop" />
  
  <meta name="twitter:description" content="Building Skills in Quantitative Biology" />
  

<meta name="author" content="The Cuddington Lab" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-linear-regression.html"/>
<link rel="next" href="multivariate-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to our Workshop!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Get ready for the workshop</a>
<ul>
<li class="chapter" data-level="2.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#r-from-zero-warmup"><i class="fa fa-check"></i><b>2.1</b> R from zero warmup</a></li>
<li class="chapter" data-level="2.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#download-needed-files-and-packages"><i class="fa fa-check"></i><b>2.3</b> Download needed files and packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#package-to-read-.xlsx-file"><i class="fa fa-check"></i><b>2.3.1</b> Package to read .xlsx file</a></li>
<li class="chapter" data-level="2.3.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#other-needed-packages"><i class="fa fa-check"></i><b>2.3.2</b> Other needed packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#load-a-package-into-memory"><i class="fa fa-check"></i><b>2.3.3</b> Load a package into memory</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>3</b> Basic R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-r.html"><a href="basic-r.html#data-import"><i class="fa fa-check"></i><b>3.1</b> Data import</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r.html"><a href="basic-r.html#wheres-my-file"><i class="fa fa-check"></i><b>3.1.1</b> Where’s my file??</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r.html"><a href="basic-r.html#did-the-import-work"><i class="fa fa-check"></i><b>3.1.2</b> Did the import work??</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r.html"><a href="basic-r.html#data-in-r"><i class="fa fa-check"></i><b>3.2</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i><b>3.2.1</b> Data types</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-r.html"><a href="basic-r.html#data-structures"><i class="fa fa-check"></i><b>3.2.2</b> Data structures</a></li>
<li class="chapter" data-level="3.2.3" data-path="basic-r.html"><a href="basic-r.html#selecting-portions-of-a-dataframe"><i class="fa fa-check"></i><b>3.2.3</b> Selecting portions of a dataframe</a></li>
<li class="chapter" data-level="3.2.4" data-path="basic-r.html"><a href="basic-r.html#using-conditional-statements-to-access-data"><i class="fa fa-check"></i><b>3.2.4</b> Using conditional statements to access data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r.html"><a href="basic-r.html#functions-in-r"><i class="fa fa-check"></i><b>3.3</b> Functions in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-r.html"><a href="basic-r.html#summarizing-data"><i class="fa fa-check"></i><b>3.3.1</b> Summarizing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-r.html"><a href="basic-r.html#plotting-data"><i class="fa fa-check"></i><b>3.4</b> Plotting data</a></li>
<li class="chapter" data-level="3.5" data-path="basic-r.html"><a href="basic-r.html#the-editorsource-window"><i class="fa fa-check"></i><b>3.5</b> The Editor(Source) window</a></li>
<li class="chapter" data-level="3.6" data-path="basic-r.html"><a href="basic-r.html#other-ways-of-plotting"><i class="fa fa-check"></i><b>3.6</b> Other ways of plotting</a></li>
<li class="chapter" data-level="3.7" data-path="basic-r.html"><a href="basic-r.html#t-test-and-boxplot"><i class="fa fa-check"></i><b>3.7</b> T-test and boxplot</a></li>
<li class="chapter" data-level="3.8" data-path="basic-r.html"><a href="basic-r.html#a-note-about-base-r-vs-tidyverse"><i class="fa fa-check"></i><b>3.8</b> A note about base R vs Tidyverse</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="basic-r.html"><a href="basic-r.html#other-resources"><i class="fa fa-check"></i><b>3.8.1</b> Other resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction"><i class="fa fa-check"></i><b>4.0.1</b> Introduction</a></li>
<li class="chapter" data-level="4.0.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-using-water-level-and-total-zooplankton"><i class="fa fa-check"></i><b>4.0.2</b> Linear regression using water level and total zooplankton</a></li>
<li class="chapter" data-level="4.0.3" data-path="linear-regression.html"><a href="linear-regression.html#what-are-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.0.3</b> What are the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.0.4" data-path="linear-regression.html"><a href="linear-regression.html#how-do-you-evaluate-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.0.4</b> How do you evaluate the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#plot-the-data-and-predictions"><i class="fa fa-check"></i><b>4.1</b> Plot the data and predictions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="linear-regression.html"><a href="linear-regression.html#get-model-predictions-and-confidence-intervals"><i class="fa fa-check"></i><b>4.1.1</b> Get model predictions and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#plot-the-data-and-predictions-1"><i class="fa fa-check"></i><b>4.2</b> Plot the data and predictions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression.html"><a href="linear-regression.html#common-mistakes"><i class="fa fa-check"></i><b>4.2.1</b> Common mistakes</a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression.html"><a href="linear-regression.html#references-and-resources"><i class="fa fa-check"></i><b>4.2.2</b> References and resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>5</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#what-is-multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.1</b> What is multiple linear regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#recipe-for-multiple-linear-regression-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Recipe for multiple linear regression in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#data-preparation"><i class="fa fa-check"></i><b>5.2</b> Data preparation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#check-data-type"><i class="fa fa-check"></i><b>5.2.1</b> Check data type</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-building"><i class="fa fa-check"></i><b>5.3</b> Model building</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-output"><i class="fa fa-check"></i><b>5.4</b> Model output</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-assumptions"><i class="fa fa-check"></i><b>5.4.1</b> Model assumptions</a></li>
<li class="chapter" data-level="5.4.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#evaluate-model-assumptions"><i class="fa fa-check"></i><b>5.4.2</b> Evaluate model assumptions</a></li>
<li class="chapter" data-level="5.4.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#output-interpretation"><i class="fa fa-check"></i><b>5.4.3</b> Output interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#what-could-go-wrong"><i class="fa fa-check"></i><b>5.5</b> What could go wrong?</a></li>
<li class="chapter" data-level="5.6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#references-and-resources-1"><i class="fa fa-check"></i><b>5.6</b> References and Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-is-a-logistic-regression"><i class="fa fa-check"></i><b>6.1</b> What is a logistic regression?</a></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#how-are-logistic-regressions-different-from-linear-regressions"><i class="fa fa-check"></i><b>6.2</b> How are logistic regressions different from linear regressions?</a></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#how-does-this-type-of-data-look-like"><i class="fa fa-check"></i><b>6.3</b> How does this type of data look like?</a></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#what-does-the-logistic-curve-mean"><i class="fa fa-check"></i><b>6.4</b> What does the logistic curve mean?</a></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#aquatic-ecology-studies-using-logistic-regressions"><i class="fa fa-check"></i><b>6.5</b> Aquatic ecology studies using logistic regressions</a></li>
<li class="chapter" data-level="6.6" data-path="logistic-regression.html"><a href="logistic-regression.html#what-kind-of-predictors-can-we-have-in-a-logistic-regression"><i class="fa fa-check"></i><b>6.6</b> What kind of predictors can we have in a logistic regression?</a></li>
<li class="chapter" data-level="6.7" data-path="logistic-regression.html"><a href="logistic-regression.html#mathematical-representation"><i class="fa fa-check"></i><b>6.7</b> Mathematical representation</a></li>
<li class="chapter" data-level="6.8" data-path="logistic-regression.html"><a href="logistic-regression.html#key-binomial-logistic-model-assumptions"><i class="fa fa-check"></i><b>6.8</b> Key binomial logistic model assumptions</a></li>
<li class="chapter" data-level="6.9" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9</b> Creating a logistic model in R</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#steps-to-run-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9.1</b> Steps to run a logistic model in R</a></li>
<li class="chapter" data-level="6.9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#lets-create-this-first-model-together"><i class="fa fa-check"></i><b>6.9.2</b> Let’s create this first model together</a></li>
<li class="chapter" data-level="6.9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-your-logistic-model"><i class="fa fa-check"></i><b>6.9.3</b> Creating your logistic model</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="logistic-regression.html"><a href="logistic-regression.html#additional-resources"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-could-go-wrong-1"><i class="fa fa-check"></i><b>6.10.1</b> What could go wrong?</a></li>
<li class="chapter" data-level="6.10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-resources"><i class="fa fa-check"></i><b>6.10.2</b> R resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>7</b> Multivariate analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#introduction-to-multivariate-analysis"><i class="fa fa-check"></i><b>7.1</b> Introduction to multivariate analysis</a></li>
<li class="chapter" data-level="7.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>7.2</b> Principle Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#why-should-we-use-pca"><i class="fa fa-check"></i><b>7.2.1</b> Why should we use PCA?</a></li>
<li class="chapter" data-level="7.2.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#correlation-examination"><i class="fa fa-check"></i><b>7.2.2</b> Correlation examination</a></li>
<li class="chapter" data-level="7.2.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-standardized-data"><i class="fa fa-check"></i><b>7.2.3</b> PCA with standardized data</a></li>
<li class="chapter" data-level="7.2.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#extract-samples-and-variables-scores-in-new-ordination-system"><i class="fa fa-check"></i><b>7.2.4</b> Extract samples and variables scores in new ordination system</a></li>
<li class="chapter" data-level="7.2.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#screeplot"><i class="fa fa-check"></i><b>7.2.5</b> Screeplot</a></li>
<li class="chapter" data-level="7.2.6" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-pca"><i class="fa fa-check"></i><b>7.2.6</b> Plot ordination for PCA</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-metric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>7.3</b> Non-metric multidimensional scaling (nMDS)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#shepard-plot"><i class="fa fa-check"></i><b>7.3.1</b> Shepard Plot</a></li>
<li class="chapter" data-level="7.3.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-nmds"><i class="fa fa-check"></i><b>7.3.2</b> Plot ordination for nMDS</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#other-resources-1"><i class="fa fa-check"></i><b>7.4</b> Other resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Intro Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Logistic regression<a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-is-a-logistic-regression" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> What is a logistic regression?<a href="logistic-regression.html#what-is-a-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Association between binary response variable and predictors</li>
<li>Example: species distribution models
<ul>
<li>Binary response variable: presence (1) or absence (0) of species in area</li>
<li>Predictions of habitat suitability</li>
</ul></li>
</ul>
</div>
<div id="how-are-logistic-regressions-different-from-linear-regressions" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> How are logistic regressions different from linear regressions?<a href="logistic-regression.html#how-are-logistic-regressions-different-from-linear-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Linear regression</em><br />
- Quantitative predictions: straight line<br />
- Correlation and test for significance of regression<br />
- Model comparison (eg., single versus several predictors)</p>
<p><em>Logistic regression</em><br />
- We can also do all of that!<br />
- Main difference: our outcomes are now <em>binary</em>
- Examples of binary outcomes: presence versus absence; positive to a disease versus negative; dead versus alive<br />
- Outcomes can be categorized as 1 (e.g., success) and 0 (e.g., failure)</p>
</div>
<div id="how-does-this-type-of-data-look-like" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> How does this type of data look like?<a href="logistic-regression.html#how-does-this-type-of-data-look-like" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is some hypothetical data of a undesirable organism, as it is less edible for zooplankton. We record the presence or absence of this organism at each observation like this:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
Nitrate/nitrite
</th>
<th style="text-align:left;">
Presence
</th>
<th style="text-align:right;">
Binary
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:left;">
yes
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>When we plot this type of binary data, we see that observations are either of the two outcome possibilities:</p>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic1.png" /></p>
<p>As you can see in the plot, this type of data is best fit by an s-shaped curve instead of a line. And this is another difference between linear and logistic regressions.</p>
</div>
<div id="what-does-the-logistic-curve-mean" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> What does the logistic curve mean?<a href="logistic-regression.html#what-does-the-logistic-curve-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic2.png" /></p>
<ul>
<li>It represents the <em>probability</em> of positive outcomes depending on predictors<br />
</li>
<li>As we move along the curve and our predictor values change, we go from 0 to 100% probability of our outcome</li>
</ul>
</div>
<div id="aquatic-ecology-studies-using-logistic-regressions" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Aquatic ecology studies using logistic regressions<a href="logistic-regression.html#aquatic-ecology-studies-using-logistic-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>The distribution of gammarid species was predicted using logistic regressions, where current velocity was the most important factor explaining their distribution <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1046/j.1365-2427.1998.00304.x">(Peeters &amp; Gardeniers, 1998)</a></p></li>
<li><p>Foraging shift behaviour from the benthos to the water surface in brown trout (1 = surface prey consumed, 0 = no surface prey consumed) was predicted using fish length as a predictor in a logistic regression <a href="https://cdnsciencepub.com/doi/full/10.1139/cjfas-2017-0021%5D">(Sánchez-Hernández &amp; Cobo, 2017)</a></p></li>
</ul>
<div class="figure">
<img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic_studies_example.jpg" alt="" />
<p class="caption"><a href="https://commons.wikimedia.org/wiki/File:Amphipod_Gammaridae_%288741971996%29.jpg">Amphipod Gammaridae</a>; <a href="https://www.flickr.com/photos/usfwsmtnprairie/49860328703">Brown Trout, USFWS Mountain-Prairie</a></p>
</div>
</div>
<div id="what-kind-of-predictors-can-we-have-in-a-logistic-regression" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> What kind of predictors can we have in a logistic regression?<a href="logistic-regression.html#what-kind-of-predictors-can-we-have-in-a-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just like in a linear regression, we can use continuous and/or categorical variables to make predictions. Here are some examples:</p>
<p><strong>Continuous variables</strong></p>
<ul>
<li><p>Temperature</p></li>
<li><p>Precipitation</p></li>
<li><p>Water depth</p></li>
<li><p>Nitrogen concentration</p></li>
</ul>
<p><strong>Categorical variables</strong></p>
<ul>
<li><p>Levels of aquatic vegetation</p></li>
<li><p>Soil type</p></li>
<li><p>Water body type</p></li>
</ul>
</div>
<div id="mathematical-representation" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Mathematical representation<a href="logistic-regression.html#mathematical-representation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Logistic regression: transformation of response variable to get linear relationship<br />
</li>
<li>logit (log of probability of success/probability of failure)</li>
<li>Explanatory variable is in log(odds)</li>
</ul>
<p>Equation for logistic regression:</p>
<p><span class="math display">\[ Log (p/1-p) = b0+b1*x1+e \]</span>
<em>Log (p/1-p)</em>: response variable<br />
<em>b0</em>: y intercept<br />
<em>x</em>: predictor variable<br />
<em>b1</em>: slope for explanatory variable 1<br />
<em>e</em>: error</p>
<p>If we had more explanatory variables, we could keep adding them to the equation above as b2*x2 and so forth.</p>
</div>
<div id="key-binomial-logistic-model-assumptions" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Key binomial logistic model assumptions<a href="logistic-regression.html#key-binomial-logistic-model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Dependent variable has 2 levels or is a proportion of successes</p></li>
<li><p>Observations are independent</p></li>
<li><p>Normal distribution of data or residuals is not needed</p></li>
</ul>
</div>
<div id="creating-a-logistic-model-in-r" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Creating a logistic model in R<a href="logistic-regression.html#creating-a-logistic-model-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="steps-to-run-a-logistic-model-in-r" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Steps to run a logistic model in R<a href="logistic-regression.html#steps-to-run-a-logistic-model-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Select potentially interesting predictors</li>
<li>Format predictors to correspond to binomial levels</li>
<li>Select time period and location</li>
<li>Run model</li>
<li>Interpret model</li>
<li>Plot results</li>
</ol>
</div>
<div id="lets-create-this-first-model-together" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Let’s create this first model together<a href="logistic-regression.html#lets-create-this-first-model-together" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we are going to create a new dataset called “filam_diatom” including some potentially interesting variables:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="logistic-regression.html#cb77-1" aria-hidden="true" tabindex="-1"></a>filam_diatom <span class="ot">&lt;-</span> ham[, <span class="fu">c</span>(<span class="st">&quot;area_group&quot;</span>, <span class="st">&quot;season&quot;</span>, <span class="st">&quot;filamentous_Diatom&quot;</span>, </span>
<span id="cb77-2"><a href="logistic-regression.html#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;mean_mixing_depth_temp&quot;</span>, <span class="st">&quot;NO2_NO3_ECCC1m&quot;</span>)]</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:center;">
Location
</th>
<th style="text-align:center;">
Season
</th>
<th style="text-align:center;">
Filamentous diatom biomass
</th>
<th style="text-align:center;">
Epilimnion temperat.
</th>
<th style="text-align:center;">
Nitrate/nitrate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
deep
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
21.8
</td>
<td style="text-align:center;">
2.50
</td>
</tr>
<tr>
<td style="text-align:center;">
deep
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3.1
</td>
<td style="text-align:center;">
21.8
</td>
<td style="text-align:center;">
2.50
</td>
</tr>
<tr>
<td style="text-align:center;">
NE
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
19.9
</td>
<td style="text-align:center;">
3.20
</td>
</tr>
<tr>
<td style="text-align:center;">
deep
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
19.7
</td>
<td style="text-align:center;">
3.20
</td>
</tr>
<tr>
<td style="text-align:center;">
NE
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
13.9
</td>
<td style="text-align:center;">
2.54
</td>
</tr>
<tr>
<td style="text-align:center;">
deep
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
287.2
</td>
<td style="text-align:center;">
16.1
</td>
<td style="text-align:center;">
2.54
</td>
</tr>
</tbody>
</table>
<p>Let’s consider that <em>filamentous diatom</em> is our response variable of interest, as this food source is hard for zooplankton to consume. We will look at <em>epilimnion temperature</em> as a potential explanatory variable.</p>
<p>First, we will create a new column to describe presence or absence of filamentous diatoms.</p>
<p>We can do that with a function called <strong>ifelse</strong> to label all observations where measurements were greater than zero as “present”, and all observations where measurements were equal to zero as “absent”:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="logistic-regression.html#cb78-1" aria-hidden="true" tabindex="-1"></a>filam_diatom<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filam_diatom<span class="sc">$</span>filamentous_Diatom <span class="sc">&gt;</span> </span>
<span id="cb78-2"><a href="logistic-regression.html#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>)</span></code></pre></div>
<p>Now we format this column as <strong>factor</strong> and ensure the reference group (“absent”) is the first to be shown:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="logistic-regression.html#cb79-1" aria-hidden="true" tabindex="-1"></a>filam_diatom<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">factor</span>(filam_diatom<span class="sc">$</span>filam_presence)</span>
<span id="cb79-2"><a href="logistic-regression.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(filam_diatom<span class="sc">$</span>filam_presence)</span></code></pre></div>
<pre><code>[1] &quot;absent&quot;  &quot;present&quot;</code></pre>
<ul>
<li>Subsetting to analyse at specific times of the year and at specific locations</li>
</ul>
<p>Here we select summer conditions and remove deep locations:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="logistic-regression.html#cb81-1" aria-hidden="true" tabindex="-1"></a>filam_diatom <span class="ot">&lt;-</span> filam_diatom[(filam_diatom<span class="sc">$</span>season <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> filam_diatom<span class="sc">$</span>season <span class="sc">==</span> </span>
<span id="cb81-2"><a href="logistic-regression.html#cb81-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>) <span class="sc">&amp;</span> filam_diatom<span class="sc">$</span>area_group <span class="sc">!=</span> <span class="st">&quot;deep&quot;</span>, ]</span></code></pre></div>
<p>Run model using <strong>glm</strong> function and family <strong>binomial</strong></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="logistic-regression.html#cb82-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> mean_mixing_depth_temp, <span class="at">data =</span> filam_diatom, </span>
<span id="cb82-2"><a href="logistic-regression.html#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Now we can check the model results</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="logistic-regression.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>
Call:
glm(formula = filam_presence ~ mean_mixing_depth_temp, family = binomial, 
    data = filam_diatom)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-2.000  -0.897   0.514   0.873   1.238  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)              10.158      3.840    2.65  8.2e-03 **
mean_mixing_depth_temp   -0.420      0.174   -2.42  1.6e-02 * 
---
Signif. codes:  0 &#39;***&#39; 1e-03 &#39;**&#39; 1e-02 &#39;*&#39; 5e-02 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 79.807  on 69  degrees of freedom
Residual deviance: 72.195  on 68  degrees of freedom
  (197 observations deleted due to missingness)
AIC: 76.2

Number of Fisher Scoring iterations: 5</code></pre>
<p>So we can see that our p-value for the epilimnion temperature predictor is smaller than 0.05. This suggests that there is a statistically significant relationship between temperature and the presence of filamentous diatoms.</p>
<p>Let’s see what each component of the model result summary means:</p>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic_model_output.jpg" /></p>
<p>We are now ready for the best part: plotting model predictions</p>
<p>First, we save the regression coefficients:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="logistic-regression.html#cb85-1" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.data.frame</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coefficients), </span>
<span id="cb85-2"><a href="logistic-regression.html#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>)</span></code></pre></div>
<p>And we plot the actual data and the model predictions:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="logistic-regression.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;present&#39; and &#39;absent&#39; to 1 and 0</span></span>
<span id="cb86-2"><a href="logistic-regression.html#cb86-2" aria-hidden="true" tabindex="-1"></a>presence_numeric_filam <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filam_diatom<span class="sc">$</span>filam_presence <span class="sc">==</span> </span>
<span id="cb86-3"><a href="logistic-regression.html#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;present&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb86-4"><a href="logistic-regression.html#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="logistic-regression.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(filam_diatom<span class="sc">$</span>mean_mixing_depth_temp, presence_numeric_filam, </span>
<span id="cb86-6"><a href="logistic-regression.html#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">main =</span> <span class="st">&quot;Filamentous diatom presence&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Epilimnion temperature (°C)&quot;</span>, </span>
<span id="cb86-7"><a href="logistic-regression.html#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Predicted probability&quot;</span>, <span class="at">cex.axis =</span> <span class="fl">1.3</span>, <span class="at">cex.lab =</span> <span class="fl">1.3</span>, </span>
<span id="cb86-8"><a href="logistic-regression.html#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-9"><a href="logistic-regression.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(coefficients[<span class="dv">1</span>, </span>
<span id="cb86-10"><a href="logistic-regression.html#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>] <span class="sc">+</span> coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> x)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic3.png" /></p>
</div>
<div id="creating-your-logistic-model" class="section level3 hasAnchor" number="6.9.3">
<h3><span class="header-section-number">6.9.3</span> Creating your logistic model<a href="logistic-regression.html#creating-your-logistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now it’s your turn! Run this next logistic model using nitrite/nitrate as a potential predictor, and filamentous diatoms as the response variable again.</p>
<div id="try-it-now-31" class="section level4 unnumbered hasAnchor">
<h4>Try it now<a href="logistic-regression.html#try-it-now-31" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Use the same dataset “filam_diatom” to run a new logistic model. Copy the code above, but replace the predictor temperature (“mean_mixing_depth_temp”) with nitrite/nitrate (“NO2_NO3_ECCC1m”). How well does this explanatory variable predict the probability of finding filamentous diatom?</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="logistic-regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> NO2_NO3_ECCC1m, <span class="at">data =</span> filam_diatom, </span>
<span id="cb87-2"><a href="logistic-regression.html#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span>
<span id="cb87-3"><a href="logistic-regression.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>
Call:
glm(formula = filam_presence ~ NO2_NO3_ECCC1m, family = binomial, 
    data = filam_diatom)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-2.235  -1.285   0.661   0.831   1.079  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)      -1.718      1.545   -1.11     0.27  
NO2_NO3_ECCC1m    1.303      0.744    1.75     0.08 .
---
Signif. codes:  0 &#39;***&#39; 1e-03 &#39;**&#39; 1e-02 &#39;*&#39; 5e-02 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 74.094  on 63  degrees of freedom
Residual deviance: 70.565  on 62  degrees of freedom
  (203 observations deleted due to missingness)
AIC: 74.57

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="logistic-regression.html#cb89-1" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.data.frame</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coefficients), </span>
<span id="cb89-2"><a href="logistic-regression.html#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>)</span>
<span id="cb89-3"><a href="logistic-regression.html#cb89-3" aria-hidden="true" tabindex="-1"></a>presence_numeric_filam <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filam_diatom<span class="sc">$</span>filam_presence <span class="sc">==</span> </span>
<span id="cb89-4"><a href="logistic-regression.html#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;present&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb89-5"><a href="logistic-regression.html#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(filam_diatom<span class="sc">$</span>NO2_NO3_ECCC1m, presence_numeric_filam, <span class="at">pch =</span> <span class="dv">16</span>, </span>
<span id="cb89-6"><a href="logistic-regression.html#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Filamentous diatom presence&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Nitrite + Nitrate (mg/L)&quot;</span>, </span>
<span id="cb89-7"><a href="logistic-regression.html#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Predicted probability&quot;</span>, <span class="at">cex.axis =</span> <span class="fl">1.3</span>, <span class="at">cex.lab =</span> <span class="fl">1.3</span>, </span>
<span id="cb89-8"><a href="logistic-regression.html#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-9"><a href="logistic-regression.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(coefficients[<span class="dv">1</span>, </span>
<span id="cb89-10"><a href="logistic-regression.html#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>] <span class="sc">+</span> coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> x)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/RIntro/logistic4.png" /></p>
</div>
</div>
</div>
<div id="additional-resources" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Additional resources<a href="logistic-regression.html#additional-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-could-go-wrong-1" class="section level3 hasAnchor" number="6.10.1">
<h3><span class="header-section-number">6.10.1</span> What could go wrong?<a href="logistic-regression.html#what-could-go-wrong-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><em>Mixing up predictors and response variables in the logistic model equation</em>
<ul>
<li>If you get a warning or error when running your logistic model, you may have mixed up the predictors and the response variables. The response variable should be the first one to appear after the opening parenthesis</li>
<li>In addition to the variable mix-up, such warning or errors tell us that we may be using quantitative measures as our response variable, which is not appropriate for a logistic regression. See how this error looks like:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="logistic-regression.html#cb90-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(mean_mixing_depth_temp <span class="sc">~</span> filam_presence, <span class="at">data =</span> filam_diatom, </span>
<span id="cb90-2"><a href="logistic-regression.html#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<pre><code>Error in eval(family$initialize): y values must be 0 &lt;= y &lt;= 1</code></pre>
<ul>
<li><em>Incorrectly coding data so that it is not independent</em></li>
</ul>
<p>Imagine you have counts of living and dead organisms in this imaginary dataset:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
location
</th>
<th style="text-align:right;">
living_daphnia
</th>
<th style="text-align:right;">
dead_daphnia
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Jan-1-2024
</td>
<td style="text-align:left;">
station-1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:left;">
Jan-1-2024
</td>
<td style="text-align:left;">
station-2
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
Jan-1-2024
</td>
<td style="text-align:left;">
station-3
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>In this case, instead of considering each individual as “living” or “dead”, you should calculate the proportion of living organisms <em>per replicate</em> like this:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="logistic-regression.html#cb92-1" aria-hidden="true" tabindex="-1"></a>example_independence<span class="sc">$</span>proportion <span class="ot">&lt;-</span> <span class="fu">round</span>(example_independence<span class="sc">$</span>living_daphnia<span class="sc">/</span>(example_independence<span class="sc">$</span>living_daphnia <span class="sc">+</span> </span>
<span id="cb92-2"><a href="logistic-regression.html#cb92-2" aria-hidden="true" tabindex="-1"></a>    example_independence<span class="sc">$</span>dead_daphnia), <span class="dv">2</span>)</span>
<span id="cb92-3"><a href="logistic-regression.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the &#39;round&#39; function ensures we have 2 decimals in our</span></span>
<span id="cb92-4"><a href="logistic-regression.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># proportion values</span></span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
location
</th>
<th style="text-align:right;">
living_daphnia
</th>
<th style="text-align:right;">
dead_daphnia
</th>
<th style="text-align:right;">
proportion
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Jan-1-2024
</td>
<td style="text-align:left;">
station-1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
Jan-1-2024
</td>
<td style="text-align:left;">
station-2
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:left;">
Jan-1-2024
</td>
<td style="text-align:left;">
station-3
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.98
</td>
</tr>
</tbody>
</table>
<p>This proportion will be your response variable for the logistic model. When using proportions, you should also provide the “weights” information in the glm formula (i.e., a dataset with total number of trials per replicate, or the sum of events where we got success + events where we got failure).</p>
<ul>
<li><em>Categorical response variable is formatted as character instead of factor</em>
<ul>
<li>Formatting data as factors allows for defining order or reference group for statistical testing</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="logistic-regression.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we are selecting and formatting the binomial data as</span></span>
<span id="cb93-2"><a href="logistic-regression.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we did before, but now we accidentally forget to format the</span></span>
<span id="cb93-3"><a href="logistic-regression.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new column as &#39;factor&#39;</span></span>
<span id="cb93-4"><a href="logistic-regression.html#cb93-4" aria-hidden="true" tabindex="-1"></a>example <span class="ot">&lt;-</span> ham</span>
<span id="cb93-5"><a href="logistic-regression.html#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="logistic-regression.html#cb93-6" aria-hidden="true" tabindex="-1"></a>example<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(example<span class="sc">$</span>filamentous_Diatom <span class="sc">&gt;</span> </span>
<span id="cb93-7"><a href="logistic-regression.html#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>)</span>
<span id="cb93-8"><a href="logistic-regression.html#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="logistic-regression.html#cb93-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> mean_mixing_depth_temp, <span class="at">data =</span> example, </span>
<span id="cb93-10"><a href="logistic-regression.html#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<pre><code>Error in eval(family$initialize): y values must be 0 &lt;= y &lt;= 1</code></pre>
<p>Check the data in the problematic column:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="logistic-regression.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(example<span class="sc">$</span>filam_presence)</span></code></pre></div>
<pre><code> chr [1:742] &quot;present&quot; NA NA &quot;present&quot; NA NA NA NA NA NA NA NA &quot;present&quot; NA &quot;present&quot; NA NA NA NA NA NA &quot;absent&quot; &quot;present&quot; &quot;present&quot; &quot;absent&quot; &quot;present&quot; NA NA NA &quot;present&quot; &quot;absent&quot; &quot;present&quot; NA NA NA &quot;present&quot; NA NA NA NA NA NA NA NA &quot;present&quot; NA NA &quot;absent&quot; &quot;present&quot; NA &quot;present&quot; &quot;present&quot; &quot;present&quot; NA &quot;present&quot; NA NA NA &quot;present&quot; &quot;present&quot; NA &quot;present&quot; &quot;present&quot; NA &quot;present&quot; NA &quot;absent&quot; &quot;present&quot; &quot;present&quot; &quot;present&quot; &quot;present&quot; &quot;absent&quot; NA &quot;present&quot; &quot;present&quot; &quot;absent&quot; NA NA NA NA NA ...</code></pre>
<p>See how we need to format the column as factor for our model to run nicely:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="logistic-regression.html#cb97-1" aria-hidden="true" tabindex="-1"></a>example<span class="sc">$</span>filam_presence <span class="ot">&lt;-</span> <span class="fu">factor</span>(example<span class="sc">$</span>filam_presence)</span>
<span id="cb97-2"><a href="logistic-regression.html#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="logistic-regression.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(example<span class="sc">$</span>filam_presence)</span></code></pre></div>
<pre><code>[1] &quot;absent&quot;  &quot;present&quot;</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="logistic-regression.html#cb99-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(filam_presence <span class="sc">~</span> mean_mixing_depth_temp, <span class="at">data =</span> example, </span>
<span id="cb99-2"><a href="logistic-regression.html#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial)</span></code></pre></div>
<p>No more errors now!</p>
<p>That’s it for now, but if you are interested in more complex logistic models, here are some resources:</p>
</div>
<div id="r-resources" class="section level3 hasAnchor" number="6.10.2">
<h3><span class="header-section-number">6.10.2</span> R resources<a href="logistic-regression.html#r-resources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Multiple logistic regression</em></p>
<ul>
<li><p><a href="https://www.quantitative-biology.ca/machine-learning-and-classification.html#multiple-logistic-regression">Building Skills in Quantitative Biology (Cuddington, Edwards, &amp; Ingalls, 2022)</a></p></li>
<li><p><a href="https://library.virginia.edu/data/articles/getting-started-with-multivariate-multiple-regression">Getting started with Multivariate Multiple Regression (Ford, 2024)</a></p></li>
</ul>
<p><em>Multinomial logistic regression</em></p>
<ul>
<li><a href="https://ladal.edu.au/regression.html#Mixed-Effects_Binomial_Logistic_Regression">Multinomial logistic regression (Russell, 2022)</a></li>
</ul>
<p><em>Mixed-effects logistic regression</em></p>
<ul>
<li><p><a href="https://stats4nr.com/logistic-regression#modeling-more-than-two-responses">Mixed-Effects Binomial Logistic Regression (Schweinberger, 2022 )</a></p></li>
<li><p><a href="https://people.linguistics.mcgill.ca/~morgan/qmld-book/mixed-effects-logistic-regression.html">Mixed-effects logistic regression (Sonderegger, Wagner, &amp; Torreira, 2018)</a></p></li>
</ul>

<pre><code>Loading required package: permute</code></pre>
<pre><code>Loading required package: lattice</code></pre>
<pre><code>This is vegan 2.5-6</code></pre>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
