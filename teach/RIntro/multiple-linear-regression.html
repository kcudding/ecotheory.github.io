<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Multiple Linear Regression | R Intro Workshop</title>
  <meta name="description" content="Building Skills in Quantitative Biology" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Multiple Linear Regression | R Intro Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Building Skills in Quantitative Biology" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Multiple Linear Regression | R Intro Workshop" />
  
  <meta name="twitter:description" content="Building Skills in Quantitative Biology" />
  

<meta name="author" content="The Cuddington Lab" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="logistic-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to our Workshop!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Get ready for the workshop</a>
<ul>
<li class="chapter" data-level="2.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#r-from-zero-warmup"><i class="fa fa-check"></i><b>2.1</b> R from zero warmup</a></li>
<li class="chapter" data-level="2.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#download-needed-files-and-packages"><i class="fa fa-check"></i><b>2.3</b> Download needed files and packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#package-to-read-.xlsx-file"><i class="fa fa-check"></i><b>2.3.1</b> Package to read .xlsx file</a></li>
<li class="chapter" data-level="2.3.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#other-needed-packages"><i class="fa fa-check"></i><b>2.3.2</b> Other needed packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#load-a-package-into-memory"><i class="fa fa-check"></i><b>2.3.3</b> Load a package into memory</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>3</b> Basic R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-r.html"><a href="basic-r.html#data-import"><i class="fa fa-check"></i><b>3.1</b> Data import</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r.html"><a href="basic-r.html#wheres-my-file"><i class="fa fa-check"></i><b>3.1.1</b> Where’s my file??</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r.html"><a href="basic-r.html#did-the-import-work"><i class="fa fa-check"></i><b>3.1.2</b> Did the import work??</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r.html"><a href="basic-r.html#data-in-r"><i class="fa fa-check"></i><b>3.2</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i><b>3.2.1</b> Data types</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-r.html"><a href="basic-r.html#data-structures"><i class="fa fa-check"></i><b>3.2.2</b> Data structures</a></li>
<li class="chapter" data-level="3.2.3" data-path="basic-r.html"><a href="basic-r.html#selecting-portions-of-a-dataframe"><i class="fa fa-check"></i><b>3.2.3</b> Selecting portions of a dataframe</a></li>
<li class="chapter" data-level="3.2.4" data-path="basic-r.html"><a href="basic-r.html#using-conditional-statements-to-access-data"><i class="fa fa-check"></i><b>3.2.4</b> Using conditional statements to access data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r.html"><a href="basic-r.html#functions-in-r"><i class="fa fa-check"></i><b>3.3</b> Functions in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-r.html"><a href="basic-r.html#summarizing-data"><i class="fa fa-check"></i><b>3.3.1</b> Summarizing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-r.html"><a href="basic-r.html#plotting-data"><i class="fa fa-check"></i><b>3.4</b> Plotting data</a></li>
<li class="chapter" data-level="3.5" data-path="basic-r.html"><a href="basic-r.html#the-editorsource-window"><i class="fa fa-check"></i><b>3.5</b> The Editor(Source) window</a></li>
<li class="chapter" data-level="3.6" data-path="basic-r.html"><a href="basic-r.html#other-ways-of-plotting"><i class="fa fa-check"></i><b>3.6</b> Other ways of plotting</a></li>
<li class="chapter" data-level="3.7" data-path="basic-r.html"><a href="basic-r.html#t-test-and-boxplot"><i class="fa fa-check"></i><b>3.7</b> T-test and boxplot</a></li>
<li class="chapter" data-level="3.8" data-path="basic-r.html"><a href="basic-r.html#a-note-about-base-r-vs-tidyverse"><i class="fa fa-check"></i><b>3.8</b> A note about base R vs Tidyverse</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="basic-r.html"><a href="basic-r.html#other-resources"><i class="fa fa-check"></i><b>3.8.1</b> Other resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction"><i class="fa fa-check"></i><b>4.0.1</b> Introduction</a></li>
<li class="chapter" data-level="4.0.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-using-water-level-and-total-zooplankton"><i class="fa fa-check"></i><b>4.0.2</b> Linear regression using water level and total zooplankton</a></li>
<li class="chapter" data-level="4.0.3" data-path="linear-regression.html"><a href="linear-regression.html#what-are-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.0.3</b> What are the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.0.4" data-path="linear-regression.html"><a href="linear-regression.html#how-do-you-evaluate-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.0.4</b> How do you evaluate the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#plot-the-data-and-predictions"><i class="fa fa-check"></i><b>4.1</b> Plot the data and predictions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="linear-regression.html"><a href="linear-regression.html#get-model-predictions-and-confidence-intervals"><i class="fa fa-check"></i><b>4.1.1</b> Get model predictions and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#plot-the-data-and-predictions-1"><i class="fa fa-check"></i><b>4.2</b> Plot the data and predictions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression.html"><a href="linear-regression.html#common-mistakes"><i class="fa fa-check"></i><b>4.2.1</b> Common mistakes</a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression.html"><a href="linear-regression.html#references-and-resources"><i class="fa fa-check"></i><b>4.2.2</b> References and resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>5</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#what-is-multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.1</b> What is multiple linear regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#recipe-for-multiple-linear-regression-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Recipe for multiple linear regression in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#data-preparation"><i class="fa fa-check"></i><b>5.2</b> Data preparation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#check-data-type"><i class="fa fa-check"></i><b>5.2.1</b> Check data type</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-building"><i class="fa fa-check"></i><b>5.3</b> Model building</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-output"><i class="fa fa-check"></i><b>5.4</b> Model output</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-assumptions"><i class="fa fa-check"></i><b>5.4.1</b> Model assumptions</a></li>
<li class="chapter" data-level="5.4.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#evaluate-model-assumptions"><i class="fa fa-check"></i><b>5.4.2</b> Evaluate model assumptions</a></li>
<li class="chapter" data-level="5.4.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#output-interpretation"><i class="fa fa-check"></i><b>5.4.3</b> Output interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#what-could-go-wrong"><i class="fa fa-check"></i><b>5.5</b> What could go wrong?</a></li>
<li class="chapter" data-level="5.6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#references-and-resources-1"><i class="fa fa-check"></i><b>5.6</b> References and Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-is-a-logistic-regression"><i class="fa fa-check"></i><b>6.1</b> What is a logistic regression?</a></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#how-are-logistic-regressions-different-from-linear-regressions"><i class="fa fa-check"></i><b>6.2</b> How are logistic regressions different from linear regressions?</a></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#how-does-this-type-of-data-look-like"><i class="fa fa-check"></i><b>6.3</b> How does this type of data look like?</a></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#what-does-the-logistic-curve-mean"><i class="fa fa-check"></i><b>6.4</b> What does the logistic curve mean?</a></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#aquatic-ecology-studies-using-logistic-regressions"><i class="fa fa-check"></i><b>6.5</b> Aquatic ecology studies using logistic regressions</a></li>
<li class="chapter" data-level="6.6" data-path="logistic-regression.html"><a href="logistic-regression.html#what-kind-of-predictors-can-we-have-in-a-logistic-regression"><i class="fa fa-check"></i><b>6.6</b> What kind of predictors can we have in a logistic regression?</a></li>
<li class="chapter" data-level="6.7" data-path="logistic-regression.html"><a href="logistic-regression.html#mathematical-representation"><i class="fa fa-check"></i><b>6.7</b> Mathematical representation</a></li>
<li class="chapter" data-level="6.8" data-path="logistic-regression.html"><a href="logistic-regression.html#key-binomial-logistic-model-assumptions"><i class="fa fa-check"></i><b>6.8</b> Key binomial logistic model assumptions</a></li>
<li class="chapter" data-level="6.9" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9</b> Creating a logistic model in R</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#steps-to-run-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9.1</b> Steps to run a logistic model in R</a></li>
<li class="chapter" data-level="6.9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#lets-create-this-first-model-together"><i class="fa fa-check"></i><b>6.9.2</b> Let’s create this first model together</a></li>
<li class="chapter" data-level="6.9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-your-logistic-model"><i class="fa fa-check"></i><b>6.9.3</b> Creating your logistic model</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="logistic-regression.html"><a href="logistic-regression.html#additional-resources"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-could-go-wrong-1"><i class="fa fa-check"></i><b>6.10.1</b> What could go wrong?</a></li>
<li class="chapter" data-level="6.10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-resources"><i class="fa fa-check"></i><b>6.10.2</b> R resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>7</b> Multivariate analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#introduction-to-multivariate-analysis"><i class="fa fa-check"></i><b>7.1</b> Introduction to multivariate analysis</a></li>
<li class="chapter" data-level="7.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>7.2</b> Principle Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#why-should-we-use-pca"><i class="fa fa-check"></i><b>7.2.1</b> Why should we use PCA?</a></li>
<li class="chapter" data-level="7.2.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#correlation-examination"><i class="fa fa-check"></i><b>7.2.2</b> Correlation examination</a></li>
<li class="chapter" data-level="7.2.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-standardized-data"><i class="fa fa-check"></i><b>7.2.3</b> PCA with standardized data</a></li>
<li class="chapter" data-level="7.2.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#extract-samples-and-variables-scores-in-new-ordination-system"><i class="fa fa-check"></i><b>7.2.4</b> Extract samples and variables scores in new ordination system</a></li>
<li class="chapter" data-level="7.2.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#screeplot"><i class="fa fa-check"></i><b>7.2.5</b> Screeplot</a></li>
<li class="chapter" data-level="7.2.6" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-pca"><i class="fa fa-check"></i><b>7.2.6</b> Plot ordination for PCA</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-metric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>7.3</b> Non-metric multidimensional scaling (nMDS)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#shepard-plot"><i class="fa fa-check"></i><b>7.3.1</b> Shepard Plot</a></li>
<li class="chapter" data-level="7.3.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-nmds"><i class="fa fa-check"></i><b>7.3.2</b> Plot ordination for nMDS</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#other-resources-1"><i class="fa fa-check"></i><b>7.4</b> Other resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Intro Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-linear-regression" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Multiple Linear Regression<a href="multiple-linear-regression.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="multiple-linear-regression.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-is-multiple-linear-regression" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> What is multiple linear regression<a href="multiple-linear-regression.html#what-is-multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A multiple linear regression model uses multiple predictor variables to predict a single response variable, as in this equation:</p>
<p><span class="math display">\[\hat{y}=\hat{\beta_0}+\hat{\beta_1}x_1+\hat{\beta_2}x_2+\hat{\beta_3}x_3...+\hat{\epsilon}\]</span></p>
<p>This model is an extension of the previously introduced single-variate linear regression model, both mathematically speaking and in the sense of building it in R.</p>
</div>
<div id="recipe-for-multiple-linear-regression-in-r" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Recipe for multiple linear regression in R<a href="multiple-linear-regression.html#recipe-for-multiple-linear-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To build and interpret a multiple linear regression model:</p>
<ul>
<li><p>First, we will start from <strong>preparing data for building model</strong>. We will select and check our variables of interest in <a href="multiple-linear-regression.html#data-preparation">Data preparation</a>. The characteristics of our data might affect the subsequent model building and evaluation process.</p></li>
<li><p><strong>Once we prepared the data, we can start to build the actual model</strong>. The standard R package <em>stats</em> provides the simplest way to do simple and multiple linear regression through the function <strong>lm()</strong>. We will introduce the detailed usage of this function for multiple linear regression in <a href="multiple-linear-regression.html#model-building">Model building</a>.</p></li>
<li><p>At the end, <strong>we examine our model and analyze the presented relationships</strong> between the predictors and the response. An entire section (<a href="multiple-linear-regression.html#model-output">Model output</a>) will be dedicated to introducing ways to interpret the model output and to evaluate the model based on all the assumptions.</p></li>
</ul>
<div id="try-it-now-26" class="section level4 unnumbered hasAnchor">
<h4>Try it now:<a href="multiple-linear-regression.html#try-it-now-26" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><em>Before starting the coding process: There are one necessary package car for this section. If you haven’t loaded this package, please load it now so it won’t cause errors in the following sections</em></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="multiple-linear-regression.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading Package</span></span>
<span id="cb55-2"><a href="multiple-linear-regression.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)</span></code></pre></div>
<p>For this and following sections, we will be using 3 predictor variables (water level, dissolved inorganic carbon amount and bottom hypoxia) and 1 response variable (total zooplankton) from the Hamilton Harbour AOC project dataset.</p>
<p>So, we need to separate our selected variables from the complete dataset:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="multiple-linear-regression.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select and combine variables of interests</span></span>
<span id="cb56-2"><a href="multiple-linear-regression.html#cb56-2" aria-hidden="true" tabindex="-1"></a>multi_data <span class="ot">&lt;-</span> ham[, <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">108</span>, <span class="dv">93</span>)]</span>
<span id="cb56-3"><a href="multiple-linear-regression.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Label each column of our new dataset</span></span>
<span id="cb56-4"><a href="multiple-linear-regression.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(multi_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;waterlevel&quot;</span>, <span class="st">&quot;DIC&quot;</span>, <span class="st">&quot;bottomhypoxia&quot;</span>, </span>
<span id="cb56-5"><a href="multiple-linear-regression.html#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;totalzoop&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="data-preparation" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Data preparation<a href="multiple-linear-regression.html#data-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we want to determine the characteristics of the three predictor variables we have, most importantly, are they continuous or categorical?</p>
<blockquote>
<p><strong>Continuous variable</strong>: data that are measured and ordered. It can be any specific value within a certain numerical range.</p>
</blockquote>
<p>For example:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="multiple-linear-regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(multi_data<span class="sc">$</span>waterlevel)</span></code></pre></div>
<pre><code>
74.34 74.36  74.4 74.42 74.49  74.5 74.54 74.55 74.56 74.59  74.6 74.63 74.64 74.65  74.7 74.71 74.74 74.75 74.78 74.79 74.81 74.84 74.85 74.86 74.87 74.88 74.89  74.9 74.91 74.92 74.94 74.95 74.96 74.98 74.99 75.02 75.03 75.04 75.05 75.06 75.08 75.09  75.1 75.11 75.12 75.13 75.14 75.16 75.17 75.18 75.19 75.21 75.22 75.23 75.24  75.3 75.33 75.35 75.43 75.53 75.69  75.7  75.8 75.81 75.91 
    4     3    15     4     6     4     8    15     4     7     8     4     3    10    27    19    21     6    16    20    28    18    31    21     1     4     6     4    12     2     2    37     8    13     8    18     4    33    23     5     1    20     2     7    12    15    21     6    23     3    14     4     6     2    16     4     8     1     2    37     2    19    16     1    15 </code></pre>
<blockquote>
<p><strong>Categorical variable</strong>: data that is divided into categories with distinct label. These data can’t be ordered or measured as continuous variables.</p>
</blockquote>
<p>For example:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="multiple-linear-regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(multi_data<span class="sc">$</span>bottomhypoxia)</span></code></pre></div>
<pre><code>
  n   y 
200 201 </code></pre>
<div id="check-data-type" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Check data type<a href="multiple-linear-regression.html#check-data-type" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Because of the intrinsic differences between continuous and categorical variables, we always want to check whether our data is in the correct data type before proceeding to the next step. Sometimes the data is not read in as the correct data type, and other times data types got altered during previous data modification procedures. We can check data type easily using the <code>class()</code> function, for example:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="multiple-linear-regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(multi_data<span class="sc">$</span>waterlevel)</span></code></pre></div>
<pre><code>[1] &quot;numeric&quot;</code></pre>
<div id="try-it-now-27" class="section level4 unnumbered hasAnchor">
<h4>Try it now:<a href="multiple-linear-regression.html#try-it-now-27" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s continue to check the other three columns of our data frame using the same code:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="multiple-linear-regression.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the class() function to check for the other columns:</span></span>
<span id="cb63-2"><a href="multiple-linear-regression.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>()</span></code></pre></div>
<p>The numeric variables are in their correct data type. If we ever want to reset them, we can set the data type to numeric using <strong>as.numeric()</strong>. For our categorical variables, we can transform them into groups/factors using <strong>as.factor()</strong>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="multiple-linear-regression.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set bottom hypoxia column as &#39;factor&#39; data type using</span></span>
<span id="cb64-2"><a href="multiple-linear-regression.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as.factor(model_name$variable_name)</span></span>
<span id="cb64-3"><a href="multiple-linear-regression.html#cb64-3" aria-hidden="true" tabindex="-1"></a>multi_data<span class="sc">$</span>bottomhypoxia <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(multi_data<span class="sc">$</span>bottomhypoxia)</span></code></pre></div>
<p><em>Note: As you noticed, the as.xxx() format is used to transform data type directly in R. You can explore some other options on your own, such as as.character(), as.integer()….</em></p>
</div>
</div>
</div>
<div id="model-building" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Model building<a href="multiple-linear-regression.html#model-building" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Generating a multiple linear regression model itself is similar to the previously introduced single variable model and is very simple once we prepared our data. Simply adding a + sign between predictor variables to include more than one variable in your model. So, instead of <code>lm(response ~ predictor, data = dataframe)</code>, we are now using <code>lm(response ~ predictor 1 + predictor 2 ..., data = dataframe)</code></p>
<div id="try-it-now-28" class="section level4 unnumbered hasAnchor">
<h4>Try it now:<a href="multiple-linear-regression.html#try-it-now-28" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s try to include the two additional predictor variables <code>DIC</code> and <code>bottomhypoxia</code> in our model based on the previous single variate model:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="multiple-linear-regression.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the below single variate linear regression model and</span></span>
<span id="cb65-2"><a href="multiple-linear-regression.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make it a multiple linear regression model: Hint: start by</span></span>
<span id="cb65-3"><a href="multiple-linear-regression.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># adding a plus sign and another predictor after water level</span></span>
<span id="cb65-4"><a href="multiple-linear-regression.html#cb65-4" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(totalzoop <span class="sc">~</span> waterlevel, <span class="at">data =</span> multi_data)</span></code></pre></div>
</div>
</div>
<div id="model-output" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Model output<a href="multiple-linear-regression.html#model-output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="model-assumptions" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Model assumptions<a href="multiple-linear-regression.html#model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just like simple linear regression, multiple linear regression comes with similar assumptions:</p>
<ol style="list-style-type: decimal">
<li><p>The predictor variables and the response variable have a <strong>linear relationship</strong> since we are doing a linear regression model.</p></li>
<li><p>The model also assumed <strong>normal distribution in residuals</strong>.</p></li>
<li><p><strong>Homoscedasticity</strong> that there exists equal variance in residuals.</p></li>
</ol>
<p>And the multiple predictors aspect brings in one more assumption:</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>No multicollinearity</strong>. The independent variables should be independent of each other.</li>
</ol>
</div>
<div id="evaluate-model-assumptions" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Evaluate model assumptions<a href="multiple-linear-regression.html#evaluate-model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I found it much easier to build the model first then check the assumptions as we can utilize these auto-generated model diagnosis plots from the <strong>lm()</strong> function. Just like in the simple linear regression model, these plots can be called by simply run <code>plot(model_name)</code>. Let’s try to do this:</p>
<div id="try-it-now-29" class="section level4 unnumbered hasAnchor">
<h4>Try it now:<a href="multiple-linear-regression.html#try-it-now-29" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="multiple-linear-regression.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the diagnosis plots that are auto-generated from the</span></span>
<span id="cb66-2"><a href="multiple-linear-regression.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lm() function Using plot(model_name):</span></span>
<span id="cb66-3"><a href="multiple-linear-regression.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>()</span></code></pre></div>
<p>You should see four diagnosis plots generated: <em>Residuals vs Fitted plot</em>, <em>Normal Q-Q plot</em>, <em>Scale-Location plot</em>, and <em>The Residuals vs Leverage plot</em>. These plots can help us evaluate whether the first three of the four assumptions are met for our model.</p>
<p>The last assumption, <strong>Multicollinearity</strong>, can be checked by the following several ways depending on the data characteristics:</p>
<ul>
<li><p>If we only have continuous variables in our dataset, we can check this using correlation matrix through <strong>cor()</strong> or/and <strong>corrplot()</strong>, or variance inflation factor using <strong>vif()</strong> from the <em>car</em> package, or <strong>vifcor()</strong> and <strong>vifstep()</strong> from the <em>usdm</em> package.</p></li>
<li><p>If we have both continuous and categorical variables in our dataset, the <strong>vif()</strong> function will automatically detect our categorical variables and compute us the generalized vifs.</p></li>
</ul>
</div>
<div id="try-it-now-30" class="section level4 unnumbered hasAnchor">
<h4>Try it now:<a href="multiple-linear-regression.html#try-it-now-30" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="multiple-linear-regression.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s use vif(model_name) to calculate vif for our</span></span>
<span id="cb67-2"><a href="multiple-linear-regression.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># variables</span></span>
<span id="cb67-3"><a href="multiple-linear-regression.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>()</span></code></pre></div>
<p>The result for our variables should look like this:</p>
<pre><code>   waterlevel           DIC bottomhypoxia 
         1.58          1.78          1.17 </code></pre>
<p>Our variables look good. If multicollinearity is found (vif &gt; 5 is a common threshold to use for indicating a problematic amount of multicollinearity), we can try to remove it by identify and remove the predictor variable that is causing troubles.</p>
</div>
</div>
<div id="output-interpretation" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Output interpretation<a href="multiple-linear-regression.html#output-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To access model output, the easiest way is to call the <strong>summary()</strong> method just like the simple linear regression model:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="multiple-linear-regression.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_model)</span></code></pre></div>
<pre><code>
Call:
lm(formula = totalzoop ~ waterlevel + DIC + bottomhypoxia, data = multi_data)

Residuals:
   Min     1Q Median     3Q    Max 
-479.5 -169.1  -65.3   80.0 2158.8 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -1.05e+03   6.69e+03   -0.16  8.8e-01    
waterlevel      9.48e+00   9.10e+01    0.10  9.2e-01    
DIC             2.78e+01   7.88e+00    3.52  5.2e-04 ***
bottomhypoxiay -4.89e+01   4.10e+01   -1.19  2.3e-01    
---
Signif. codes:  0 &#39;***&#39; 1e-03 &#39;**&#39; 1e-02 &#39;*&#39; 5e-02 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 279 on 213 degrees of freedom
  (525 observations deleted due to missingness)
Multiple R-squared:  0.119, Adjusted R-squared:  0.107 
F-statistic: 9.59 on 3 and 213 DF,  p-value: 5.72e-06</code></pre>
<p>The interpretation of the model result is the same as in the simple linear regression model.</p>
<p>For categorical variables, the significance level is calculated against a chosen <em>baseline</em> category. In this case, the <em>n</em> category in bottom hypoxia variable is the baseline category.</p>
<p>Unlike the single variate model, you can compare the coefficients and significance of multiple predictors and decide on whether you want to exclude some of the variables in your final model. In this case, DIC seems to be the most significant variable and we might be able to get a similarly accurate model from this single predictor.</p>
</div>
</div>
<div id="what-could-go-wrong" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> What could go wrong?<a href="multiple-linear-regression.html#what-could-go-wrong" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Check carefully whether the values in your data set are in their correct data types, especially for the categorical variables if you have any.</p></li>
<li><p>Be careful with the <em>comma ,</em> and <em>tilde ~</em> symbols when you are dealing with functions in R. They represent opposite positions of the independent and dependent variables.</p></li>
<li><p>Always check the model assumptions to see if linear regression model is indeed the appropriate model to use.</p></li>
</ul>
</div>
<div id="references-and-resources-1" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> References and Resources<a href="multiple-linear-regression.html#references-and-resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Other resources on introductions to multivariate linear regression model in R:<br />
<a href="https://www.datacamp.com/tutorial/multiple-linear-regression-r-tutorial" class="uri">https://www.datacamp.com/tutorial/multiple-linear-regression-r-tutorial</a><br />
<a href="https://bookdown.org/jimr1603/Intermediate_R_-_R_for_Survey_Analysis/regression-model.html#multiple-linear-regression" class="uri">https://bookdown.org/jimr1603/Intermediate_R_-_R_for_Survey_Analysis/regression-model.html#multiple-linear-regression</a><br />
<a href="https://library.virginia.edu/data/articles/getting-started-with-multivariate-multiple-regression" class="uri">https://library.virginia.edu/data/articles/getting-started-with-multivariate-multiple-regression</a><br />
<a href="https://rpubs.com/bensonsyd/385183" class="uri">https://rpubs.com/bensonsyd/385183</a></p>
<p>If you want to learn more about plotting prettier plots for presentation purposes, check the <em>ggplot2</em> package:</p>
<p><a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a></p>
<p>If you want to learn more about the <em>dummy coding</em> process in lm() function that treat categorical variables, check the <code>contrasts()</code> function.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
