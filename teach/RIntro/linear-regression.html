<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Linear regression | R Intro Workshop</title>
  <meta name="description" content="Building Skills in Quantitative Biology" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Linear regression | R Intro Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Building Skills in Quantitative Biology" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Linear regression | R Intro Workshop" />
  
  <meta name="twitter:description" content="Building Skills in Quantitative Biology" />
  

<meta name="author" content="The Cuddington Lab" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-r.html"/>
<link rel="next" href="multiple-linear-regression-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to our Workshop!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Get ready for the workshop</a>
<ul>
<li class="chapter" data-level="2.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#r-from-zero-warmup"><i class="fa fa-check"></i><b>2.1</b> R from zero warmup</a></li>
<li class="chapter" data-level="2.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#download-needed-files-and-packages"><i class="fa fa-check"></i><b>2.3</b> Download needed files and packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#package-to-read-.xlsx-file"><i class="fa fa-check"></i><b>2.3.1</b> Package to read .xlsx file</a></li>
<li class="chapter" data-level="2.3.2" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#other-needed-packages"><i class="fa fa-check"></i><b>2.3.2</b> Other needed packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="get-ready-for-the-workshop.html"><a href="get-ready-for-the-workshop.html#load-a-package-into-memory"><i class="fa fa-check"></i><b>2.3.3</b> Load a package into memory</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>3</b> Basic R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-r.html"><a href="basic-r.html#data-import"><i class="fa fa-check"></i><b>3.1</b> Data import</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r.html"><a href="basic-r.html#wheres-my-file"><i class="fa fa-check"></i><b>3.1.1</b> Where’s my file??</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r.html"><a href="basic-r.html#did-the-import-work"><i class="fa fa-check"></i><b>3.1.2</b> Did the import work??</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r.html"><a href="basic-r.html#data-in-r"><i class="fa fa-check"></i><b>3.2</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r.html"><a href="basic-r.html#data-types"><i class="fa fa-check"></i><b>3.2.1</b> Data types</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-r.html"><a href="basic-r.html#data-structures"><i class="fa fa-check"></i><b>3.2.2</b> Data structures</a></li>
<li class="chapter" data-level="3.2.3" data-path="basic-r.html"><a href="basic-r.html#selecting-portions-of-a-dataframe"><i class="fa fa-check"></i><b>3.2.3</b> Selecting portions of a dataframe</a></li>
<li class="chapter" data-level="3.2.4" data-path="basic-r.html"><a href="basic-r.html#using-conditional-statements-to-access-data"><i class="fa fa-check"></i><b>3.2.4</b> Using conditional statements to access data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r.html"><a href="basic-r.html#functions-in-r"><i class="fa fa-check"></i><b>3.3</b> Functions in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-r.html"><a href="basic-r.html#summarizing-data"><i class="fa fa-check"></i><b>3.3.1</b> Summarizing data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-r.html"><a href="basic-r.html#plotting-data"><i class="fa fa-check"></i><b>3.4</b> Plotting data</a></li>
<li class="chapter" data-level="3.5" data-path="basic-r.html"><a href="basic-r.html#the-editorsource-window"><i class="fa fa-check"></i><b>3.5</b> The Editor(Source) window</a></li>
<li class="chapter" data-level="3.6" data-path="basic-r.html"><a href="basic-r.html#t-test-and-boxplot"><i class="fa fa-check"></i><b>3.6</b> T-test and boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction"><i class="fa fa-check"></i><b>4.0.1</b> Introduction</a></li>
<li class="chapter" data-level="4.0.2" data-path="linear-regression.html"><a href="linear-regression.html#linear-regression-using-water-level-and-total-zooplankton"><i class="fa fa-check"></i><b>4.0.2</b> Linear regression using water level and total zooplankton</a></li>
<li class="chapter" data-level="4.0.3" data-path="linear-regression.html"><a href="linear-regression.html#what-does-the-summary-output-tell-us-about-the-relationship-between-water-level-and-total-zooplankton"><i class="fa fa-check"></i><b>4.0.3</b> What does the summary output tell us about the relationship between water level and total zooplankton?</a></li>
<li class="chapter" data-level="4.0.4" data-path="linear-regression.html"><a href="linear-regression.html#what-are-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.0.4</b> What are the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.0.5" data-path="linear-regression.html"><a href="linear-regression.html#how-do-you-evaluate-the-assumptions-of-a-linear-regression"><i class="fa fa-check"></i><b>4.0.5</b> How do you evaluate the assumptions of a linear regression?</a></li>
<li class="chapter" data-level="4.0.6" data-path="linear-regression.html"><a href="linear-regression.html#in-the-case-of-this-linear-regression-between-water-level-and-total-zooplankton-what-do-the-diagnostic-plots-tell-us"><i class="fa fa-check"></i><b>4.0.6</b> In the case of this linear regression between water level and total zooplankton, what do the diagnostic plots tell us?</a></li>
<li class="chapter" data-level="4.0.7" data-path="linear-regression.html"><a href="linear-regression.html#how-can-we-plot-this-linear-regression"><i class="fa fa-check"></i><b>4.0.7</b> How can we plot this linear regression?</a></li>
<li class="chapter" data-level="4.0.8" data-path="linear-regression.html"><a href="linear-regression.html#common-mistakes"><i class="fa fa-check"></i><b>4.0.8</b> Common mistakes</a></li>
<li class="chapter" data-level="4.0.9" data-path="linear-regression.html"><a href="linear-regression.html#references-and-resources"><i class="fa fa-check"></i><b>4.0.9</b> References and resources</a></li>
<li class="chapter" data-level="4.0.10" data-path="linear-regression.html"><a href="linear-regression.html#alternative-resource"><i class="fa fa-check"></i><b>4.0.10</b> Alternative resource:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html"><i class="fa fa-check"></i><b>5</b> Multiple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#what-is-multiple-linear-regression-model"><i class="fa fa-check"></i><b>5.1.1</b> What is multiple linear regression model</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#recipe-for-multiple-linear-regression-model-in-r"><i class="fa fa-check"></i><b>5.1.2</b> Recipe for multiple linear regression model in R</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#data-preparation"><i class="fa fa-check"></i><b>5.2</b> Data preparation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#check-data-type"><i class="fa fa-check"></i><b>5.2.1</b> Check data type</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-building"><i class="fa fa-check"></i><b>5.3</b> Model building</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-output"><i class="fa fa-check"></i><b>5.4</b> Model output</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-assumptions"><i class="fa fa-check"></i><b>5.4.1</b> Model assumptions</a></li>
<li class="chapter" data-level="5.4.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#evaluate-model-assumptions"><i class="fa fa-check"></i><b>5.4.2</b> Evaluate model assumptions</a></li>
<li class="chapter" data-level="5.4.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#output-interpretation"><i class="fa fa-check"></i><b>5.4.3</b> Output interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#what-could-go-wrong"><i class="fa fa-check"></i><b>5.5</b> What could go wrong?</a></li>
<li class="chapter" data-level="5.6" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#references-and-resources-1"><i class="fa fa-check"></i><b>5.6</b> References and Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-is-a-logistic-regression"><i class="fa fa-check"></i><b>6.1</b> What is a logistic regression?</a></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#how-are-logistic-regressions-different-from-linear-regressions"><i class="fa fa-check"></i><b>6.2</b> How are logistic regressions different from linear regressions?</a></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#how-does-this-type-of-data-look-like"><i class="fa fa-check"></i><b>6.3</b> How does this type of data look like?</a></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#what-does-the-logistic-curve-mean"><i class="fa fa-check"></i><b>6.4</b> What does the logistic curve mean?</a></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#aquatic-ecology-studies-using-logistic-regressions"><i class="fa fa-check"></i><b>6.5</b> Aquatic ecology studies using logistic regressions</a></li>
<li class="chapter" data-level="6.6" data-path="logistic-regression.html"><a href="logistic-regression.html#what-kind-of-predictors-can-we-have-in-a-logistic-regression"><i class="fa fa-check"></i><b>6.6</b> What kind of predictors can we have in a logistic regression?</a></li>
<li class="chapter" data-level="6.7" data-path="logistic-regression.html"><a href="logistic-regression.html#mathematical-representation"><i class="fa fa-check"></i><b>6.7</b> Mathematical representation</a></li>
<li class="chapter" data-level="6.8" data-path="logistic-regression.html"><a href="logistic-regression.html#key-binomial-logistic-model-assumptions"><i class="fa fa-check"></i><b>6.8</b> Key binomial logistic model assumptions</a></li>
<li class="chapter" data-level="6.9" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9</b> Creating a logistic model in R</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#steps-to-run-a-logistic-model-in-r"><i class="fa fa-check"></i><b>6.9.1</b> Steps to run a logistic model in R</a></li>
<li class="chapter" data-level="6.9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#lets-create-this-first-model-together"><i class="fa fa-check"></i><b>6.9.2</b> Let’s create this first model together</a></li>
<li class="chapter" data-level="6.9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#creating-your-logistic-model"><i class="fa fa-check"></i><b>6.9.3</b> Creating your logistic model</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="logistic-regression.html"><a href="logistic-regression.html#additional-resources"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#what-could-go-wrong-1"><i class="fa fa-check"></i><b>6.10.1</b> What could go wrong?</a></li>
<li class="chapter" data-level="6.10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#r-resources"><i class="fa fa-check"></i><b>6.10.2</b> R resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="libraries-and-imports.html"><a href="libraries-and-imports.html"><i class="fa fa-check"></i><b>7</b> Libraries and imports</a></li>
<li class="chapter" data-level="8" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>8</b> Multivariate analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#introduction-to-multivariate-analysis"><i class="fa fa-check"></i><b>8.1</b> Introduction to multivariate analysis</a></li>
<li class="chapter" data-level="8.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>8.2</b> Principle Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#correlation-examination"><i class="fa fa-check"></i><b>8.2.1</b> Correlation examination</a></li>
<li class="chapter" data-level="8.2.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-standardized-data"><i class="fa fa-check"></i><b>8.2.2</b> PCA with standardized data</a></li>
<li class="chapter" data-level="8.2.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#screeplot"><i class="fa fa-check"></i><b>8.2.3</b> Screeplot</a></li>
<li class="chapter" data-level="8.2.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-pca"><i class="fa fa-check"></i><b>8.2.4</b> Plot ordination for PCA</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-metric-multidimensional-scaling-nmds"><i class="fa fa-check"></i><b>8.3</b> Non-metric multidimensional scaling (nMDS)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#shepard-plot"><i class="fa fa-check"></i><b>8.3.1</b> Shepard Plot</a></li>
<li class="chapter" data-level="8.3.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#plot-ordination-for-nmds"><i class="fa fa-check"></i><b>8.3.2</b> Plot ordination for nMDS</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#other-resources"><i class="fa fa-check"></i><b>8.4</b> Other resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Intro Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Linear regression<a href="linear-regression.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level3 hasAnchor" number="4.0.1">
<h3><span class="header-section-number">4.0.1</span> Introduction<a href="linear-regression.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A linear model is used when you want to test a prediction of correlation between an independent (or predictor) variable and a dependent (or response) variable (Phillips, 2018). For example, for our Hamilton Harbour data, we will be testing for a correlation between water level (our independent variable) and total zooplankton (our dependent variable) counted in the net grab.</p>
</div>
<div id="linear-regression-using-water-level-and-total-zooplankton" class="section level3 hasAnchor" number="4.0.2">
<h3><span class="header-section-number">4.0.2</span> Linear regression using water level and total zooplankton<a href="linear-regression.html#linear-regression-using-water-level-and-total-zooplankton" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, you can run a linear regression by using the lm() function. Your variables are entered in using the following formula..</p>
<p>nameoflinearreg&lt;-lm(dependent variable~independent variable, yourdata)</p>
<div id="try-it-now-20" class="section level4 hasAnchor" number="4.0.2.1">
<h4><span class="header-section-number">4.0.2.1</span> Try it now<a href="linear-regression.html#try-it-now-20" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code># A tibble: 0 × 109
# … with 109 variables: waterbody &lt;chr&gt;, area_group &lt;chr&gt;, Latitude &lt;dbl&gt;,
#   Longtitude &lt;dbl&gt;, Station_Acronym &lt;chr&gt;, report_Stn &lt;chr&gt;,
#   SamplingDate &lt;dttm&gt;, season &lt;dbl&gt;, year &lt;dbl&gt;, Julian_Day &lt;dbl&gt;,
#   Julian_Week &lt;dbl&gt;, Month &lt;dbl&gt;, Station_depth &lt;dbl&gt;, water level &lt;dbl&gt;,
#   Ammonia_ECCC1m &lt;dbl&gt;, DIC_ECCC1m &lt;dbl&gt;, DOC_ECCC1m &lt;dbl&gt;, POC_ECCC1m &lt;dbl&gt;,
#   Chl_ECCC1m &lt;dbl&gt;, Chl Cor_ECCC1m &lt;dbl&gt;, NO2_NO3_ECCC1m &lt;dbl&gt;,
#   PON_ECCC1m &lt;dbl&gt;, TKN dissolved_ECCC1m &lt;dbl&gt;, SRP_ECCC1m &lt;dbl&gt;, …</code></pre>
<pre><code>
Call:
lm(formula = (log(total.zoop)) ~ (waterlevel), data = ham)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2956 -0.5544  0.0734  0.6626  2.7438 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -73.9205    10.0626  -7.346 7.63e-13 ***
waterlevel    1.0570     0.1342   7.873 1.92e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9822 on 537 degrees of freedom
  (203 observations deleted due to missingness)
Multiple R-squared:  0.1035,    Adjusted R-squared:  0.1018 
F-statistic: 61.99 on 1 and 537 DF,  p-value: 1.92e-14</code></pre>
</div>
</div>
<div id="what-does-the-summary-output-tell-us-about-the-relationship-between-water-level-and-total-zooplankton" class="section level3 hasAnchor" number="4.0.3">
<h3><span class="header-section-number">4.0.3</span> What does the summary output tell us about the relationship between water level and total zooplankton?<a href="linear-regression.html#what-does-the-summary-output-tell-us-about-the-relationship-between-water-level-and-total-zooplankton" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Talk amongst yourselves…</p>
</div>
<div id="what-are-the-assumptions-of-a-linear-regression" class="section level3 hasAnchor" number="4.0.4">
<h3><span class="header-section-number">4.0.4</span> What are the assumptions of a linear regression?<a href="linear-regression.html#what-are-the-assumptions-of-a-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>There is a linear relationship between the independent and dependent variable (Statistics solutions, 2024).</li>
<li>The residuals are normally distributed (Statistics solutions, 2024).</li>
<li>The variance of the residuals should be consistent across all the values of the independent variable (Statistics solutions, 2024).</li>
<li>Each observation is independent of one another (there is no significant correlation between the independent variable values) (Statistics solutions, 2024).</li>
</ul>
</div>
<div id="how-do-you-evaluate-the-assumptions-of-a-linear-regression" class="section level3 hasAnchor" number="4.0.5">
<h3><span class="header-section-number">4.0.5</span> How do you evaluate the assumptions of a linear regression?<a href="linear-regression.html#how-do-you-evaluate-the-assumptions-of-a-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can evaluate the assumptions of a linear regression by creating diagnostic plots. These look at the residuals of the linear regression, that were shown using the summary() function above, to determine if the linear model is appropriate for the data (the data does not violate any assumptions) (Statistics solutions, 2024). This will create 4 diagnostic plots: residuals versus leverage, scale-location, Q-Q residuals and residuals versus fitted values.</p>
<div id="try-it-now-21" class="section level4 hasAnchor" number="4.0.5.1">
<h4><span class="header-section-number">4.0.5.1</span> Try it now<a href="linear-regression.html#try-it-now-21" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="linear-regression.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># divide the window into a 2 by 2 grid</span></span>
<span id="cb43-2"><a href="linear-regression.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb43-3"><a href="linear-regression.html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="linear-regression.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting diagnostic plots with log transformed data</span></span>
<span id="cb43-5"><a href="linear-regression.html#cb43-5" aria-hidden="true" tabindex="-1"></a>lab <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb43-6"><a href="linear-regression.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb43-7"><a href="linear-regression.html#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(logwaterlzoo.lm, <span class="at">which =</span> i)</span>
<span id="cb43-8"><a href="linear-regression.html#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="at">text =</span> lab[i], <span class="at">side =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb43-9"><a href="linear-regression.html#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672"  /></p>
</div>
<div id="a." class="section level4 hasAnchor" number="4.0.5.2">
<h4><span class="header-section-number">4.0.5.2</span> a.<a href="linear-regression.html#a." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <em>residuals versus fitted plot</em> determines if the residuals exhibit non-linear behaviour (Statistics solutions, 2024). If the red line roughly follows the horizontal line on the plot, the residuals are showing linear behaviour (Statistics solutions, 2024).</p>
</div>
<div id="b." class="section level4 hasAnchor" number="4.0.5.3">
<h4><span class="header-section-number">4.0.5.3</span> b.<a href="linear-regression.html#b." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <em>Q-Q plot</em> evaluates our second assumption; the residuals are normally distributed (Statistics solutions, 2024). If the points on the plot follow the diagonal line, then the residuals are normally distributed (Statistics solutions, 2024).</p>
</div>
<div id="c." class="section level4 hasAnchor" number="4.0.5.4">
<h4><span class="header-section-number">4.0.5.4</span> c.<a href="linear-regression.html#c." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <em>Scale-Location</em> plot is used to determine our third assumption; the variance of the residuals should be consistent across all the values The the independent variable (Statistics solutions, 2024). This is also called homoscedasticity (Bobbitt, 2021).</p>
</div>
<div id="d." class="section level4 hasAnchor" number="4.0.5.5">
<h4><span class="header-section-number">4.0.5.5</span> d.<a href="linear-regression.html#d." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <em>Residuals versus Leverage</em> plot displays any influential points in the dataset compared to Cook’s distance (Bobbitt, 2021). Ideally, the points should fall close to the ‘0’ line on the plot with little variation. Any points that fall past the line indicating Cook’s distance are considered strongly influential points (Bobbitt, 2021).</p>
</div>
</div>
<div id="in-the-case-of-this-linear-regression-between-water-level-and-total-zooplankton-what-do-the-diagnostic-plots-tell-us" class="section level3 hasAnchor" number="4.0.6">
<h3><span class="header-section-number">4.0.6</span> In the case of this linear regression between water level and total zooplankton, what do the diagnostic plots tell us?<a href="linear-regression.html#in-the-case-of-this-linear-regression-between-water-level-and-total-zooplankton-what-do-the-diagnostic-plots-tell-us" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Talk amongst yourselves…</p>
</div>
<div id="how-can-we-plot-this-linear-regression" class="section level3 hasAnchor" number="4.0.7">
<h3><span class="header-section-number">4.0.7</span> How can we plot this linear regression?<a href="linear-regression.html#how-can-we-plot-this-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can plot the data using the plot() function, superimpose the regression line using the abline() function, calculate confidence intervals using the predict() function and add them to the plot using the lines() function.</p>
<div id="try-it-now-22" class="section level4 hasAnchor" number="4.0.7.1">
<h4><span class="header-section-number">4.0.7.1</span> Try it now<a href="linear-regression.html#try-it-now-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="linear-regression.html#cb44-1" aria-hidden="true" tabindex="-1"></a>hogwaterl <span class="ot">&lt;-</span> (ham<span class="sc">$</span>waterlevel)</span>
<span id="cb44-2"><a href="linear-regression.html#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="linear-regression.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># taking the natural log of the response variable</span></span>
<span id="cb44-4"><a href="linear-regression.html#cb44-4" aria-hidden="true" tabindex="-1"></a>logtotal.zoop <span class="ot">&lt;-</span> <span class="fu">log</span>(ham<span class="sc">$</span>total.zoop)</span>
<span id="cb44-5"><a href="linear-regression.html#cb44-5" aria-hidden="true" tabindex="-1"></a>logwaterlzoo.lm <span class="ot">=</span> <span class="fu">lm</span>(logtotal.zoop <span class="sc">~</span> hogwaterl)</span>
<span id="cb44-6"><a href="linear-regression.html#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="linear-regression.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a vector &#39;x&#39; to predict total.zoop from waterlevel</span></span>
<span id="cb44-8"><a href="linear-regression.html#cb44-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(hogwaterl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(hogwaterl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb44-9"><a href="linear-regression.html#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb44-10"><a href="linear-regression.html#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="linear-regression.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate confidence intervals (confidence level 95%) for</span></span>
<span id="cb44-12"><a href="linear-regression.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted total.zoop values</span></span>
<span id="cb44-13"><a href="linear-regression.html#cb44-13" aria-hidden="true" tabindex="-1"></a>confidenceint <span class="ot">&lt;-</span> <span class="fu">predict</span>(logwaterlzoo.lm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">hogwaterl =</span> x), </span>
<span id="cb44-14"><a href="linear-regression.html#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb44-15"><a href="linear-regression.html#cb44-15" aria-hidden="true" tabindex="-1"></a>cf <span class="ot">=</span> <span class="fu">as.data.frame</span>(confidenceint)</span>
<span id="cb44-16"><a href="linear-regression.html#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="linear-regression.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot with water level and total zooplankton use</span></span>
<span id="cb44-18"><a href="linear-regression.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co"># xlab(), ylab() and main() to put titles on the plot</span></span>
<span id="cb44-19"><a href="linear-regression.html#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> ham<span class="sc">$</span>waterlevel, <span class="at">y =</span> logtotal.zoop, <span class="at">xlab =</span> <span class="st">&quot;Water level (m)&quot;</span>, </span>
<span id="cb44-20"><a href="linear-regression.html#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;(log) Total zooplankton&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Relationship between water level and total zooplankton&quot;</span>)</span>
<span id="cb44-21"><a href="linear-regression.html#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="linear-regression.html#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add regression line to the plot using the abline() function</span></span>
<span id="cb44-23"><a href="linear-regression.html#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(logwaterlzoo.lm, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb44-24"><a href="linear-regression.html#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="linear-regression.html#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="co"># lower bound confidence interval</span></span>
<span id="cb44-26"><a href="linear-regression.html#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> x, cf<span class="sc">$</span>lwr, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb44-27"><a href="linear-regression.html#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="linear-regression.html#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co"># upper bound confidence interval</span></span>
<span id="cb44-29"><a href="linear-regression.html#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> x, cf<span class="sc">$</span>upr, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672"  /></p>
<p>In this case, water level appears to have a positive correlation with total zooplankton. As the water level increases, the number of total zooplankton also increases.</p>
</div>
</div>
<div id="common-mistakes" class="section level3 hasAnchor" number="4.0.8">
<h3><span class="header-section-number">4.0.8</span> Common mistakes<a href="linear-regression.html#common-mistakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Be careful when coding a linear regression using the lm() function that the independent and dependent variables are coded in the right order. i.e. lm(dependent variable~independent variable, data = yourdata).</li>
</ul>
</div>
<div id="references-and-resources" class="section level3 hasAnchor" number="4.0.9">
<h3><span class="header-section-number">4.0.9</span> References and resources<a href="linear-regression.html#references-and-resources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Assumptions of multiple linear regression analysis. Statistics Solutions. (2024, April 17). <a href="https://www.statisticssolutions.com/free-resources/directory-of-statistical-analyses/assumptions-of-linear-regression/" class="uri">https://www.statisticssolutions.com/free-resources/directory-of-statistical-analyses/assumptions-of-linear-regression/</a></p>
<p>Bobbitt, Z. (2021, July 23). How to interpret diagnostic plots in R. Statology. <a href="https://www.statology.org/diagnostic-plots-in-r/" class="uri">https://www.statology.org/diagnostic-plots-in-r/</a></p>
<p>Phillips, N. D. (2018, January 22). Yarrr! The Pirate’s Guide to R. YaRrr! The Pirate’s Guide to R. <a href="https://bookdown.org/ndphillips/YaRrr/" class="uri">https://bookdown.org/ndphillips/YaRrr/</a>
* Check out chapter 15 on linear regression analysis</p>
</div>
<div id="alternative-resource" class="section level3 hasAnchor" number="4.0.10">
<h3><span class="header-section-number">4.0.10</span> Alternative resource:<a href="linear-regression.html#alternative-resource" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another way to evaluate the assumptions of a linear regression is to compare fitted values (theoretical values of the dependent variable that are predicted by the model, assuming linearity) and the observed values of the dependent variable in a plot (Phillips, 2018). If the model fitted values forms a diagonal line with the observed values of the dependent variable, then the linear model fits the data well, and the assumptions of the linear model are met (Phillips, 2018). See Phillips resource for more details and sample coding.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-linear-regression-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
