<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <link href="https://fonts.googleapis.com/css?family=Domine|Montserrat" rel="stylesheet"> 
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->
    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
    <!-- <script src="script.js"></script> -->
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/ryangrose/easy-pandoc-templates@948e28e5/css/elegant_bootstrap.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <meta name="author" content="Debora" />
  <meta name="date" content="2023-04-04" />
  <title>Numerical Implementation</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">body { font-family: Domine, Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif} h1, h2, h3, h4, h5, h6 { font-family: Montserrat, sans }</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>

    
    <div class="navbar navbar-static-top navbar-expand-sm px-0 pt-0">
    <div class="navbar-inner container-fluid">
      <div class="container">
        <span class="doc-title">Numerical Implementation</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Debora</p></li>
                              <li><p class="navbar-text">2023-04-04</p></li>
                  </ul>
      </div>
    </div>
  </div>
  <div class="container">
      <div class="row">
            <div id="TOC" class="col-sm-7 col-lg-3">
        <div class="well toc">

        <ul>
        <li><a href="#learning-outcomes"
        id="toc-learning-outcomes">Learning outcomes</a></li>
        <li><a href="#unstructured-population-models"
        id="toc-unstructured-population-models">Unstructured Population
        Models</a>
        <ul>
        <li><a href="#introduction"
        id="toc-introduction">Introduction</a>
        <ul>
        <li><a href="#what-is-a-population-model"
        id="toc-what-is-a-population-model">What is a population
        model?</a></li>
        <li><a href="#basic-types-of-population-models"
        id="toc-basic-types-of-population-models">Basic types of
        population models</a></li>
        </ul></li>
        <li><a href="#simple-models-of-population-dynamics"
        id="toc-simple-models-of-population-dynamics">Simple models of
        population dynamics</a>
        <ul>
        <li><a href="#historical-facts"
        id="toc-historical-facts">Historical facts</a></li>
        <li><a
        href="#when-are-simple-population-models-used-in-biological-analyses"
        id="toc-when-are-simple-population-models-used-in-biological-analyses">When
        are simple population models used in biological
        analyses?</a></li>
        <li><a
        href="#mathematical-representation-of-population-growth-patterns"
        id="toc-mathematical-representation-of-population-growth-patterns">Mathematical
        representation of population growth patterns</a></li>
        <li><a href="#geometric-growth"
        id="toc-geometric-growth">Geometric growth</a></li>
        <li><a href="#exponential-growth"
        id="toc-exponential-growth">Exponential growth</a></li>
        <li><a href="#further-reading" id="toc-further-reading">Further
        Reading</a></li>
        <li><a href="#r-resources" id="toc-r-resources">R
        Resources</a></li>
        <li><a href="#references"
        id="toc-references">References</a></li>
        </ul></li>
        <li><a href="#density-dependence"
        id="toc-density-dependence">Density dependence</a>
        <ul>
        <li><a href="#logistic-growth-model"
        id="toc-logistic-growth-model">Logistic growth model</a></li>
        <li><a href="#negative-density-dependence"
        id="toc-negative-density-dependence">Negative density
        dependence</a></li>
        <li><a href="#discrete-time-logistic-growth"
        id="toc-discrete-time-logistic-growth">Discrete time logistic
        growth</a></li>
        <li><a
        href="#other-types-of-density-dependent-population-models"
        id="toc-other-types-of-density-dependent-population-models">Other
        types of density dependent population models</a></li>
        <li><a href="#illustration-of-current-application-1"
        id="toc-illustration-of-current-application-1">Illustration of
        current application</a></li>
        <li><a href="#references-1"
        id="toc-references-1">References:</a></li>
        </ul></li>
        <li><a href="#population-dynamics-and-stochasticity"
        id="toc-population-dynamics-and-stochasticity">Population
        dynamics and stochasticity</a>
        <ul>
        <li><a href="#why-are-changes-in-population-variable"
        id="toc-why-are-changes-in-population-variable">Why are changes
        in population variable?</a></li>
        <li><a href="#basic-forms-of-stochasticity"
        id="toc-basic-forms-of-stochasticity">Basic forms of
        stochasticity</a></li>
        <li><a href="#implications-of-variation-in-population-growth"
        id="toc-implications-of-variation-in-population-growth">Implications
        of variation in population growth</a></li>
        <li><a
        href="#estimating-population-growth-rates-in-the-presence-of-processobservation-error"
        id="toc-estimating-population-growth-rates-in-the-presence-of-processobservation-error">Estimating
        population growth rates in the presence of process/observation
        error</a></li>
        <li><a href="#references-2"
        id="toc-references-2">References</a></li>
        </ul></li>
        <li><a
        href="#model-selection-how-do-we-tell-which-model-to-use-for-our-data"
        id="toc-model-selection-how-do-we-tell-which-model-to-use-for-our-data">Model
        Selection: How do we tell which model to use for our data?</a>
        <ul>
        <li><a href="#likelihood"
        id="toc-likelihood">Likelihood</a></li>
        <li><a href="#model-comparison" id="toc-model-comparison">Model
        comparison</a></li>
        <li><a href="#references-3"
        id="toc-references-3">References</a></li>
        </ul></li>
        </ul></li>
        <li><a href="#structured-population-models"
        id="toc-structured-population-models">Structured population
        models</a>
        <ul>
        <li><a href="#introduction-to-population-structure"
        id="toc-introduction-to-population-structure">Introduction to
        population structure</a>
        <ul>
        <li><a href="#different-population-structures"
        id="toc-different-population-structures">Different population
        structures</a></li>
        <li><a href="#life-tables" id="toc-life-tables">Life
        tables</a></li>
        <li><a href="#life-history-stage-diagram"
        id="toc-life-history-stage-diagram">Life history stage
        diagram</a></li>
        <li><a href="#use-matrix-to-represent-population-dynamics"
        id="toc-use-matrix-to-represent-population-dynamics">Use matrix
        to represent population dynamics</a></li>
        </ul></li>
        <li><a href="#projecting-a-population-matrix-through-time"
        id="toc-projecting-a-population-matrix-through-time">Projecting
        a population matrix through time</a>
        <ul>
        <li><a href="#how-to-project-a-matrix"
        id="toc-how-to-project-a-matrix">How to project a
        matrix</a></li>
        <li><a href="#stable-agestage-distribution"
        id="toc-stable-agestage-distribution">Stable age/stage
        distribution</a></li>
        <li><a href="#eigenanalysis"
        id="toc-eigenanalysis">Eigenanalysis</a></li>
        </ul></li>
        <li><a href="#illustratin-of-current-application"
        id="toc-illustratin-of-current-application">Illustratin of
        current application</a></li>
        <li><a
        href="#sensitivities-elasticities-and-management-applications"
        id="toc-sensitivities-elasticities-and-management-applications">Sensitivities,
        elasticities, and management applications</a>
        <ul>
        <li><a
        href="#why-are-sensivities-and-elasticities-important-to-population-ecology-studies"
        id="toc-why-are-sensivities-and-elasticities-important-to-population-ecology-studies">Why
        are sensivities and elasticities important to population ecology
        studies?</a></li>
        <li><a href="#sensitivity"
        id="toc-sensitivity">Sensitivity</a></li>
        <li><a href="#from-sensitivity-to-elasticity"
        id="toc-from-sensitivity-to-elasticity">From sensitivity to
        elasticity</a></li>
        <li><a href="#component-sensitivity-and-elasticity"
        id="toc-component-sensitivity-and-elasticity">Component
        sensitivity and elasticity</a></li>
        <li><a
        href="#advantages-of-elasticities-as-compared-to-sensitivites"
        id="toc-advantages-of-elasticities-as-compared-to-sensitivites">Advantages
        of elasticities as compared to sensitivites</a></li>
        <li><a
        href="#limitations-of-sensitivity-and-elasticity-analyses"
        id="toc-limitations-of-sensitivity-and-elasticity-analyses">Limitations
        of sensitivity and elasticity analyses</a></li>
        <li><a
        href="#analytical-sensitivity-and-elasticity-variance-in-vital-rates"
        id="toc-analytical-sensitivity-and-elasticity-variance-in-vital-rates">Analytical
        sensitivity and elasticity &amp; variance in vital
        rates</a></li>
        <li><a href="#sensitivity-analysis-methods"
        id="toc-sensitivity-analysis-methods">Sensitivity analysis
        methods</a></li>
        <li><a
        href="#practicing-the-calculation-of-sensitivities-and-elasticities"
        id="toc-practicing-the-calculation-of-sensitivities-and-elasticities">Practicing
        the calculation of sensitivities and elasticities</a></li>
        </ul></li>
        <li><a href="#density-dependence-in-matrix-models"
        id="toc-density-dependence-in-matrix-models">Density-dependence
        in matrix models</a>
        <ul>
        <li><a
        href="#placing-a-limit-on-the-size-of-one-or-more-classes"
        id="toc-placing-a-limit-on-the-size-of-one-or-more-classes">Placing
        a limit on the size of one or more classes</a></li>
        <li><a
        href="#incorporating-density-dependent-functions-for-particular-vital-rates"
        id="toc-incorporating-density-dependent-functions-for-particular-vital-rates">Incorporating
        density-dependent functions for particular vital rates</a></li>
        <li><a
        href="#illustration-of-current-application-lake-sturgeon-population"
        id="toc-illustration-of-current-application-lake-sturgeon-population">Illustration
        of current application: Lake sturgeon population</a></li>
        </ul></li>
        <li><a href="#environmental-stochasticity-in-matrix-models"
        id="toc-environmental-stochasticity-in-matrix-models">Environmental
        stochasticity in matrix models</a>
        <ul>
        <li><a href="#environmental-conditions-are-not-constant-in-time"
        id="toc-environmental-conditions-are-not-constant-in-time">Environmental
        conditions are not constant in time</a></li>
        <li><a
        href="#simplest-method-of-including-temporal-environmental-stochasticity"
        id="toc-simplest-method-of-including-temporal-environmental-stochasticity">Simplest
        method of including temporal environmental
        stochasticity</a></li>
        <li><a
        href="#other-methods-of-incorporating-temporal-stochasticity"
        id="toc-other-methods-of-incorporating-temporal-stochasticity">Other
        methods of incorporating temporal stochasticity</a></li>
        <li><a href="#stochastic-population-growth-rate"
        id="toc-stochastic-population-growth-rate">Stochastic population
        growth rate</a></li>
        <li><a href="#covariance-between-matrix-elements"
        id="toc-covariance-between-matrix-elements">Covariance between
        matrix elements</a></li>
        <li><a href="#sensitivity-analysis-for-stochastic-matrix-models"
        id="toc-sensitivity-analysis-for-stochastic-matrix-models">Sensitivity
        analysis for stochastic matrix models</a></li>
        </ul></li>
        <li><a href="#references-4"
        id="toc-references-4">References</a></li>
        </ul></li>
        <li><a href="#integral-projection-models"
        id="toc-integral-projection-models">Integral Projection
        Models</a>
        <ul>
        <li><a href="#learning-outcomes-1"
        id="toc-learning-outcomes-1">Learning outcomes</a></li>
        <li><a href="#introduction-mpm-vs.-ipm"
        id="toc-introduction-mpm-vs.-ipm">Introduction: MPM
        vs. IPM</a></li>
        <li><a href="#contruction-of-ipm"
        id="toc-contruction-of-ipm">Contruction of IPM</a>
        <ul>
        <li><a href="#model-structure" id="toc-model-structure">Model
        structure</a></li>
        <li><a href="#kernel" id="toc-kernel">Kernel</a></li>
        <li><a href="#from-life-cycle-to-model"
        id="toc-from-life-cycle-to-model">From life cycle to
        model</a></li>
        <li><a href="#vital-rates-with-examples"
        id="toc-vital-rates-with-examples">Vital rates with
        examples</a></li>
        <li><a
        href="#illustration-of-current-application-spatial-integral-projection-model"
        id="toc-illustration-of-current-application-spatial-integral-projection-model">Illustration
        of current application: spatial integral projection
        model</a></li>
        <li><a href="#reference" id="toc-reference">Reference</a></li>
        <li><a href="#the-first-step-of-ipms-regressions"
        id="toc-the-first-step-of-ipms-regressions">The first step of
        IPMs: regressions</a></li>
        <li><a
        href="#how-do-we-go-about-implementing-an-ipm-for-our-species-of-interest"
        id="toc-how-do-we-go-about-implementing-an-ipm-for-our-species-of-interest">How
        do we go about implementing an IPM for our species of
        interest?</a></li>
        <li><a href="#numerical-integration-methods-midpoint-rule"
        id="toc-numerical-integration-methods-midpoint-rule">Numerical
        integration methods: midpoint rule</a></li>
        <li><a href="#model-diagnostics-and-improvement"
        id="toc-model-diagnostics-and-improvement">Model diagnostics and
        improvement</a></li>
        <li><a href="#case-study-an-ipm-for-snapping-turtles"
        id="toc-case-study-an-ipm-for-snapping-turtles">Case study: an
        IPM for snapping turtles</a></li>
        </ul></li>
        <li><a href="#references-5"
        id="toc-references-5">References</a></li>
        <li><a href="#density-dependence-in-ipm"
        id="toc-density-dependence-in-ipm">Density dependence in IPM</a>
        <ul>
        <li><a href="#modeling-density-dependence"
        id="toc-modeling-density-dependence">Modeling density
        dependence</a></li>
        <li><a href="#theories-behind-density-dependent-ipm-models"
        id="toc-theories-behind-density-dependent-ipm-models">Theories
        behind density-dependent IPM models</a></li>
        <li><a
        href="#application-of-density-dependent-ipm-to-an-ecological-problem"
        id="toc-application-of-density-dependent-ipm-to-an-ecological-problem">Application
        of density-dependent IPM to an ecological problem</a></li>
        <li><a href="#references-6"
        id="toc-references-6">References</a></li>
        <li><a href="#environmental-stochasticity-in-ipms"
        id="toc-environmental-stochasticity-in-ipms">Environmental
        stochasticity in IPMs</a></li>
        <li><a
        href="#example-temperature-dependent-growth-of-gilthead-seabream"
        id="toc-example-temperature-dependent-growth-of-gilthead-seabream">Example:
        Temperature dependent growth of gilthead seabream</a></li>
        <li><a href="#general-stochastic-ipm"
        id="toc-general-stochastic-ipm">General stochastic IPM</a></li>
        <li><a href="#two-methods-for-ipm-stochasticity"
        id="toc-two-methods-for-ipm-stochasticity">Two methods for IPM
        stochasticity</a></li>
        <li><a href="#kernel-selection" id="toc-kernel-selection">Kernel
        Selection</a></li>
        <li><a href="#parameter-selection"
        id="toc-parameter-selection">Parameter Selection</a></li>
        <li><a href="#advantages-and-disadvantages"
        id="toc-advantages-and-disadvantages">Advantages and
        disadvantages</a></li>
        <li><a href="#examples" id="toc-examples">Examples</a></li>
        <li><a href="#analysis-of-stochastic-ipms"
        id="toc-analysis-of-stochastic-ipms">Analysis of stochastic
        IPMS</a></li>
        <li><a href="#long-run-stochastic-growth-rate-lambda_s"
        id="toc-long-run-stochastic-growth-rate-lambda_s">Long run
        stochastic growth rate, <span
        class="math inline">\(\lambda_S\)</span></a></li>
        <li><a href="#lambda_s-does-exist"
        id="toc-lambda_s-does-exist"><span
        class="math inline">\(\lambda_S\)</span> does exist</a></li>
        <li><a href="#we-can-compute-lambda_s"
        id="toc-we-can-compute-lambda_s">We can compute <span
        class="math inline">\(\lambda_S\)</span></a></li>
        <li><a
        href="#we-can-approximate-lambda_s-using-tuljapurkars-small-fluctuations-approximation"
        id="toc-we-can-approximate-lambda_s-using-tuljapurkars-small-fluctuations-approximation">We
        can approximate <span class="math inline">\(\lambda_S\)</span>
        using Tuljapurkar’s small fluctuations approximation</a></li>
        <li><a href="#covariance-in-life-history-components"
        id="toc-covariance-in-life-history-components">Covariance in
        life history components</a></li>
        <li><a href="#correlation-in-environmental-fluctuations"
        id="toc-correlation-in-environmental-fluctuations">Correlation
        in environmental fluctuations</a></li>
        <li><a href="#references-7"
        id="toc-references-7">References</a></li>
        </ul></li>
        </ul></li>
        </ul>

        </div>
      </div>
            <div class="col-9">

      
      <h1 id="learning-outcomes">Learning outcomes</h1>
<ul>
<li>Develop practical skills to independently run a model using your own
data based on relevant theory and codes</li>
<li>Assess the results of population models to analyze a problem of your
interest</li>
<li>Distinguish and compare several models and select the most
appropriate model according to the life history of organisms and
available data</li>
</ul>
<h1 id="unstructured-population-models">Unstructured Population
Models</h1>
<h2 id="introduction">Introduction</h2>
<p>This module covers the most simple models to predict the dynamics of
populations, such as <strong>exponential models</strong>. Next,
<strong>stochasticity</strong>, or random effects, is approached as
affecting population dynamics. Then, <strong>density-dependency</strong>
is introduced as a phenomena that takes place when the amount of
individuals present in a given population interferes with the growth
rate of that population. Lastly, you will learn techniques to compare
models to data and perform <strong>model assessment</strong>.</p>
<h3 id="what-is-a-population-model">What is a population model?</h3>
<p>A population model consists of mathematical equations (eg.,
exponential and logistic) which represent patterns of growth, reduction,
or stabilization of a given population.</p>
<h3 id="basic-types-of-population-models">Basic types of population
models</h3>
<ul>
<li><p><strong>Unstructured population model</strong>: This model does
not distinguish individuals counted as part of a given
population.</p></li>
<li><p><strong>Structured population model</strong>: In this type of
model, individuals are categorized (eg., by age) and then
counted.</p></li>
<li><p><strong>Density-independent model</strong>: In more simple
population models, the amount of individuals present at a given time do
not interfere with reproduction success.</p></li>
<li><p><strong>Density-dependent model</strong>: This model considers
that the growth rate of a given population depends on the amount of
individuals living at a given time.</p></li>
</ul>
<h2 id="simple-models-of-population-dynamics">Simple models of
population dynamics</h2>
<h3 id="historical-facts">Historical facts</h3>
<p>In 1798, Thomas Malthus published <em>An Essay on the Principle of
Population</em> (Malthus, 1798). This work distinguished arithmetic and
geometric growth, with human populations characterized by a geometric
(or exponential; the difference between them will be covered soon)
growth while food resources were restricted to an arithmetic pattern of
growth.</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/malthus.jpg"
alt="© Elhuyar Fundazioa, Thomas Malthus, Creative Commons CC-BY-SA-3.0 license" />
<figcaption aria-hidden="true">© Elhuyar Fundazioa, <a
href="https://commons.wikimedia.org/wiki/File:Malthus.png">Thomas
Malthus</a>, <a
href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons
CC-BY-SA-3.0 license</a></figcaption>
</figure>
<p>Let’s plot an illustration to differentiate both types of growth:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random numbers from an uniform distribution (runif(n, min, max))</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>,<span class="dv">2</span>,<span class="dv">8</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot hypothetical exponential and linear growth patterns</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">exp</span>(x), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Hypothetical example of exponential versus arithmetic growth&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;population or resources&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,<span class="dv">50</span><span class="sc">+</span>(<span class="dv">40</span><span class="sc">*</span>x),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">2.2</span>, <span class="dv">2400</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Exponential population growth&quot;</span>, <span class="st">&quot;Arithmetic growth of resources available&quot;</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img
src="density-independent_files/figure-html/unnamed-chunk-1-1.jpeg" /><!-- --></p>
<ul>
<li><p>The main difference between these two types of growth is that an
arithmetic growth is characterized by the addition or subtraction of a
fixed value (eg. we added “50” in our linear growth example above, which
could represent agricultural yields, for instance).</p></li>
<li><p>Meanwhile, geometric and exponential growths are multiplicative
processes in which a fixed rate of change is applied to population sizes
at all time steps.</p></li>
</ul>
<h3
id="when-are-simple-population-models-used-in-biological-analyses">When
are simple population models used in biological analyses?</h3>
<p>Now let’s see when simple models such as the exponential growth model
are used in biology. Are there real situations where an uncontrolled
growth can be understood through such models? In some situations, we can
disregard factors which limit the growth of populations, such as
resource availability, interactions between species, and relocation of
individuals. Here are some examples:</p>
<ul>
<li><strong>Experimental settings</strong>: In lab conditions, we remove
as many factors as possible which could potentially interfere with the
growth of our model species, so that we can focus on understanding the
effects of our selected explanatory variables during experiments. In our
lab, we work with duckweeds, a group of small aquatic plant species. In
the photos below, you can see the difference between natural and lab
conditions. In lab settings, duckweeds can achieve unlimited growth
which can be modelled by exponential growth models. This is because a
single species is selected and sterilized, eliminating potential sources
of disease and all of the competition naturally seen between duckweed
species (different sizes of fronds - leaf-like shapes - represent
different duckweed species), and with other species, such as algae. In
labs, other factors are also controlled to provide optimal conditions,
such as light, nutrition, and temperature.</li>
</ul>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/duckweed_bio_example.jpg"
alt="Duckweeds in the field (left) and in lab conditions (right); left: Spirodela polyrhiza (larger fronds) and (probably) Lemna minor; right: Landoltia punctata" />
<figcaption aria-hidden="true">Duckweeds in the field (left) and in lab
conditions (right); left: <em>Spirodela polyrhiza</em> (larger fronds)
and (probably) <em>Lemna minor</em>; right: <em>Landoltia
punctata</em></figcaption>
</figure>
<ul>
<li><strong>Expanding invasive species</strong>: Following the
introduction of an invasive species, its spread is enabled by an
exponential population growth (Shigesada &amp; Kawasaki, 1997) due to
the availability of resources and/or absence of natural enemies. Spotted
knapweeds (<em>Centaurea nigra</em>), for example, were accidentally
introduced to North America in the 1980s with agricultural seeds and
soil discarded from ship ballast from Eurasia. This species is
considered problematic because it quickly replaces livestock pasture and
reduces biodiversity in affected sites (Minnesota Department of
Agriculture, 2023). A modelling study considering the life history of
knapweeds found that exponential growth following the introduction of
invading populations can be observed for about 2 years (Jacobs &amp;
Sheley, 1998). Thus, exponential models are useful for modelling the
behaviour of invading species.</li>
</ul>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/knapweed.jpg"
alt="© Kate Jewell, Common knapweed, Creative Commons CC-BY-SA-2.0 license" />
<figcaption aria-hidden="true">© Kate Jewell, <a
href="https://commons.wikimedia.org/wiki/File:Common_knapweed_%28Centaurea_nigra%29_-_geograph.org.uk_-_492672.jpg">Common
knapweed</a>, <a
href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons
CC-BY-SA-2.0 license</a></figcaption>
</figure>
<ul>
<li><strong>Management of species at risk of extinction</strong>:
Well-managed species will have little limitation to growth due to
abundant resources and small population sizes, resulting in exponential
growth rates. This was observed following management strategies to
recover endangered crane populations in both North America and Japan.
Whooping cranes (<em>Grus americana</em>) are the largest North American
birds which became severely endangered with a population of 21 birds in
1952, as well as the red-crowned crane of Hokkaido (<em>Grus
japonensis</em>) in Japan, with 33 individuals at this same year. Since
then, management efforts such as federal protection and creating
wildlife refuges ensured an exponential growth of bird populations,
which by 2020 achieved 506 individuals in North America and 1,900 in
Japan. The much faster rate at which Japanese cranes are growing is
attributed to an additional management strategy consisting of
artificially feeding birds during periods of food scarcity which was not
implemented in North America (Gronewold, 2021).</li>
</ul>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/cranes.jpg"
alt="(left) © CheepShot, Whooping Crane, Creative Commons CC-BY-2.0 license; (right) © Peter Batty, Red-crowned cranes calling, Creative Commons CC BY-NC-SA 2.0 license" />
<figcaption aria-hidden="true">(left) © CheepShot, <a
href="https://commons.wikimedia.org/wiki/File:Whooping_Crane_%283873713594%29.jpg">Whooping
Crane</a>, <a
href="https://creativecommons.org/licenses/by/2.0/">Creative Commons
CC-BY-2.0 license</a>; (right) © Peter Batty, <a
href="https://www.flickr.com/photos/ebatty/50772105027">Red-crowned
cranes calling</a>, <a
href="https://creativecommons.org/licenses/by-nc-sa/2.0/">Creative
Commons CC BY-NC-SA 2.0 license</a></figcaption>
</figure>
<h3
id="mathematical-representation-of-population-growth-patterns">Mathematical
representation of population growth patterns</h3>
<ul>
<li><p>Total population considers:</p></li>
<li><p>Births (B)</p></li>
<li><p>Deaths (D)</p></li>
<li><p>Relocations (immigrations [I] and emigrations [E])</p></li>
<li><p>Mathematical representation: <span
class="math display">\[N(tomorrow) = N(today) + B - D + I -
E\]</span></p></li>
</ul>
<p>Where: N(tomorrow): number of individuals in the future (also called
“abundance”) N(today): present number of individuals B: births D: deaths
I: immigration E: emigration</p>
<h3 id="geometric-growth">Geometric growth</h3>
<h4 id="what-is-geometric-growth">What is geometric growth?</h4>
<p>Geometric growth is a multiplicative process. Simple singled-cell
organisms have reproduction processes which result in a geometric
population growth: 1 cell divides resulting in 2 cells, 2 cells divide
resulting in 4, etc. In this case, the rate of change is equivalent to 2
(each cell divides into two each time). Geometric growth occurs in a
discrete time scale, which means that reproduction events occur
periodically in time. Annual plants, for example, can be modelled using
geometric growth models.</p>
<h4
id="mathematical-equation-to-predict-future-population-sizes">Mathematical
equation to predict future population sizes</h4>
<p>If we assume that the number of births and and deaths is proportional
to the current population size, and our population is isolated, we can
write:</p>
<p><span
class="math display">\[N_{(t+1)}=N_{t}(b_{t}-d_{t})\]</span></p>
<p>Where: N(t+1): number of individuals in the future Nt: number of
individuals at time t bt: per capita birth rate dt: per capita death
rate</p>
<h4 id="working-with-generation-times-net-reproductive-rate">Working
with generation times: Net reproductive rate</h4>
<p>R0 (pronounced as “R-naught”) is the net reproductive rate which
represents the average offspring per individual within a given
generation:</p>
<p><span class="math display">\[R_{0}=b_{t}-d_{t}\]</span></p>
<p>Thus, future population sizes can be calculated by:</p>
<p><span class="math display">\[N_{(t+1)}=N_{t}*R_0\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s practice: considering that an initial population of 100 individuals and a net </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># reproductive rate of 1.5, what will be the total population size </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in 4 generations?</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Ninitial <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>R0 <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The net reproductive rate is multiplied several times to represent each of the 4 generations:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>Nfuture <span class="ot">&lt;-</span> (Ninitial<span class="sc">*</span>R0)<span class="sc">*</span>R0<span class="sc">*</span>R0<span class="sc">*</span>R0</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Nfuture</span></code></pre></div>
<pre><code>## [1] 2073.6</code></pre>
<p>Thus, for calculating population sizes at any generation, we
have:</p>
<p><span class="math display">\[N_{t}=N_{0}*(R_0)^t\]</span></p>
<h4
id="from-generation-time-to-calendar-time-lambda-lambda-geometric-growth-rate">From
generation time to calendar time: Lambda (<span
class="math inline">\(\lambda\)</span>) geometric growth rate</h4>
<p>If we assume birth rates and death rates are constant through time,
we are left with:</p>
<p><span class="math display">\[N_{t+1}=N_{t}*(b-d)\]</span></p>
<p>We can rename this net rate, <span
class="math inline">\(\lambda\)</span>, to obtain</p>
<p><span class="math display">\[N_{t+1}=N_{t}*\lambda\]</span></p>
<p>Lambda (<span class="math inline">\(\lambda\)</span>) is the rate of
population change in units of time. The abundance in the next time step
is a proportion of the current abundance.</p>
<ul>
<li><p><span class="math inline">\(\lambda\)</span> = 1: stationary (no
changes in population growth)</p></li>
<li><p><span class="math inline">\(\lambda\)</span> 1: population is
growing</p></li>
<li><p><span class="math inline">\(\lambda\)</span> &lt; 1: population
is shrinking</p></li>
</ul>
<h4 id="lambda-and-proportional-population-changes"><span
class="math inline">\(\lambda\)</span> and proportional population
changes</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">=</span><span class="fl">1.45</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#We can calculate how much a population will change in the next time step (eg., next year):</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>percentage_of_change<span class="ot">=</span>(lambda<span class="dv">-1</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 45</code></pre>
<h4 id="lambda-for-calculating-future-population-size"><span
class="math inline">\(\lambda\)</span> for calculating future population
size</h4>
<p>The abundance of a population depends on the current population and
on the <span class="math inline">\(\lambda\)</span> rate:</p>
<p><span class="math display">\[N_{t+1}=N_{t}\lambda\]</span></p>
<p>Where: N(t+1): population size in the future time Nt: current
population size <span class="math inline">\(\lambda\)</span>: lambda
growth rate (discrete or geometric)</p>
<h4
id="obtaining-lambda-from-population-sizes-at-different-time-points">Obtaining
<span class="math inline">\(\lambda\)</span> from population sizes at
different time points</h4>
<p>Rearranging this last equation, we have:</p>
<p><span class="math display">\[\lambda=N_{t+1}/N_{t}\]</span></p>
<ul>
<li>Example using an annual plant</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We take note of the population growth of a given annual plant at different time periods:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>year1 <span class="ot">&lt;-</span> <span class="dv">74</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>year0 <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying the equation above we get the lambda growth rate over the first year period:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> year1<span class="sc">/</span>year0</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 2.114286</code></pre>
<h4
id="simplifying-the-future-population-growth-calculation">Simplifying
the future population growth calculation</h4>
<p>For several time steps with growth occurring at the same <span
class="math inline">\(\lambda\)</span> rate, <span
class="math inline">\(\lambda\)</span> would be continuously multiplied
by itself (in the same fashion as R0), so we have:</p>
<p><span class="math display">\[N_{t}=N_{0}\lambda^t\]</span></p>
<h4
id="missing-data-for-certain-time-periods-average-lambda-calculation">Missing
data for certain time periods: Average <span
class="math inline">\(\lambda\)</span> calculation</h4>
<p>When we do not have data for calculating all <span
class="math inline">\(\lambda\)</span> over several time periods, we can
rearrange the equation we just saw and consider the latest time period
available and the first time period:</p>
<p><span class="math display">\[\lambda=(N_{t}/N_{0})^{1/t}\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are population numbers for a given plant species at year 2 and year 0:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>year2 <span class="ot">&lt;-</span> <span class="dv">173</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>year0 <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The average yearly lambda is:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> (year2<span class="sc">/</span>year0)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<h3 id="exponential-growth">Exponential growth</h3>
<h4 id="what-is-exponential-growth">What is exponential growth</h4>
<p>For populations which do not reproduce seasonally, an irrestricted
growth can be projected using the exponential growth model. Instead of
the <span class="math inline">\(\lambda\)</span> rate, the
<strong>instantaneous per capita growth rate (r)</strong> is used to
represent a constant percentage increase over a continuous time scale.
This rate is also useful to compare populations with different intervals
of growth.</p>
<h4 id="how-to-calculate-the-exponential-growth-rate">How to calculate
the exponential growth rate</h4>
<p>Using calculus, very small changes in abundance over time can be
obtained by the derivative:</p>
<p><span class="math display">\[dN/dt=rN\]</span> Where: dN = very small
change in abundance dt = very small change in time N = present abundance
r = per capita growth rate</p>
<h4 id="abundance-over-time-in-a-logarithmic-scale">Abundance over time
in a logarithmic scale</h4>
<p>If represented in a logarithmic scale, the curve line becomes a
straight line, and the slope of the line corresponds to r.</p>
<h4 id="converting-between-lambda-and-r">Converting between <span
class="math inline">\(\lambda\)</span> and r</h4>
<p>The natural logarithm of <span class="math inline">\(\lambda\)</span>
corresponds to r:</p>
<p><span class="math display">\[r=ln\lambda\]</span> or</p>
<p><span class="math display">\[\lambda=e^r\]</span></p>
<p>While <span class="math inline">\(\lambda\)</span> values greater
than 1 represent growing populations, r values greater than 0 correspond
to population increases in size.</p>
<h4 id="example-using-duckweeds">Example using duckweeds</h4>
<p>Remember our duckweeds? Due to their fast and asexual growth, they
are good model species for population ecology studies. Duckweed
population growth can be calculated in a number of ways, such as
counting individual fronds (leaf like shape) or measuring the dry weight
of specimens. Try to count how many individuals are found in each date
in the picture below. Any round-shaped protuberance can be considered as
a separate individual.</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/duckweed_pop2.jpg"
alt="Populations of duckweeds (Lemna minor) grown in laboratory conditions and optimal temperature" />
<figcaption aria-hidden="true">Populations of duckweeds (<em>Lemna
minor</em>) grown in laboratory conditions and optimal
temperature</figcaption>
</figure>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s create a dataframe using the duckweed population counts we have just obtained </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># from the picture above:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>duckweed <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">day=</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>)),<span class="at">pop_size=</span>(<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">23</span>,<span class="dv">45</span>,<span class="dv">68</span>,<span class="dv">103</span>)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, let&#39;s calculate the average daily $\lambda$:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> (duckweed[<span class="dv">6</span>, <span class="st">&quot;pop_size&quot;</span>]<span class="sc">/</span>duckweed[<span class="dv">1</span>, <span class="st">&quot;pop_size&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(duckweed[<span class="dv">6</span>, <span class="st">&quot;day&quot;</span>]<span class="sc">-</span>duckweed[<span class="dv">1</span>, <span class="st">&quot;day&quot;</span>]))</span></code></pre></div>
<p>The average daily lambda is 1.28.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And the r</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">log</span>(lambda)</span></code></pre></div>
<p>The intrinsic rate of increase is 0.24. This means that our duckweed
populations are growing at an average daily rate of 24.38%.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And here we simulate the growth of duckweeds over a 40-day period</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> duckweed<span class="sc">$</span>pop_size[<span class="dv">1</span>]; t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>cont.mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(r, <span class="cf">function</span>(ri) N0 <span class="sc">*</span> <span class="fu">exp</span>(ri <span class="sc">*</span> t))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(t, cont.mat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">1</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;Exponential model projecting duckweed population growth&quot;</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;days&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;population size (number of individuals)&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(duckweed<span class="sc">$</span>day, duckweed<span class="sc">$</span>pop_size,<span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">1995</span>, <span class="dv">1300</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Observed data&quot;</span>, <span class="st">&quot;Model predictions&quot;</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">lty=</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">1</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="cn">NA</span>))</span></code></pre></div>
<p><img
src="density-independent_files/figure-html/unnamed-chunk-8-1.jpeg" /><!-- --></p>
<h4 id="simplifying-the-exponential-growth-calculation">Simplifying the
exponential growth calculation</h4>
<p>Due to the ability to replace <span
class="math inline">\(\lambda\)</span> for r and vice-versa, we
have:</p>
<p><span class="math display">\[N_{t}=N_{0}e^{rt}\]</span></p>
<h4 id="doubling-time">Doubling time</h4>
<p>If we need to know how much time it would take for a population to
achieve twice as much its initial size, we replace N(final)/N(initial)
with 2 in our exponential growth equation. We then take the natural
logarithm from both sides of the equation to solve, resulting in:</p>
<p><span class="math display">\[t_{double}=0.69/r\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can use this equation to calculate the doubling time for our experimental duckweeds:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>double <span class="ot">&lt;-</span> <span class="fl">0.69</span><span class="sc">/</span>r</span></code></pre></div>
<p>The doubling time for our duckweeds is 2.83 days.</p>
<h4 id="illustration-of-current-application">Illustration of current
application</h4>
<p>Ecosystem effects of the world’s largest invasive animal (Shurin et
al., 2020). This research paper discusses population dynamics of
invasive hippos in Colombia.</p>
<h5 id="snapshot-of-the-study">Snapshot of the study</h5>
<ul>
<li><p>An invasive population of hippopotamus (<em>Hippopotamus
amphibus</em>) is showing an exponential growth in Colombia</p></li>
<li><p>These large mammals were brought from Africa to the famous drug
trafficker Carlos Scobar’s private zoo about 25 years ago</p></li>
<li><p>Following Scobar’s death, the then abandoned animals started
spreading in the region, going from 4 to 65 individuals in 25
years</p></li>
<li><p>Hippos are considered as ecosystem engineers because they modify
ecosystems by grazing on land and defecating in water bodies, thereby
fertilizing aquatic systems</p></li>
<li><p>The growth of this invasive population appears to be in an
exponential phase, with numbers achieving thousands in the following
decades if no control measures are taken or without density-dependent
regulation (to be introduced in the following module)</p></li>
<li><p>This study analyzed aquatic and terrestrial areas populated by
hippos to conclude that this invasive species is substantially changing
the environment by relocating nutrients from the soil to the water,
resulting in cyanobacteria blooms. Continued unrestricted hippo
population growth can then lead to water resource damage.</p></li>
<li><p>Constrains to management: Actions to manage this invasive species
are complicated by the social-ecological mismatch between the scientific
consensus on the ecosystem threats posed by this invasion and the public
perception of the presence of hippos as being positive (eg., animal used
for touristic purposes)</p></li>
</ul>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/hippo2.jpg"
alt="© Bernard Dupont, Grazing hippos, Creative Commons CC-BY-SA-2.0 license" />
<figcaption aria-hidden="true">© Bernard Dupont, <a
href="https://commons.wikimedia.org/wiki/File:Hippo_%28Hippopotamus_amphibius%29_emaciated_specimen_grazing_on_Sabie_riverbank_..._%2833321050795%29.jpg">Grazing
hippos</a>, <a
href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons
CC-BY-SA-2.0 license</a></figcaption>
</figure>
<h5
id="calculating-the-population-growth-of-invasive-hippos">Calculating
the population growth of invasive hippos</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let&#39;s create a data frame containing dates and respective population counts </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as in Shurin (2020). We added additional records obtained from news outlets:</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>hippo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year=</span><span class="fu">c</span>(<span class="dv">1993</span>, <span class="dv">2009</span>, <span class="dv">2014</span>, <span class="dv">2019</span>, <span class="dv">2022</span>),<span class="at">pop_size=</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">28</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">133</span>)))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source for 2009: Romero (2009)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># source for 2014: Kremer (2014)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># source for 2022: Varona (2022)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hippo<span class="sc">$</span>year, hippo<span class="sc">$</span>pop_size, <span class="at">type=</span><span class="st">&quot;o&quot;</span>, <span class="at">pch=</span><span class="dv">15</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Invasive hippo population growth over time in Colombia&quot;</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;years&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;population size (number of individuals)&quot;</span>)</span></code></pre></div>
<p><img
src="density-independent_files/figure-html/unnamed-chunk-10-1.jpeg" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, let&#39;s calculate the average yearly $\lambda$:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> (hippo[<span class="dv">5</span>, <span class="st">&quot;pop_size&quot;</span>]<span class="sc">/</span>hippo[<span class="dv">1</span>, <span class="st">&quot;pop_size&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(hippo[<span class="dv">5</span>, <span class="st">&quot;year&quot;</span>]<span class="sc">-</span>hippo[<span class="dv">1</span>, <span class="st">&quot;year&quot;</span>]))</span></code></pre></div>
<p>The average yearly lambda is 1.13.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By taking the natural logarithm, we convert $\lambda$ to r</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">log</span>(lambda)</span></code></pre></div>
<p>The intrinsic rate of increase is 0.12. This means that this invasive
hippo population is growing at an average yearly rate of 12.08”%.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To predict population sizes, we first set our initial population size</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>initial<span class="ot">&lt;-</span>hippo<span class="sc">$</span>pop_size[<span class="dv">1</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># And we create an empty vector in which we will later include population sizes for the </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># next 50 years</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>pred.pop.expon<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">50</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Our modelling starts with initially observed population sizes</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>pred.pop.expon[<span class="dv">1</span>]<span class="ot">&lt;-</span>initial</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># And we add a function to calculate population sizes according to our previously </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># estimated growth rates</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  pred.pop.expon[i]<span class="ot">&lt;-</span>pred.pop.expon[i<span class="dv">-1</span>]<span class="sc">*</span>lambda</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a dataframe to include our predictions</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>hippo.model <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year=</span><span class="fu">c</span>(<span class="dv">1993</span><span class="sc">:</span>(<span class="dv">1993</span><span class="sc">+</span><span class="dv">49</span>)),<span class="at">pop_size=</span>pred.pop.expon)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co"># And plotting predicitons and observed data</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hippo.model<span class="sc">$</span>year, hippo.model<span class="sc">$</span>pop_size,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Exponential growth model of invasive hippos in Colombia&quot;</span>, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;years&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;population size (number of individuals)&quot;</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(hippo<span class="sc">$</span>year, hippo<span class="sc">$</span>pop_size,<span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">1995</span>, <span class="dv">1300</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;oObserved data&quot;</span>, <span class="st">&quot;Model predictions&quot;</span>),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">lty=</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">1</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="cn">NA</span>))</span></code></pre></div>
<p><img
src="density-independent_files/figure-html/unnamed-chunk-13-1.jpeg" /><!-- --></p>
<p>This illustration demonstrates the utility of the exponential growth
model for studying invading populations. Why do you think hippos are
showing this uncontrolled growth?</p>
<h5
id="hippo-invasion-in-colombia-take-aways-and-future-developments">Hippo
invasion in Colombia: take-aways and future developments</h5>
<ul>
<li><p>The research found an annual per capita growth rate of 0.11 x
yr^-1 for invasive hippos, which is comparable to population growth
rates in the native range and indicates a potential for quick spread of
this invasive species in the next decades. The growth rate we obtained
above is slightly different because we took into account additional
recent demography records. The lack of predators in both native and
invasive ranges (Sinclair, Mduma, &amp; Brashares, 2003;
Castelblanco-Martínez et al., 2021) is a key factor enabling
uncontrolled hippo population growth.</p></li>
<li><p>As a next step, refining population growth studies to include
<strong>stage structure</strong> and <strong>age at maturity</strong>
could help identifying useful management strategies, as there may be
life history traits which are more relevant to population growth than
others. For example, the population structure of hippos appears to be an
important factor when predicting future invasion scenarios, as “half of
those hippos are calves and juveniles, implying their reproductive rate
will increase in the next three years” (Varona, 2022). You will learn
about structured population models in the upcoming modules.</p></li>
</ul>
<h3 id="further-reading">Further Reading</h3>
<h4 id="theoretical-work">Theoretical work</h4>
<p>To read about the theory behind simple models, refer to:<br />
* Mills, L.S. (2012). <em>Conservation of wildlife populations</em>:
Demography, genetics, and management. Wiley- Blackwell.</p>
<h4 id="population-modelling-codes">Population modelling codes</h4>
<p>To further practice the application of simple models, here are good
guides:<br />
* Dyer, R. (2009). Biological data analysis using R (Doctoral
dissertation, Ph. D thesis. Department of Biology, Center for the Study
of Biological Complexity, Virginia Commonwealth Univ).</p>
<ul>
<li>Stevens, M.H. (2009). <em>A primer of ecology with R</em>.
Springer.</li>
</ul>
<h4 id="new-applications">New applications</h4>
<ul>
<li>Thomas, L., Russell, D. J., Duck, C. D., Morris, C. D., Lonergan,
M., Empacher, F., … &amp; Harwood, J. (2019). Modelling the population
size and dynamics of the British grey seal. <em>Aquatic Conservation:
Marine and Freshwater Ecosystems, 29</em>, 6-23.</li>
</ul>
<h3 id="r-resources">R Resources</h3>
<h4 id="packages">Packages</h4>
<ul>
<li><p>deSolve: contains solvers (function “ode”) for integrals: eg.,
integral of the exponential growth equation and ordinary differential
equations (ODE): eg., logistic growth</p></li>
<li><p>clogistic: logistic growth equation</p></li>
<li><p>AICcmodavg: model evaluation using Akaike information
criteria</p></li>
</ul>
<h4 id="functions">Functions</h4>
<ul>
<li><p><a
href="https://www.datacamp.com/tutorial/tutorial-on-loops-in-r">for
Loop</a></p></li>
<li><p><a
href="https://rstudio-pubs-static.s3.amazonaws.com/252603_9c6a71110dc74cc7832f154449235f7f.html">plotting
population models</a></p></li>
<li><p><a
href="https://r-coder.com/sapply-function-r/">sapply</a></p></li>
<li><p><a
href="https://swcarpentry.github.io/r-novice-inflammation/02-func-R/">customized
functions</a></p></li>
</ul>
<h3 id="references">References</h3>
<p>Castelblanco-Martínez, D. N., Moreno-Arias, R. A., Velasco, J. A.,
Moreno-Bernal, J. W., Restrepo, S., Noguera-Urbano, E. A., … &amp;
Jiménez, G. (2021). A hippo in the room: Predicting the persistence and
dispersion of an invasive mega-vertebrate in Colombia, South America.
<em>Biological Conservation, 253</em>, 108923.</p>
<p>Dyer, R. (2009). Biological data analysis using R (Doctoral
dissertation, Ph. D thesis. Department of Biology, Center for the Study
of Biological Complexity, Virginia Commonwealth Univ).</p>
<p>Gronewold, N. (2021). Comparative Conservation Strategy Efficacy for
Grus japonensis and Grus americana: A Post-Policy Implementation
Assessment. <em>Journal of International Wildlife Law &amp; Policy,
24</em>(3-4), 224-250.</p>
<p>Jacobs, J. S., &amp; Sheley, R. L. (1998). Observation: life history
of spotted knapweed. <em>Rangeland Ecology &amp; Management/Journal of
Range Management Archives, 51</em>(6), 665-673.</p>
<p>Kremer, W. (2014, June 25). Pablo Escobar’s hippos: A growing
problem. <em>BBC News</em>.
https://www.bbc.com/news/magazine-27905743</p>
<p>Malthus, T. R. (1798). <em>An essay on the principle of
population</em>. The Works of Thomas Robert Malthus, London, Pickering
&amp; Chatto Publishers, 1, 1-139.</p>
<p>Mills, L.S. (2012). <em>Conservation of wildlife populations</em>:
Demography, genetics, and management. Wiley- Blackwell.</p>
<p>NBCUniversal News Group. (2014, July 1). Pablo Escobar’s hippos are
running wild in Colombia. <em>NBCNews.com</em>.
https://www.nbcnews.com/news/latin-america/pablo-escobars-hippos-are-running-wild-colombia-n145446</p>
<p>Romero, S. (2009, September 10). Colombia confronts drug lord’s
legacy: Hippos. <em>The New York Times</em>.
https://www.nytimes.com/2009/09/11/world/americas/11hippo.html</p>
<p>Shigesada, N. &amp; Kawasaki, K. (1997) Biological Invasions: Theory
and Practice (Oxford Univ. Press, Oxford).</p>
<p>Shurin, J. B., Aranguren-Riaño, N., Duque Negro, D., Echeverri Lopez,
D., Jones, N. T., Laverde‐R, O., … &amp; Pedroza Ramos, A. (2020).
Ecosystem effects of the world’s largest invasive animal. <em>Ecology,
101</em>(5), e02991.</p>
<p>Sinclair, A. R., Mduma, S., &amp; Brashares, J. S. (2003). Patterns
of predation in a diverse predator–prey system. <em>Nature,
425</em>(6955), 288-290.</p>
<p>Spotted knapweed. (2023). Minnesota Department of Agriculture.
https://www.mda.state.mn.us/plants/pestmanagement/weedcontrol/noxiouslist/spottedknapweed</p>
<p>Stevens, M.H. (2009). <em>A primer of ecology with R</em>.
Springer.</p>
<p>Varona , A. O. (2022, November 18). Hippos in Colombia: What to do
with them? | Graduate and Postdoctoral Studies | <em>Rice
University</em>.
https://graduate.rice.edu/news/current-news/hippos-colombia-what-do-them</p>
<h2 id="density-dependence">Density dependence</h2>
<p>Density-dependent population models are used to describe population
dynamics in which the growth or decline of a population is influenced by
the population’s own density.</p>
<h3 id="logistic-growth-model">Logistic growth model</h3>
<p>Recall that with exponential growth, per capita growth rate is:</p>
<p><span class="math display">\[ r = \frac{dN}{dtN} \]</span></p>
<ul>
<li>dN/dt: The net number of new individuals in a population over a unit
of time (also called recruitment or yield)</li>
<li>r: Intrinsic growth rate</li>
<li>N: Population size</li>
</ul>
<p>Of all the ways that the per capita growth rate could decrease with
increasing population density, we consider the simplest scenario in
which this relationship is linear. Now we have:</p>
<p><span class="math display">\[ \frac{dN}{dtN} =
r(1-\frac{N}{K})\]</span></p>
<ul>
<li>K: Carrying capacity</li>
</ul>
<p>where <span class="math inline">\(1-\frac{N}{K}\)</span> describes
the negative effects an increasing population density has on the per
capita growth rate.</p>
<p>Re-arrange the above equation and we have the <strong>continuous
logistic growth model</strong>:</p>
<p><span class="math display">\[ \frac{dN}{dt} = r \frac{K-N}{K} N
\]</span></p>
<ul>
<li>K − N: How many more individuals can be added to the population
before it hits carrying capacity</li>
<li>K − N/K: The fraction of the carrying capacity that has not yet been
“used up”</li>
</ul>
<h3 id="negative-density-dependence">Negative density dependence</h3>
<p>In a population that has already been established, resources begin to
become scarce, and competition starts to play a role. As a result, the
population growth will be negatively affected by increasing density.
This is called <strong>negative density dependence</strong>.</p>
<p>Increasing population size gives rise to:</p>
<ul>
<li><p>shortages in food or other limiting resources</p></li>
<li><p>greater intraspecific aggression</p></li>
<li><p>increased predation risks</p></li>
<li><p>greater risks of disease outbreak</p></li>
</ul>
<p>Negative density dependence decreases population growth at high
density and increases it at low density.</p>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-1-1.jpeg"
alt="The constrast between exponential with a constant per capita growth rate of r=0.18, and logistic growth with an initial per capita growth rate of r=0.18, K=500. In logistic growth, the per capita growth rate decreases with population size (adapted from Mills, 2013)" />
<figcaption aria-hidden="true">The constrast between exponential with a
constant per capita growth rate of <span
class="math inline">\(r=0.18\)</span>, and logistic growth with an
initial per capita growth rate of <span
class="math inline">\(r=0.18\)</span>, <span
class="math inline">\(K=500\)</span>. In logistic growth, the per capita
growth rate decreases with population size (adapted from Mills,
2013)</figcaption>
</figure>
<p>Here is another example from the duckweed showing how population size
can limit the population growth of duckweed in a controlled
environment.</p>
<figure>
<img src="duckweek_log.jpg"
alt="Logistic growth of duckweed in the lab environment" />
<figcaption aria-hidden="true">Logistic growth of duckweed in the lab
environment</figcaption>
</figure>
<ul>
<li>Carrying capacity (K)</li>
</ul>
<p>The maximum per capita growth rate, <span
class="math inline">\(r\)</span>, occurs when population density is
zero, and decreases until it finally reaches zero. The population
density at which the per capita growth rate is zero, K, is sometimes
called the carrying capacity.</p>
<ul>
<li><em>Note</em>: Do not think of carrying capacity as the maximum
population size observed. A population can exceed K temporarily.</li>
</ul>
<p>With all these concepts, now we should look at the logistic
population model.</p>
<h4 id="stability">Stability</h4>
<p>The <strong>stability</strong> of a system is a measure of how much
it tends to stay the same, in spite of external disturbances or changes
in the state of the system. A logistic population growth model is a
system with stability, and carrying capacity <span
class="math inline">\(K\)</span> is the stable equilibrium point.
Population size above <span class="math inline">\(K\)</span> will
decrease to <span class="math inline">\(K\)</span>; while population
size below <span class="math inline">\(K\)</span> will increase to <span
class="math inline">\(K\)</span>.</p>
<p>Consider a logistic growth model with a carrying capacity <span
class="math inline">\(K=500\)</span> and per capita growth rate <span
class="math inline">\(r=0.18\)</span>:</p>
<ul>
<li><p>When the population number is at 100 (point b) or 200 (point c),
the population will grow, moving along the x-axis, until population
growth rate slows so much that it comes to rest where <span
class="math inline">\(N=K=500\)</span>.</p></li>
<li><p>When the population number is at 550 (point e), <span
class="math inline">\(dN/dt\)</span> is negative, so <span
class="math inline">\(N\)</span> shrinks back down to <span
class="math inline">\(N=K=500\)</span>.</p></li>
<li><p>When population number is at 0 (point a) or 500 (point d), the
population growth rate is at zero so that the density will not
change.</p></li>
</ul>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-3-1.jpeg"
alt="Population growth rate, dN=dt, as a function of N. Arrows are pointing to the stable equilibrium point at carrying capacity" />
<figcaption aria-hidden="true">Population growth rate, <span
class="math inline">\(dN=dt\)</span>, as a function of <span
class="math inline">\(N\)</span>. Arrows are pointing to the stable
equilibrium point at carrying capacity</figcaption>
</figure>
<h3 id="discrete-time-logistic-growth">Discrete time logistic
growth</h3>
<p>For many populations, reproduction and mortality occur at very
particular periods of the year (in discrete intervals of time).</p>
<h4 id="discrete-logistic-equation">Discrete logistic equation</h4>
<p>To model discrete logistic population growth, we start from recalling
our model of geometric growth for a single time step:</p>
<p><span class="math display">\[ N_{t+1} = \lambda N_t\]</span></p>
<p>We can decompose <span class="math inline">\(\lambda\)</span> into
two parts to illustrate that this year’s population density <span
class="math inline">\(N_t+1\)</span> is equal to the previous year’s
population, <span class="math inline">\(N_t\)</span>, plus a
proportional change, <span class="math inline">\(r_dN_t\)</span>:</p>
<p><span class="math display">\[N_{t+1} = \lambda N_t = N_t(1+r_d) =
N_t+r_dN_t\]</span></p>
<p>Now we can try to incorporate density dependence into that
proportional change <span class="math inline">\(r_dN_t\)</span>. We use
<span class="math inline">\(1/K\)</span> to represent this negative
effect on population growth. As a result, <span
class="math inline">\(r_d(1- \frac{N_t}{K})\)</span> becomes the new per
capita growth increment rate.</p>
<p>And we have an equation that describes <strong>discrete logistic
growth</strong>:</p>
<p><span class="math display">\[N_{t+1} = N_t+r_d(1- \frac{N_t}{K})N_t =
N_t+r(1-\frac {N_t}{K})N_t\]</span></p>
<p>where <span class="math inline">\(K\)</span> is the carrying
capacity.</p>
<p>From the equation, we can see that the population abundance at time
<span class="math inline">\(t+1\)</span> depend on the abundance at time
t. This time lag makes sense for many populations, where birth and death
rates respond to the population’s density at some time in the past,
instead of current density.</p>
<h4 id="chaos">Chaos</h4>
<p>Populations growing with absolutely no stochasticity could show
dynamics that bounce, or cycle, or become entirely unpredictable.</p>
<p><br> Let’s look at the following example:</p>
<p>We have a population that has an initial population density of <span
class="math inline">\(N=10\)</span>, and carrying capacity <span
class="math inline">\(K=100\)</span>. With different values of <span
class="math inline">\(r\)</span>, we can see very different population
growth trajectories.</p>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-4-1.jpeg"
alt="Population growth with an initial population density of N=10, carrying capacity K=100. With different values of per capita growth rate r, the population growth trajectories are very different" />
<figcaption aria-hidden="true">Population growth with an initial
population density of <span class="math inline">\(N=10\)</span>,
carrying capacity <span class="math inline">\(K=100\)</span>. With
different values of per capita growth rate <span
class="math inline">\(r\)</span>, the population growth trajectories are
very different</figcaption>
</figure>
<p>When <span class="math inline">\(r\)</span> is close to zero, we have
a steady simple asymptotic approach to K (Fig. a). As <span
class="math inline">\(r\)</span> increases, we see the population
overshoot the carrying capacity and exhibit <strong>damped
oscillations</strong> (Fig. b). At <span
class="math inline">\(r=2.2\)</span>, we see a stable limit cycle of two
points (Fig. c). As <span class="math inline">\(r\)</span> increases
further, a four-point limit cycle is observed (e.g., at <span
class="math inline">\(r=2.5\)</span>, Fig. d), then an eight-point
cycle, a 16-point limit cycle, and so on. As <span
class="math inline">\(r\)</span> increases further, however, stable
limit cycles shift into chaos (Fig. e).</p>
<p><strong>Bifurcation Graph</strong> We can also demonstrate the
chaotic dynamics using a bifurcation plot, which examines <span
class="math inline">\(N\)</span> as a function of <span
class="math inline">\(r\)</span>. As <span
class="math inline">\(r\)</span> increases the number of <span
class="math inline">\(N\)</span> will continue to double, growing
geometrically. Eventually, we reach a point when there becomes an
infinite number of unique points.</p>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-6-1.jpeg"
alt="Long term dynamics of discrete logistic population growth, with an initial population density of N=10, and carrying capacity K=100 (Stevens, 2009)" />
<figcaption aria-hidden="true">Long term dynamics of discrete logistic
population growth, with an initial population density of <span
class="math inline">\(N=10\)</span>, and carrying capacity <span
class="math inline">\(K=100\)</span> (Stevens, 2009)</figcaption>
</figure>
<p><br> <strong>Chaos</strong> is a non-repeating, deterministic
fluctuating trajectory, that is bounded, and sensitive to initial
conditions.</p>
<p>How does chaos happen? The discrete logistic model has a built in
delay, or time lag, of one time step, because the growth increment makes
a single leap of one time step. This time delay in population response
results in chaos dynamics.</p>
<ul>
<li>Note that chaos is different from stochasticity or randomness. If
you start with exactly the same initial conditions under chaotic
dynamics, you will get exactly the same population trajectories every
time</li>
</ul>
<p>Chaos is <strong>very sensitive to initial conditions</strong>.
Slightly changing the initial population number <span
class="math inline">\(N_0\)</span> would result in very distinct
results.</p>
<ul>
<li>Here we start with two populations that have initial size of 10 and
11 (all other parameters remain the same). As shown on the graph below,
we see completely different trajectories for population growth.</li>
</ul>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-5-1.jpeg"
alt="Chaotic dynamics with different initial conditions. Black solid line demonstrates the population trajectory for a population that has an initial size of 10; red dotted line demonstrates the population trajectory for a population that has an initial size of 11" />
<figcaption aria-hidden="true">Chaotic dynamics with different initial
conditions. Black solid line demonstrates the population trajectory for
a population that has an initial size of 10; red dotted line
demonstrates the population trajectory for a population that has an
initial size of 11</figcaption>
</figure>
<p><strong>Biological significance of chaos in population
growth</strong></p>
<p>Chaos brings more complexity into predicting population growth,
especially for species with relatively large <span
class="math inline">\(r_d\)</span> value. For example, for
temperate-zone insects in particular, even if the natural world was 100
% predictable, the population dynamics could still in some circumstances
be indistinguishable from chaos (May, 1975).</p>
<h3 id="other-types-of-density-dependent-population-models">Other types
of density dependent population models</h3>
<p>The linear decline in per capita growth rate with density modeled
above is not necessarily general. In fact, most species exhibit
<strong>nonlinear</strong> declines in growth rate under negative
density dependence.</p>
<h4 id="concave-and-convex-density-dependences">Concave and convex
density dependences</h4>
<ul>
<li><p><strong>Concave density dependence</strong>: Per capita
population growth rate declines rapidly at low density, and then
flattens out as carrying capacity is approached. This could happen due
to resource preemption, where a small of individuals at low population
density sequester large amounts of resources, causing subsequent
population growth to slow down. For example, larger tropical seagrass
arriving at sites would preempy available space to prevent subsequent
individuals from competing for these resources (Moreira-Saporiti et al.,
2021)</p></li>
<li><p><strong>Convex density dependence</strong>: Per capita population
growth rate exhibits strong density dependence only near K. This could
be related to territoriality. For example, dickcissel birds (<em>Spiza
americana</em>) need a minimum territory size of approximately 0.9
acres. If male density is greater than this, some males will be forced
into territories that contain less suitable vegetation and they are
found to be less active in finding mates and building nests. As a
result, the per capita growth rate will decline more rapidly compared to
before (Zimmerman, 1971)</p></li>
</ul>
<h4 id="theta-ricker-model">Theta-Ricker model</h4>
<p>The most common way to model non-linear density dependent population
growth is the Theta-Ricker model. By varying <span
class="math inline">\(\theta\)</span>, we can change the linear density
dependence of the simple logistic model to curvi-linear density
dependence.</p>
<p><span class="math display">\[ N_{t+1} = N_t e^{r_0[1-(N_t/K)^\theta]}
\]</span></p>
<ul>
<li>The effects of <span class="math inline">\(\theta\)</span> on
density dependence control the shape of relation between growth rate and
population size, as seen in the following figure:</li>
</ul>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-7-1.jpeg"
alt="Per capita growth rate vs. population size with different theta values" />
<figcaption aria-hidden="true">Per capita growth rate vs. population
size with different theta values</figcaption>
</figure>
<ul>
<li>When <span class="math inline">\(\theta\)</span>&gt;1, this weakens
density dependence at low N, so the population grows faster than
logistic, all else being equal (concave). When <span
class="math inline">\(\theta\)</span>&lt;1, this strengthens density
dependence at low N, causing the population to grow more slowly than
logistic, all else being equal (convex):</li>
</ul>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-8-1.jpeg"
alt="Population size vs. time with different theta values" />
<figcaption aria-hidden="true">Population size vs. time with different
theta values</figcaption>
</figure>
<h4 id="positive-density-dependence">Positive density dependence</h4>
<p>In many cases, cooperation or facilitation leads to mutually positive
interactions among members of a population. Positive density dependence
occurs when vital rates or populations increase as density
increases.</p>
<h5 id="allee-effect">Allee effect</h5>
<p>Allee &amp; Bowen (1932) initially noticed that goldfish grew faster
in waters which had previously contained other goldfish, than in waters
that had not contained them. He further experimented with a number of
different species and showed that larger group size or some degree of
crowding may stimulate reproduction, prolong survival in adverse
conditions (through resistance to desiccation or by social
thermoregulation), and enhance protection from toxic reagents.</p>
<p>The Allee effect occurs when there is a positive correlation between
population density and individual fitness at low population density.</p>
<figure>
<img src="african_w_dog.jpg"
alt="© flowcomm, African wilddogs hunting in packs, Creative Commons CC BY 2.0 license" />
<figcaption aria-hidden="true">© flowcomm, <a
href="https://live.staticflickr.com/5117/13949089869_e175469efc_b.jpg">African
wilddogs hunting in packs</a>, <a
href="https://creativecommons.org/licenses/by/2.0/">Creative Commons CC
BY 2.0 license</a></figcaption>
</figure>
<p><strong>Example</strong></p>
<ul>
<li><p>African wild dogs usually live in a pack of 6-20
individuals</p></li>
<li><p>Increasing pack size can:</p>
<ul>
<li><p>increase the likelihood of a successful kill in a given
hunt</p></li>
<li><p>provide a better predator defense</p></li>
<li><p>help babysit pups (packs with 10 or more adults raised three
times as many yearlings compared to packs with 9 or fewer
adults)</p></li>
</ul></li>
</ul>
<h5 id="weak-and-strong-allee-effects">Weak and strong Allee
effects</h5>
<ul>
<li><p><strong>Weak Allee effects</strong>: A weak Allee effect is where
the population growth rate is small but positive for small N. The
population does not contain a critical population size or density under
which the growth rate becomes negative</p></li>
<li><p><strong>Strong Allee effects</strong>: A strong Allee effect
describes a population that can grow at intermediate population
densities but declines when the number of organisms is either too small
or too large</p></li>
<li><p><strong>Allee effect population threshold</strong>: A population
size below which the per capita growth rate is negative and the
population declines towards extinction. Populations that are subject to
Allee effects can collapse and become extinct if their population size
falls below the critical threshold</p></li>
</ul>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-9-1.jpeg"
alt="No Allee effects (green line), weak Allee effects (red line), and strong Allee affects (blue line, a=50) acting on a population that has an intrinsic population growth rate r=0.18 and carrying capacity K=500" />
<figcaption aria-hidden="true">No Allee effects (green line), weak Allee
effects (red line), and strong Allee affects (blue line, <span
class="math inline">\(a=50\)</span>) acting on a population that has an
intrinsic population growth rate <span
class="math inline">\(r=0.18\)</span> and carrying capacity <span
class="math inline">\(K=500\)</span></figcaption>
</figure>
<p>To plot population growth rate as a function of abundance:</p>
<p><span class="math display">\[\frac{dN}{dt} =
rN(\frac{N}{a}-1)(1-\frac{N}{K})\]</span> where a is the critical point
of the population, below which the population growth rate (or
recruitment) becomes negative, and the population is driven towards
extinction.</p>
<h5 id="stability-in-allee-effects">Stability in Allee effects</h5>
<p>From previous sections we learned that carrying capacity <span
class="math inline">\(K\)</span> is a stable equilibrium point in a
negative density-dependent logistic growth model (no Allee effects).</p>
<p>For a population model with a strong Allee effect. It has two stable
and one unstable equilibria point. The stable point is when population
size equals <span class="math inline">\(N=0\)</span> or carrying
capacity <span class="math inline">\(N=K\)</span>. The single unstable
equalibrium point lies at <span class="math inline">\(N=A\)</span>,
where <span class="math inline">\(A\)</span> is the critical population
size.</p>
<h3 id="illustration-of-current-application-1">Illustration of current
application</h3>
<p>Density-dependent condition and growth of invasive lionfish in the
northern Gulf of Mexico (Dahl et al., 2019). This research paper
discusses how increasing population density can affect invasive lionfish
size-at-age (growth) and population dynamics.</p>
<figure>
<img src="lionfish.jpg"
alt="© Bernard Dupont, Red lionfish, Creative Commons CC BY-SA 2.0 license" />
<figcaption aria-hidden="true">© Bernard Dupont, <a
href="https://commons.wikimedia.org/wiki/File:Red_Lionfish_%28Pterois_volitans%29_%288479302765%29.jpg">Red
lionfish</a>, <a
href="https://creativecommons.org/licenses/by-sa/2.0/deed.en">Creative
Commons CC BY-SA 2.0 license</a></figcaption>
</figure>
<h4 id="snapshot-of-the-study-1">Snapshot of the study</h4>
<ul>
<li><p>Indo-Pacific red lionfish (<em>Pterois volitans</em>) have
invaded the Gulf of Mexico over the past 30 years. Their invasion
success is likely due to a release of predation pressure in the novel
environment</p></li>
<li><p>Their invasion poses long-term threats to the native communities
by altering trophic structures through direct predation, and reducing
species richness</p></li>
<li><p>An exponential increase in lionfish density at both natural and
artificial reefs was observed beginning in 2010 through 2014, after
which mean lionfish density on both reef types reached an apparent peak.
Throughout the following years, the population number is fluctuating
around this peak value (check the plot below)</p></li>
<li><p>The growth of invasive lionfish appears to be density-dependent.
Lionfish inhabiting densely populated reefs exhibited smaller mean size
at age (slower growth)</p></li>
</ul>
<h4
id="calculating-the-population-growth-of-invasive-lionfish">Calculating
the population growth of invasive lionfish</h4>
<pre class="{r}"><code># First, let&#39;s create a data frame containing population counts as in Dahl et al. (2019):
lionfish &lt;- data.frame(year = c(2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017),
                    density_natural = c(0, 0.02, 0.15, 0.49, 0.57, 0.34, 0.43, 0.56),
                    density_artificial = c(0, 2, 8, 14.7, 32.98, 30.5, 20.45, 32.98))

# We can plot the population trajectories for both populations inhabiting natural and artificial reefs:
par(mfrow=c(1,2))

plot(lionfish$year, lionfish$density_natural, type=&quot;o&quot;,
     pch=16, lwd=1.5, bty=&quot;l&quot;, cex.lab=1.2, cex.main=0.8,
     main=&quot;(a)&quot;, 
     xlab=&quot;years&quot;, ylab=&quot;population size&quot;)

plot(lionfish$year, lionfish$density_artificial, type=&quot;o&quot;,
     pch=16, lwd=1.5, bty=&quot;l&quot;, cex.lab=1.2, cex.main=0.8,
     main=&quot;(b)&quot;, 
     xlab=&quot;years&quot;, ylab=&quot;population size&quot;)</code></pre>
<figure>
<img src="density-dependent_files/figure-html/unnamed-chunk-10-1.jpeg"
alt="Invasive lionfish mean density estimated from remotely operated vehicle video samples at northern Gulf of Mexico natural (a, n = 16) and artificial (b, n = 22) reef locations (Dahl et al., 2019)" />
<figcaption aria-hidden="true">Invasive lionfish mean density estimated
from remotely operated vehicle video samples at northern Gulf of Mexico
natural (a, n = 16) and artificial (b, n = 22) reef locations (Dahl et
al., 2019)</figcaption>
</figure>
<p>From both figures, we can see that the invasive lionfish population
increases exponentially during the first years (2011-2014). After
potentially reaching carrying capacity in 2014, it starts to fluctuate
around that peak value. If this trend continues, a density-dependent
logisitic growth curve will represent well the growth patterns for these
populations.</p>
<h4 id="takeaways-from-this-example">Takeaways from this example</h4>
<ul>
<li><p>The population growth of invasive lionfish in the Gulf of Mexico
is likely to be density-dependent. Population trends suggest that this
species may have already reached carrying capacity</p></li>
<li><p>Future studies should examine other potential density-dependent
demographic rates (e.g. movement, fecundity, mortality) in invasive
lionfish populations to capture the full extent of density-dependent
effects</p></li>
<li><p>Knowing the population dynamics for this species enables the
application of effective fish removal programs</p></li>
</ul>
<h3 id="references-1">References:</h3>
<p>Allee, W. C., &amp; Bowen, E. (1932). Studies in animal aggregations:
Mass protection against colloidal silver among goldfishes. <em>The
Journal of Experimental Zoology 61</em> (2), 185–207.
https://doi.org/10.1002/jez.1400610202.</p>
<p>Bohlin, T., Sundström, L., Johnsson, J., Höjesjö, J., &amp;
Pettersson, J. (2002). Density-dependent growth in brown trout: Effects
of introducing wild and hatchery fish. <em>Journal of Animal Ecology
71</em>(4), 683–92.
https://doi.org/10.1046/j.1365-2656.2002.00631.x.</p>
<p>Courchamp, F., Luděk, B., &amp; Gascoigne, J. (2008). <em>Allee
effects in ecology and conservation</em>. Oxford Biology. Oxford; Oxford
University Press.</p>
<p>Drake, J., &amp; Kramer, A. (2011). Allee effects. <em>Nature
Education Knowledge</em>.
https://www.nature.com/scitable/knowledge/library/allee-effects-19699394/.</p>
<p>Dahl, K. A., Edwards, M. A., &amp; Patterson III, W. F. (2019).
Density-dependent condition and growth of invasive lionfish in the
northern Gulf of Mexico. <em>Marine Ecology Progress Series</em>, 623,
145-159. https://doi.org/10.3354/meps13028.</p>
<p>May, Robert M. (1975). Biological populations obeying difference
equations: stable points, stable cycles, and chaos. <em>Journal of
Theoretical Biology 51</em>(2), 511–24.
https://doi.org/10.1016/0022-5193(75)90078-8.</p>
<p>Mills, L. S. (2013). <em>Conservation of wildlife populations:
demography, genetics, and management</em>. 2nd ed. Chichester, West
Sussex; Wiley-Blackwell.</p>
<p>Moreira-Saporiti, A., Bejarano, S., Viana, I., Belshe, E., Mtolera
M., &amp; Teichberg, M. (2021). Local victory: Assessing interspecific
competition in seagrass from a trait-based perspective. <em>Frontiers in
Plant Science 12</em>, 709257–57.
https://doi.org/10.3389/fpls.2021.709257.</p>
<p>Stevens, M., Henry H. (2009). <em>A primer of ecology with R. Use
R!</em> Dordrecht: Springer.</p>
<p>Zimmerman, John L. (1971). The territory and its density dependent
effect in <em>Spiza americana</em>. <em>The Auk 88</em>(3), 591–612.</p>
<h2 id="population-dynamics-and-stochasticity">Population dynamics and
stochasticity</h2>
<p>We have studied different population models in previous sections.
However, these models are still relatively “naive”, since population
change in the real world will never be constant. In this section, we
will add randomness, or stochasticity, to the population models.</p>
<h3 id="why-are-changes-in-population-variable">Why are changes in
population variable?</h3>
<ul>
<li><strong>Sample variance</strong> or <strong>observation
error</strong>: measurement error in estimates of population size or
density</li>
<li><strong>Process variance</strong>: variation acually affecting
numbers in count data over time
<ul>
<li><strong>Deterministic factors</strong>: predictable internal
drivers, such as density dependence, predation and competition.</li>
<li><strong>Stochastic factors</strong>: unpredictable random
fluctuations. Some fluctuations might in fact be driven by deterministic
factors (and thus might be predictable with more complete information),
but they can be more easily treated as stochastic factors.</li>
</ul></li>
</ul>
<h3 id="basic-forms-of-stochasticity">Basic forms of stochasticity</h3>
<p>There are two main forms of stochastic process variance: demographic
and environmental stochasticities.</p>
<p><strong>Demographic stochasticity</strong> refers to chance events of
individual mortality and reproduction, such as inevitable deviation in
mean birth and death rates (Lande et al., 2003). Demographic
stochasticity is only significant in small populations, and we will
explain this in three examples.</p>
<ul>
<li><p><em>Example 1</em>: Flipping a coin 10,000 times, one will get
approximately 5,000 times heads; flipping the same coin 100 times, there
could be some deviations from the expected 50:50; flipping the same coin
10 times, it is not suprising that one only gets 2 heads. The
probability of getting head is approaching 0.5 as the number of trials
increases.</p></li>
<li><p><em>Example 2</em>: The expected sex ratio for a newborn is
50:50. When there are 3 new births, we cannot have 50% males and 50%
females. Unbalanced sex ratio will influence future birth rate,
especially in a small population.</p></li>
<li><p><em>Example 3</em>: A death rate of 0.2 does not mean after a
year an animal is 0.8 alive–it either survives or dies. When the
population size is large, we may use the product of the total populatiom
and a mean birth/death rate to estimate the number of births/deaths.
However, such estimation is not accurate when the population size is
small (a difference of two deaths might not seem to be a big issue in a
population of size 1000, but will be significant in a population of size
20).</p></li>
</ul>
<p><strong>Environmental stochasticity</strong> often refers to temporal
fluctuations in the probability of mortality and reproduction (Lande et
al., 2003), which is often driven directly or indirectly by weather
(e.g. unpredictable catastrophes).</p>
<ul>
<li><em>Example 1</em>: Climate factors have a strong influence on the
ecology of red deer in Scotland (Albon et al., 1987). Real-world data
between 1971 and 1991 has shown that the changes in red deer population
size correlates strongly with annual rainfall (Benton et al., 1995)</li>
</ul>
<figure>
<img src="red_deer.jpeg"
alt="© Charles J. Sharp, Red deer (Cervus elaphus), Creative Commons CC-BY-SA-4.0 license" />
<figcaption aria-hidden="true">© Charles J. Sharp, <a
href="https://commons.wikimedia.org/wiki/File:Red_deer_(Cervus_elaphus)_young_stag.jpg">Red
deer (<em>Cervus elaphus</em>)</a>, <a
href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons
CC-BY-SA-4.0 license</a></figcaption>
</figure>
<ul>
<li><em>Example 2</em>: Cold-blooded insects like mosquitoes thrive in
hot and humid weather, which results in the seasonality of many
vector-borne diseases, such as malaria and dengue. There is massive
research on modelling the mosquito population dynamics and how they
affect the transmission of those diseases. For an example, refer to
Beck-Johnson et al. (2013)</li>
</ul>
<h3 id="implications-of-variation-in-population-growth">Implications of
variation in population growth</h3>
<ul>
<li><p>An obvious outcome is that future population size outcomes become
more uncertain and more variable</p></li>
<li><p>A less intuitive outcome is that the likelihood of any particular
population size at time <span class="math inline">\(t\)</span> in the
future becomes more skewed. Specifically, most populations being
relatively small, with a tiny fraction being huge. In fact, the realized
population growth rate <span
class="math inline">\((N_t/N_s)^{1/(t-s)}\)</span> will be smaller when
the growth rates vary. Why?</p></li>
</ul>
<p>To answer this question, we need to understand two important
concepts: arithmetic and geometric means.</p>
<h4 id="arithmetic-mean-vs.-geometric-mean">Arithmetic mean
vs. geometric mean</h4>
<p>Let <span class="math inline">\(\lambda_A\)</span> and <span
class="math inline">\(\lambda_G\)</span> denote the arithmetic and
geometric mean, respectively. We have the following definitions: <span
class="math display">\[\lambda_A=\frac{1}{k}\sum_{i=1}^k\lambda_i,\]</span>
<span
class="math display">\[\lambda_G=\left(\prod_{i=1}^k\lambda_i\right)^{\frac{1}{k}}.\]</span></p>
<ul>
<li><em>Example</em>: Consider <span
class="math inline">\(N_{t}=\lambda_tN_{t-1}\)</span>, where <span
class="math inline">\(N_t\)</span> is the population at time <span
class="math inline">\(t\)</span>, and during each time interval <span
class="math inline">\((t-1,t)\)</span> the growth rate is <span
class="math inline">\(\lambda_t\)</span>. Assume <span
class="math inline">\(\lambda_t=1.55\)</span> or <span
class="math inline">\(\lambda_t=0.55\)</span> with the same probability.
Assuming that the population grows at a constant arithmetic mean rate
<span class="math inline">\(\lambda_A=(1.55+0.55)/2=1.05\)</span>, the
population at <span class="math inline">\(t=16\)</span> is <span
class="math display">\[N_{16}=1.05^{16}N_0=2.18N_0.\]</span> Instead, if
we assume that the growth rate alternated between <span
class="math inline">\(1.55\)</span> and <span
class="math inline">\(0.55\)</span>, the population at <span
class="math inline">\(t=16\)</span> becomes <span
class="math display">\[N_{16}=1.55^8\times0.55^8N_0=[(1.55\times0.55)^{1/2}]^{16}N_0=0.28N_0,\]</span>
which indicates that the variation in population growth leads to a
likely decline for the population, even though the (arithmetic) average
growth rate is larger than 1 (Mills, 2007). In fact, the geometric mean
growth rate is <span
class="math inline">\(\lambda_G=(1.55\times0.55)^{1/2}\approx
0.9233\)</span>.</li>
</ul>
<h4 id="converting-between-lambda-and-r-1">Converting between <span
class="math inline">\(\lambda\)</span> and <span
class="math inline">\(r\)</span></h4>
<p>Recall that the natural logarithm of the growth rate, <span
class="math inline">\(r=\ln\lambda\)</span>. It would be helpful to know
the conversion between the arithmetic mean of <span
class="math inline">\(r\)</span> and the geometric mean of <span
class="math inline">\(\lambda\)</span>. Note that <span
class="math display">\[\ln(\lambda_1\lambda_2\cdots\lambda_k)=\ln\lambda_1+\ln\lambda_2+\cdots+\ln\lambda_k=r_1+r_2+\cdots+r_k,\]</span>
which gives <span
class="math display">\[\ln(\lambda_1\lambda_2\cdots\lambda_k)^{1/k}=\frac{1}{k}\ln(\lambda_1\lambda_2\cdots\lambda_k)=\frac{1}{k}(r_1+r_2+\cdots+r_k),\]</span>
and thus <span class="math display">\[\ln\lambda_G=r_A.\]</span></p>
<p>Remember we mentioned earlier that highly variable growth rates will
more likely result in a smaller final population? Now we have the
knowledge to show this! Let <span
class="math inline">\(\lambda_t=\lambda_A+\epsilon_t\)</span>, where
<span class="math inline">\(\epsilon_t\)</span> is the deviation of
<span class="math inline">\(\lambda_t\)</span> from the arithmetic mean
<span class="math inline">\(\lambda_A\)</span> with zero mean. Using the
Taylor expansion of <span class="math inline">\(\ln(1+x)\)</span>, one
could obtain <span class="math display">\[\begin{aligned}\ln\lambda_t
&amp; =\ln\lambda_A+\ln(1+\epsilon_t/\lambda_A)\\~ &amp; =\ln\lambda_A+
        \epsilon_t/\lambda_A-(\epsilon_t/\lambda_A)^2/2+O(\epsilon_t^3),\end{aligned}\]</span>
where <span class="math inline">\(O(\epsilon_t^3)\)</span> denotes the
higher order terms. Hence, taking the expectation of both sides gives
<span
class="math display">\[r_A=E(\ln\lambda_t)\cong\ln\lambda_A-\frac{E[(\lambda_t-\lambda_A)^2]}{2\lambda_A^2}=\ln\lambda_A-\frac{\sigma_\lambda^2}{2\lambda_A^2},\]</span>
which further gives <span
class="math display">\[\lambda_G\cong\exp\left(\ln\lambda_A-\frac{\sigma_\lambda^2}{2\lambda_A^2}\right).\]</span>
As we can see, when the variance of growth rates <span
class="math inline">\(\sigma_\lambda^2\)</span> gets larger, geometric
mean growth rate <span class="math inline">\(\lambda_G\)</span> gets
smaller. In fact, the geometric mean is <strong>never larger</strong>
than the arithmetic mean (and they are equal if and only if every term
is the same).</p>
<h4 id="temporal-autocorrelation">Temporal autocorrelation</h4>
<p>The examples above assume that <span
class="math inline">\(r_t\)</span> does not depend on previous growth
rates, nor will it influence subsequent growth rates. This assumption
may not be very realistic. Here we introduce the idea of temporal
autocorrelation, which describes the relationship between <span
class="math inline">\(r_t\)</span> and <span
class="math inline">\(r_{t+\tau}\)</span>, its value at a time lag <span
class="math inline">\(\tau\)</span>. One way to incorporate temporal
autocorrelation is to: <span
class="math display">\[r_{t+\tau}=r_A+\rho(r_{t}-r_A)+\epsilon_{t+\tau},\]</span>
where <span class="math inline">\(\rho\)</span> is the coefficient of
lag-<span class="math inline">\(\tau\)</span> autocorrelation, and <span
class="math inline">\(\epsilon_t\sim N(0,\sigma_\epsilon^2)\)</span> is
white noise with zero mean and constant variance. An example would be
the case <span class="math inline">\(\tau=1\)</span> (lag-1
autocorrelation), where <span
class="math inline">\(r_{t+1}=r_A+\rho(r_t-r_A)+\epsilon_{t+1}\)</span>.
When <span class="math inline">\(\rho=0\)</span>, <span
class="math inline">\(r_{t+1}=r_A+\epsilon_{t+1}\)</span> and there is
no temporal autocorrelation. Here we present examples of exponential
growth rates with zero autocorrelation and positive lag-1
autocorrelation.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We assume that the mean exponential growth rate r_A = 0.3,</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and the noise term epsilon_t is a standard normal random variable,</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We look at a time period of 20 years</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>rA <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">zero =</span> rA <span class="sc">+</span> e)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate exponential growth rates with positive lag-1 autocorrelation</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We compare different coefficients rho = 0.2, 0.5, 0.8</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>pos1 <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">20</span>, rA <span class="sc">+</span> e[<span class="dv">1</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  pos1[i] <span class="ot">&lt;-</span> r[i,<span class="st">&#39;zero&#39;</span>] <span class="sc">+</span> <span class="fl">0.2</span><span class="sc">*</span>(pos1[i<span class="dv">-1</span>] <span class="sc">-</span> rA)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>pos1 <span class="ot">&lt;-</span> pos1</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>pos2 <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">20</span>, rA <span class="sc">+</span> e[<span class="dv">1</span>])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  pos2[i] <span class="ot">&lt;-</span> r[i,<span class="st">&#39;zero&#39;</span>] <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>(pos2[i<span class="dv">-1</span>] <span class="sc">-</span> rA)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>pos2 <span class="ot">&lt;-</span> pos2</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>pos3 <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">20</span>, rA <span class="sc">+</span> e[<span class="dv">1</span>])</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  pos3[i] <span class="ot">&lt;-</span> r[i,<span class="st">&#39;zero&#39;</span>] <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>(pos3[i<span class="dv">-1</span>] <span class="sc">-</span> rA)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>r<span class="sc">$</span>pos3 <span class="ot">&lt;-</span> pos3</span></code></pre></div>
<p><img src="autocorrelation.jpeg" /></p>
<h3
id="estimating-population-growth-rates-in-the-presence-of-processobservation-error">Estimating
population growth rates in the presence of process/observation
error</h3>
<p>Now we move on to an important section, where we try to estimate the
growth rate from data, assuming some very simple models. But first,
let’s talk about different types of errors we might encounter.</p>
<p><strong>Process error</strong> results from variation in true
population size due to biotic or abiotic processes (Ahrestani <em>et
al</em>., 2013). Environmental and demographic stochasticities are
examples of process errors.</p>
<p>When only process error exists, the population at each time <span
class="math inline">\(t\)</span>, <span
class="math inline">\(N_t\)</span>, is known and accurate. The growth
rate <span class="math inline">\(\lambda_t\)</span> is a random
variable. For example, a geometric model with only process error can be
described as <span class="math display">\[\begin{aligned}N_{t+1} &amp;
=\lambda_tN_t,\\\lambda_t &amp; \sim
N(\bar\lambda,\sigma_p^2),\end{aligned}\]</span> where <span
class="math inline">\(\lambda_t\)</span> follows a normal distribution
with mean <span class="math inline">\(\bar\lambda\)</span> and variance
<span class="math inline">\(\sigma_p^2\)</span>.</p>
<p>Since the population at each time <span
class="math inline">\(t\)</span>, <span
class="math inline">\(N_t\)</span>, is known and accurate, we can
calculate the estimated growth rate using geometric mean <span
class="math display">\[\hat\lambda=\left(\prod_{i=1}^t\frac{N_{i}}{N_{i-1}}\right)^{\frac{1}{t}},\]</span>
or equivalently, <span class="math display">\[\hat
r=\frac{1}{t}\sum_{i=1}^t\ln\frac{N_i}{N_{i-1}}.\]</span></p>
<p>We can notice that the estimated growth rate is only related to the
initial and the final population size, as all the terms between them can
be cancelled out. In other words, <span
class="math display">\[\hat\lambda=\left(\frac{N_t}{N_0}\right)^{\frac{1}{t}}\]</span>
and <span class="math display">\[\hat r=\frac{\ln N_t-\ln
N_0}{t}.\]</span></p>
<p>Here is a toy example: suppose we observe the following number of
fish in a lake during the first 8 years. Assuming a geometric model,
what is the average growth rate?</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">98</span>, <span class="dv">152</span>, <span class="dv">298</span>, <span class="dv">302</span>, <span class="dv">383</span>, <span class="dv">575</span>, <span class="dv">728</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate annual growth rates</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">8</span>, <span class="dv">0</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  lambda[i] <span class="ot">&lt;-</span> N[i<span class="sc">+</span><span class="dv">1</span>,<span class="st">&#39;size&#39;</span>]<span class="sc">/</span>N[i,<span class="st">&#39;size&#39;</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the geometric mean growth rate</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>lambda_avg <span class="ot">&lt;-</span> <span class="fu">prod</span>(lambda)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The average growth rate is 1.2816, which is the same as (728/100)^(1/8)</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the theoretical population size, assuming geometric growth</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>N<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>lambda_avg<span class="sc">^</span>N<span class="sc">$</span>year</span></code></pre></div>
<p><img src="process_error_example.jpeg" /></p>
<p><strong>Observation error</strong>, or as we mentioned earlier,
sample variation, results from variation in the methodology used to
obtain the population size (Ahrestani <em>et al</em>., 2013).</p>
<p>When only observation error exists, the growth rate is accurate. A
possible geometric model with only observation error can be described as
<span class="math display">\[\begin{aligned}\ln N_t &amp; =\ln
N_0+rt+\eta_t,\\\eta_t &amp; \sim N(0,\sigma_o^2),\end{aligned}\]</span>
where <span class="math inline">\(\eta_t\)</span> follows a normal
distribution with mean 0 and variance <span
class="math inline">\(\sigma_o^2\)</span>. Here we ignore the subscript
of <span class="math inline">\(r\)</span> as we assume the growth rate
is some constant. We could also convert the above equation to <span
class="math display">\[N_{t+1}=\lambda^tN_te^{\eta_t},\]</span> where
<span class="math inline">\(e^{\eta_t}&gt;0\)</span> so that the
population is always non-negative.</p>
<p>The equation <span class="math inline">\(\ln N_t=\ln
N_0+rt+\eta_t\)</span> is in the form of a linear model in which <span
class="math inline">\(\ln N_t\)</span> is the response variable and
<span class="math inline">\(t\)</span> is the predictor variable. Using
a simple linear regression, the slope of the fitted function is the
estimated <span class="math inline">\(r\)</span>. Moreover, the <span
class="math inline">\(y\)</span>-intercept is the estimated <span
class="math inline">\(\ln N_0\)</span>. Here we provide another toy
example with the same data as the previous example on process error:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe, and calculate the log-transformed population sizes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">98</span>, <span class="dv">152</span>, <span class="dv">298</span>, <span class="dv">302</span>, <span class="dv">383</span>, <span class="dv">575</span>, <span class="dv">728</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>N<span class="sc">$</span>log <span class="ot">&lt;-</span> <span class="fu">log</span>(N<span class="sc">$</span>size)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a linear regression with log-transformed population sizes as response variables</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and year as predictor variables</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log<span class="sc">~</span>year, <span class="at">data =</span> N)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># After running the regression, we obtain the following coefficients:</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (Intercept) 4.40771</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># year        0.26756</span></span></code></pre></div>
<p><img src="observation_error_example.jpeg" /></p>
<h3 id="references-2">References</h3>
<p>Ahrestani, F., Hebblewhite, M. and Post, E. (2013). The importance of
observation versus process error in analyses of global ungulate
populations. <em>Sci Rep 3</em>, 3125.</p>
<p>Albon, S. D., Clutton-Brock, T. H. and Guinness, F. E. (1987). Early
development and population dynamics in red deer. II. Density-independent
effects and cohort variation, <em>J. Anim. Ecol. 56</em>, 69-81.</p>
<p>Beck-Johnson, L. M., Nelson, W. A., Paaijmans, K. P., Read, A. F.,
Thomas, M. B. and Bjonstad, O. N. (2013). The effect of temperature on
<em>Anopheles mosquito</em> population dynamics and the potential for
malaria transmission. <em>PLoS ONE 8</em>(11), e79276.</p>
<p>Benton, T. G., Grant, A. and Clutton-Brock, T. H. (1995). Does
environmental stochasticity matter? Analysis of red deer life-histories
on Rum, <em>Evolutionary Ecology 9</em>, 559-574.</p>
<p>Beverton, R. and Holt, S. J. (1957). <em>On the dynamics of exploited
fish populations</em>. Ministry of Agriculture, Fisheries and Food,
London, UK.</p>
<p>Case, T. (2000). <em>An illustrated guide to theoretical
ecology</em>, Oxford University Press.</p>
<p>Humbert, J.-Y., Mills, L.S., Horne, J.S. and Dennis, B. (2009) A
better way to estimate population trend. <em>Oikos</em>,
<strong>118</strong>:1487–1498.</p>
<p>Lande, R., Engen, S. and Saether, B. (2003). <em>Stochastic
population dynamics in ecology and conservation</em>. Oxford Series in
Ecology and Evolution.</p>
<p>Mills, L. S. (2012) <em>Conservation of wildlife populations:
Demography, genetics, and management</em>, Wiley-Blackwell
Publishing.</p>
<p>Stetz, J. B., Kendall, K. C. and Servheen, C. (2010) Evaluation of
Bear Rub Surveys to Monitor Grizzly Bear Population Trends. <em>Journal
of Wildlife Management 74</em>(4), 860–870.</p>
<h2
id="model-selection-how-do-we-tell-which-model-to-use-for-our-data">Model
Selection: How do we tell which model to use for our data?</h2>
<p>We have introduced several models to describe how population size may
change over time. If we have several candidate models and no <em>a
priori</em> reason to assume one is better than the others, we can use
population data to determine which model is best. For example, you may
have reason to believe your population has density-dependent growth
rates, but we introduced a couple of density-dependent models, which one
should we choose?</p>
<figure>
<img src="densdepfunc.png" style="width:80.0%"
alt="Examples of functions that describe the effects of different types density dependence on per capita growth rates" />
<figcaption aria-hidden="true">Examples of functions that describe the
effects of different types density dependence on per capita growth
rates</figcaption>
</figure>
<h4 id="example-model-selection-with-the-bay-checkerspot-data">Example:
Model selection with the Bay Checkerspot data</h4>
<p>Let’s use some data from Harrison’s (1991) famous paper testing
whether there were multiple populations or a single population of the
Bay Checkerspot butterfly.</p>
<figure>
<img src="630px-Bay_Checkerspot_f2.jpg" style="width:50.0%"
alt="Wikipedia Commons CC BY-SA 3.0" />
<figcaption aria-hidden="true">Wikipedia Commons <a
href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA
3.0</a></figcaption>
</figure>
<p>In order to test her hypotheses, Dr. Harrison used 20 years of mark
recapture data that was used to estimate the number of female
butterflies in each year.</p>
<figure>
<img src="baycheckertime.jpeg"
alt="Estimated number of female Bay Checkerspot butterflies from mark recapture data (data from Harrison at al. 1991)" />
<figcaption aria-hidden="true">Estimated number of female Bay
Checkerspot butterflies from mark recapture data (data from Harrison at
al. 1991)</figcaption>
</figure>
<p>We can use this data to calculate the annual population growth rate
<span class="math inline">\(\lambda\)</span> as <span
class="math inline">\(N_{t+1}/N_{t}\)</span>. If we use least squares
regression to predict the natural logarithm of estimated annual growth
rates from the number of females, we find some indication there is a
negative slope, even if we remove a large outlier.</p>
<figure>
<img src="negdenschecker.jpeg" style="width:70.0%"
alt="Fitting least squares linear regression to per capita growth rates" />
<figcaption aria-hidden="true">Fitting least squares linear regression
to per capita growth rates</figcaption>
</figure>
<table>
<caption>Least squares regression of <span class="math inline">\(ln
\lambda = intercept - slope*females\)</span></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 15%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;"><span class="math inline">\(Pr(&gt;\lvert
t \rvert)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">slope</td>
<td style="text-align: right;">-0.00076</td>
<td style="text-align: right;">0.00038</td>
<td style="text-align: right;">-2.00</td>
<td style="text-align: right;">0.057</td>
</tr>
</tbody>
</table>
<p>While the results seem suggestive, it is important to realize what
this regression does and does not do. The linear regression is a test of
the hypothesis that the slope is equal to zero. That is we are testing
the null hypothesis that there is no effect of population size on the
per capita growth rate. This null hypothesis actually corresponds to
<em>one</em> candidate model: geometric population growth, where <span
class="math inline">\(\lambda\)</span> does not change from year to
year. Our p-value is very close to a threshold p-value of 0.05, but is
in fact larger than that value, so we cannot reject this null
hypothesis. Moreover, we need to remember that even if we did reject
this null hypothesis, that does not mean that we accept one of the other
models! For example, a significant linear regression would not tell us
if we should use a logistic or theta-logistic model.</p>
<h3 id="likelihood">Likelihood</h3>
<p>In order to determine which model best fits our data, instead of
using null hypothesis testing, we need to compare the performance of
several different models. That is, we need to look at the problem in the
opposite direction. Since we have the data, we need to ask the question
of how likely is it that each one of our models could have generated
this data. To answer this question we will use
<strong>likelihood</strong>.</p>
<p>We use the word <em>likely</em> all the time in english, but our use
in casual conversation normally differs a from the formal usage we will
employ here. While you may tell a friend that it is <em>likely</em> you
will take advantage of a once in a lifetime opportunity to attend a
local concert by your favorite band, that statement is not supported by
data. Your statement refers to a prediction about the future. In
contrast, our use here will refer to how well our model fits data from
the past.</p>
<p><strong>Likelihood</strong> is the probability of obtaining the
observed data if a particular model was a good description of the
underlying processes. We can write this as:</p>
<p><span class="math display">\[L (model|data), \]</span></p>
<p>which is read as the “likelihood of the model given the collected
data” (see Edwards, 1974).</p>
<h4 id="probability-and-likelihood">Probability and Likelihood</h4>
<p>The likelihood of a given model is proportional to the probability of
obtaining the data given the model. <span class="math display">\[L
(model|data) = c * P(data|model), \]</span> but is not itself a
probability. As you can see, multiplying a probability by a constant
means that likelihood can be greater than one. In fact, it doesn’t
matter greatly what the value of this constant might be. Since we are
using likelihood to compare models, and so the constant will cancel
out.</p>
<p>Our main challenge is to calculate the probability, however, if we
can assume that each data point is independent, this calculation is
straightforward, for each data point <span
class="math inline">\(x_i\)</span> in a vector of data, X, we can find
the probability given the model. To get the total probability, we can
then just multiply the probability of each one of these data points. So
we have:</p>
<p><span class="math display">\[L(model|X)=P(X|model)=\prod
g(x_i|model),\]</span></p>
<p>where <span class="math inline">\(g(x_i|model)\)</span> is the
appropriate probability density function.</p>
<h4
id="example-use-likelihood-to-find-mean-and-variance-of-data">Example:
use likelihood to find mean and variance of data</h4>
<p>Let’s try this out for a simple problem. We have been given a set of
data, and we wish to determine if the data came from a normal
distribution with a given mean (5) and variance (4). In this case then,
our model is simply the normal distribution. We assume independent
observations, so likelihood is the product of their individual
probabilities as given by the probability density function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the probability density function of the normal </span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution for a given mean and variance</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># is given by **dnorm()**</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>like1<span class="ot">=</span><span class="fu">prod</span>(<span class="fu">dnorm</span>(X,<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code> &gt; like1
[1] 3.133277e-10</code></pre>
<p>Of course, the value we calculate is not very informative, we need to
compare it to another explanation of the data. For example, what if the
data came from a normal distribution with a different mean?</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the mean of the normal distribution to 6</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>like2<span class="ot">=</span><span class="fu">prod</span>(<span class="fu">dnorm</span>(X,<span class="at">mean=</span><span class="dv">6</span>,<span class="at">sd=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>&gt; like2
[1] 1.072149e-11</code></pre>
<p>We see that a mean of 6 is less likely than a mean of 5.</p>
<p>Note: because likelihoods are often very small numbers, we usually
use the logarithm of the likelihood or <em>log-likelihood</em> to
compare between models. Since we are taking the log of the probability
to calculate this quantity, we can use the sum of these quantities
rather than the product, which is a bit easier. More importantly, using
the log gives us larger numbers that are less likely to result in
computer rounding errors.</p>
<p>Log-likelihood <span class="math display">\[ln[ \, L(model|X) ]
\,=\sum ln [ \,g(x_i|model) ] \,\]</span></p>
<p>We still get the same answer though!</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>) </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>like1<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(X,<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>,<span class="at">log=</span>T))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>like2<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(X,<span class="at">mean=</span><span class="dv">6</span>,<span class="at">sd=</span><span class="dv">2</span>,<span class="at">log=</span>T))</span></code></pre></div>
<pre><code>    &gt; like1
[1] -21.88377
&gt; like2
[1] -25.25877</code></pre>
<p>A mean of 5 is the most likely.</p>
<h4 id="maximum-likelihood-estimate-mle">Maximum likelihood estimate
(MLE)</h4>
<p>Of course, a mean of 5 and 6 aren’t the only possibilities, Let’s
look at a range of potential values for the mean.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#varying the mean</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>means <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>mean.likes <span class="ot">=</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(means,<span class="cf">function</span>(y) <span class="fu">sum</span>(<span class="fu">dnorm</span>(<span class="at">x=</span>X,m</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span>y,<span class="at">sd=</span><span class="dv">2</span>, <span class="at">log=</span>T)))</span></code></pre></div>
<figure>
<img src="maxlikemean.jpeg" style="width:50.0%"
alt="Likelihood of the model of a normal distribution with sd=2 and a range of means" />
<figcaption aria-hidden="true">Likelihood of the model of a normal
distribution with sd=2 and a range of means</figcaption>
</figure>
<p>We can see that there is a value for the mean which is more likely
than the other candidates. This value of the mean parameter for the
normal distribution is our <em>maximum likelihood estimate</em>. This is
the likelihood for which we have chosen parameter(s) values that make
the likelihood of our model as large as possible.</p>
<p>So, we can see that we probably need to be a bit more specific when
we talk about likelihood of a model, since that value is going to change
depending on the values of the parameters in the model. So, we will
calculate the likelihood for given a particular set of parameter values
(q) for a particular model (Edwards, 1974) <span
class="math display">\[L(q|data,model),\]</span> which is read as the
“likelihood of the parameter values q given the collected data and
specified model”.</p>
<p>Most models have more than one parameter, and in fact our simple
example of the normal distribution has two: mean and variance. So the
maximum likelihood for this model would be at the best values for both
mean and variance.</p>
<p>We can vary both of these, and output the results as a likelihood
surface. Notice that we have ploted the negative of the log-likelihood.
As a result the lowest values of the surface give us the parameter
values for which we have the maximum likelihood of the normal
distribution. In this case, we think <span class="math inline">\(\mu
\approx 4, \sigma \approx 2.5\)</span>.</p>
<figure>
<img src="likesurf.jpeg" style="width:60.0%" alt="Likelihood surface" />
<figcaption aria-hidden="true">Likelihood surface</figcaption>
</figure>
<h4
id="finding-the-maximum-likelihood-is-an-optimization-problem">Finding
the maximum likelihood is an optimization problem</h4>
<p>The reason for using the <em>negative</em> of the log likelihood is
all about convenience. We don’t want to have to plot out likelihood
surfaces for every problem, and in fact, it will be tricky to do for
models with more than two parameters! Instead we normally use <a
href="https://www.quantitative-biology.ca/optimization.html">optimization</a>
routines to find the best values. Finding the parameter values where we
have the minimum of a function is a standard problem for optimization.
For example, here I use a built-in optimization function in R in order
to find the best mean and variance for our data.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>) </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>normL <span class="ot">=</span> <span class="cf">function</span>(par) {</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(X, <span class="at">mean=</span>par[<span class="dv">1</span>],<span class="at">sd=</span>par[<span class="dv">2</span>],<span class="at">log=</span>T))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>mlest<span class="ot">=</span><span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),normL) </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#par argument is the starting search values for par[1], </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># and par[2], so our function is the same as before, </span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># just written in a way that we can use it with optim()</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>mlest<span class="sc">$</span>par</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>mlest<span class="sc">$</span>value</span></code></pre></div>
<p>We can see that the <strong>optim()</strong> function gives a bit
more precision, and tells us that the maximum likelihood (minimum
negative log-likelihood) is found for parameter values of <span
class="math inline">\(\mu\)</span> = 4.0, <span
class="math inline">\(\sigma\)</span> = 2.4.</p>
<h3 id="model-comparison">Model comparison</h3>
<p>Let’s go back to our original problem with the Harrison data (1991),
and use maximum likelihood to find the best parameter values for each
model, and then compare their likelihood.</p>
<p>Just like we did for find the mean and variance of a set of data, we
can find the slope and intercept of a linear regression model, this
time, by setting the expected value of each observation using the
equation for a line, with normally distributed errors, where our x is
the number of female Bay Checkerspot butterflies, and y is the per
capita growth rate.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>percap<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.229</span>,<span class="fl">1.125</span>,<span class="fl">3.889</span>,<span class="fl">1.143</span>,<span class="fl">2.125</span>,<span class="fl">1.000</span>,<span class="fl">1.882</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.320</span>,<span class="fl">2.785</span>,<span class="fl">0.278</span>,<span class="fl">9.187</span>,<span class="fl">0.316</span>,<span class="fl">0.986</span>,<span class="fl">3.208</span>,<span class="fl">3.973</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.254</span>,<span class="fl">1.130</span>,<span class="fl">1.094</span>,<span class="fl">6.566</span>,<span class="fl">0.570</span>,<span class="fl">1.790</span>,<span class="fl">0.080</span>,<span class="fl">0.552</span>,<span class="fl">1.190</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>females<span class="ot">=</span><span class="fu">c</span>(<span class="dv">175</span>,<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">175</span>,<span class="dv">200</span>,<span class="dv">425</span>,<span class="dv">425</span>,<span class="dv">800</span>,<span class="dv">256</span>,<span class="dv">713</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">198</span>,<span class="dv">1819</span>,<span class="dv">575</span>,<span class="dv">567</span>,<span class="dv">1819</span>,<span class="dv">852</span>,<span class="dv">216</span>,<span class="dv">244</span>,<span class="dv">267</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1753</span>,<span class="dv">999</span>,<span class="dv">1788</span>,<span class="dv">143</span>,<span class="dv">79</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>normReg <span class="ot">=</span> <span class="cf">function</span>(par) {</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>          y.pred <span class="ot">=</span> par[<span class="dv">1</span>] <span class="sc">+</span> par[<span class="dv">2</span>]<span class="sc">*</span>females</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(<span class="fu">log</span>(percap),<span class="at">mean=</span>y.pred,<span class="at">sd=</span><span class="fu">sqrt</span>(par[<span class="dv">3</span>]),<span class="at">log=</span>T)) }</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>mlest<span class="ot">=</span><span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">1</span>),normReg) </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">#par argument is the starting search values for par[1:3] </span></span></code></pre></div>
<pre><code>&gt; mlest$par[1:2]
[1]  0.5244783529 -0.0007595998</code></pre>
<p>Reassuringly, we find that our estimates intercept (par[1]) and slope
(par[2]) are similar to those that we found earlier using least squares
regression. In fact, when we have normally distributed errors, maximum
likelihood and least square regression estimates for simple linear
regression will be the same.</p>
<p>We complete the same exercise for three of candidate models and plot
out our results:</p>
<p>Density independent model: <span
class="math inline">\(log(N_{t+1}/N_t)=r\)</span></p>
<p>Logistic model: <span
class="math inline">\(log(N_{t+1}/N_t)=r(1-N_t/K)\)</span></p>
<p>Theta logistic model: <span
class="math inline">\(log(N_{t+1}/N_t)=r(1-(N_t/K)^\theta)\)</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>percap<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.229</span>,<span class="fl">1.125</span>, <span class="fl">3.889</span>,<span class="fl">1.143</span>,<span class="fl">2.125</span>, <span class="fl">1.000</span>,<span class="fl">1.882</span>,<span class="fl">0.320</span>,<span class="fl">2.785</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.278</span>,<span class="fl">9.187</span>,<span class="fl">0.316</span>,<span class="fl">0.986</span>,<span class="fl">3.208</span>,<span class="fl">3.973</span>,<span class="fl">0.254</span>,<span class="fl">1.130</span>,<span class="fl">1.094</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>         <span class="fl">6.566</span>, <span class="fl">0.570</span>, <span class="fl">1.790</span>,<span class="fl">0.080</span>,<span class="fl">0.552</span>,<span class="fl">1.190</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>females<span class="ot">=</span><span class="fu">c</span>(<span class="dv">175</span>,<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">175</span>,<span class="dv">200</span>,<span class="dv">425</span>,<span class="dv">425</span>,<span class="dv">800</span>,<span class="dv">256</span>,<span class="dv">713</span>,<span class="dv">198</span>,<span class="dv">1819</span>,<span class="dv">575</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">567</span>,<span class="dv">1819</span>,<span class="dv">852</span>,  <span class="dv">216</span>,<span class="dv">244</span>,<span class="dv">267</span>,<span class="dv">1753</span>,<span class="dv">999</span>,<span class="dv">1788</span>,<span class="dv">143</span>,<span class="dv">79</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># function for logistic model with normally distributed errors</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>normReg <span class="ot">=</span> <span class="cf">function</span>(par) {</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>          y.pred <span class="ot">=</span> par[<span class="dv">1</span>] <span class="sc">+</span> par[<span class="dv">2</span>]<span class="sc">*</span>females</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(<span class="fu">log</span>(percap),<span class="at">mean=</span>y.pred,<span class="at">sd=</span><span class="fu">sqrt</span>(par[<span class="dv">3</span>]),<span class="at">log=</span>T)) }</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>mle.normReg<span class="ot">=</span><span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">1</span>),normReg) </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">#par argument is the starting search values</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data and model predictions at mle</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(percap)<span class="sc">~</span>females, <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">bty=</span><span class="st">&quot;l&quot;</span>, </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span><span class="fl">1.2</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="fu">expression</span>(ln<span class="sc">~</span>lambda),<span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;number of females&quot;</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span>mle.normReg<span class="sc">$</span>par[<span class="dv">1</span>], <span class="at">b=</span>mle.normReg<span class="sc">$</span>par[<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co"># function for density independent model</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>normDI <span class="ot">=</span> <span class="cf">function</span>(par) {</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(<span class="fu">log</span>(percap),<span class="at">mean=</span><span class="fu">mean</span>(<span class="fu">log</span>(percap)),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sd=</span><span class="fu">sqrt</span>(par[<span class="dv">2</span>]),<span class="at">log=</span>T)) }</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>mle.normDI<span class="ot">=</span><span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">1</span>),normC) </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co">#par argument is the starting search values </span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plot predictions</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>mle.normDI<span class="sc">$</span>par[<span class="dv">1</span>],<span class="at">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co"># function for theta-logistic model</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>normTh <span class="ot">=</span> <span class="cf">function</span>(par) {</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>          y.pred <span class="ot">=</span> par[<span class="dv">1</span>] <span class="sc">+</span> par[<span class="dv">2</span>]<span class="sc">*</span>(females)<span class="sc">^</span>par[<span class="dv">4</span>]</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(<span class="fu">log</span>(percap),<span class="at">mean=</span>y.pred,<span class="at">sd=</span><span class="fu">sqrt</span>(par[<span class="dv">3</span>]),<span class="at">log=</span>T)) }</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>mle.normTh<span class="ot">=</span><span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>,<span class="dv">1</span>,<span class="dv">1</span>),normTh) </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co">#par argument is the starting search values </span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plot predictions and legend</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(mle.normTh<span class="sc">$</span>par[<span class="dv">1</span>]<span class="sc">+</span>mle.normTh<span class="sc">$</span>par[<span class="dv">2</span>]<span class="sc">*</span>(x)<span class="sc">^</span>mle.normTh<span class="sc">$</span>par[<span class="dv">4</span>], <span class="at">from=</span><span class="dv">0</span>, </span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">to=</span><span class="dv">4000</span>,<span class="at">add=</span>T, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;exponential&quot;</span>, <span class="st">&quot;logistic&quot;</span>,<span class="st">&quot;theta-logistic&quot;</span> ),</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<figure>
<img src="3modelfits.jpeg" style="width:80.0%"
alt="Fits of the three different models to data from Harrison, 1991" />
<figcaption aria-hidden="true">Fits of the three different models to
data from Harrison, 1991</figcaption>
</figure>
<p>For each model, we have an estimate of likelihood (e.g,</p>
<pre><code>&gt; mle.normReg$value
[1] 35.22501</code></pre>
<p>and we can compare these, to see that the lowest negative
log-likelihood is found for the theta-logistic.</p>
<table>
<caption>Negative log-likelihood values for three candidate population
models applied to Harrison’s (1991) Bay Checkerspot data</caption>
<thead>
<tr class="header">
<th>model</th>
<th># parameters</th>
<th>- ln <span class="math inline">\(L_{max}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exponential</td>
<td>2</td>
<td>37.237</td>
</tr>
<tr class="even">
<td>logistic</td>
<td>3</td>
<td>35.225</td>
</tr>
<tr class="odd">
<td>theta-logistic</td>
<td>4</td>
<td>35.174</td>
</tr>
</tbody>
</table>
<p>So perhaps we should select the theta-logistic model? After all it
<strong>does</strong> have the greatest likelihood. However, there is
another point to consider. The theta-logistic model has four parameters
(r, k, <span class="math inline">\(\theta\)</span>, and <span
class="math inline">\(\sigma\)</span>, the variance of the normal
distribution of errors), while the logistic model has 3. We note that if
a model has n data points and n parameters (one for each data point),
then the residual variance will be ZERO. Would a model with n parameters
then be a better model, since it explains all the variance?</p>
<p>More generally, is a model with more parameters, functions, entities,
etc. more likely to be “true”? Where we use the word “true” as more
explanatory, accurate, predictive, representative of reality?</p>
<h4 id="overfitting">Overfitting</h4>
<p>We have a conundrum here. If we use goodness of fit as our only
criteria for model selection, then we will always choose the most
complex model. Unfortunately, really complex and flexible models are
more likely to be misled by errors and noise. For example, compare the
fit of a highly flexible curve with a linear fit. The flexible curve
fits every point, but some of this variance is just noise or error.</p>
<figure>
<img src="Overfitted_Data.png" style="width:60.0%"
alt="Overfitting example where the more flexible curve explains every point (Ghiles) Creative Commons CC BY-NC-SA 4.0 license, via Wikimedia Commons" />
<figcaption aria-hidden="true">Overfitting example where the more
flexible curve explains every point (Ghiles) <a
href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative
Commons CC BY-NC-SA 4.0 license</a>, via Wikimedia Commons</figcaption>
</figure>
<h4 id="parsimony">Parsimony</h4>
<p>In order to avoid overfitting data, the principle of parsimony is
often used to select between models. This idea has been expressed by
many philosophers, perhaps the most famous statement:</p>
<blockquote>
<p>“Do not multiply entities without necessity.” -William of Ockham</p>
</blockquote>
<p>expresses the concept best. We should choose the the model with the
fewest assumptions. For example, given a unique colour trait found in
two different bird species, if they were closely related it would make
more sense to assume that the trait had evolved once rather than twice
(see Figure below)</p>
<figure>
<img src="69126_evo_resources_resource_image_36_original.gif"
style="width:60.0%"
alt="© University of California Museum of Paleontology, Understanding Science, www.understandingscience.org Creative Commons CC BY-NC-SA 4.0 license." />
<figcaption aria-hidden="true">© University of California Museum of
Paleontology, Understanding Science, <a
href="https://undsci.berkeley.edu/">www.understandingscience.org</a> <a
href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative
Commons CC BY-NC-SA 4.0 license</a>.</figcaption>
</figure>
<h4 id="model-selection-using-parsimony">Model selection using
parsimony</h4>
<p>To incorporate the idea of parsimony in our model selection, we will
use Information criterion statistics. These statistics combine the
maximum log likelihood for a model with the number of parameters, as a
measure of the complexity of the model. Then we can compare the
statistics for various candidate models. We use these statistics to
decide if a given model has more “support” than another.</p>
<p>Support is higher for models with higher likelihoods, and models with
fewer parameters. More complex models are penalized because more
parameters will always lead to a better fit to the data, but at the cost
of less precision in the estimate of each parameter and incorporation of
spurious patterns from the data.</p>
<h4 id="akaike-information-criteria-aic">Akaike information criteria
(AIC)</h4>
<p>One commonly used information criteria statistic is the Akaike
information criteria (AIC) (Akaike, 1973). Goodness of fit is usually
determined by the maximum log-likelihood parameter estimate <span
class="math inline">\(\theta\)</span> for a model with a given dataset,
<span class="math inline">\(y\)</span>, but we can also use residual sum
of squares. In fact the R function <strong>AIC()</strong> can be used on
a given model fit with the <strong>lm()</strong> function to calculate
this quantity. There is a penalty for model complexity given as the
number of adjustable model parameters, <span
class="math inline">\(k\)</span>. So we have:</p>
<p><span class="math display">\[AIC=-2ln(m|y, \theta) +2k\]</span></p>
<p>Its easy to remember that when comparing models, we are always
looking for the lowest value of the AIC metric, since the complexity
penalty makes the AIC <em>larger</em>. You can see examples of using
this metric with ecological data in Anderson et al. (2000).</p>
<p>AIC has the advantage of taking into account BOTH model fit and
parsimony. However, unlike some metrics for model evaluation (e.g.,
<span class="math inline">\(R^2\)</span>), the AIC value has no meaning
on its own. It can only be used to compare models. It does have some
advantages over other strategies of model comparison such as the
likelihood ratio test, since we can compare very different models using
the same metric. In comparison, the likelihood ratio tests assumes that
the models are nested (i.e. that one model can be converted to another
by setting one or more parameters equal to 0 or 1; for example, the
theta logistic model and logistic model are nested).</p>
<h4 id="comparing-our-3-models-with-aic">Comparing our 3 models with
AIC</h4>
<p>Let’s use this metric to compare our three models fit to the Harrison
(1991) data.</p>
<table>
<thead>
<tr class="header">
<th>model</th>
<th># parameters</th>
<th>-ln <span class="math inline">\(L_{max}\)</span></th>
<th>AIC</th>
<th>AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exponential</td>
<td>2</td>
<td>37.237</td>
<td>78.5</td>
<td>79.0</td>
</tr>
<tr class="even">
<td><strong>logistic</strong></td>
<td>3</td>
<td>35.225</td>
<td><strong>76.4</strong></td>
<td>77.6</td>
</tr>
<tr class="odd">
<td>theta-logistic</td>
<td>4</td>
<td>35.174</td>
<td>78.3</td>
<td>80.5</td>
</tr>
</tbody>
</table>
<p>In general, AIC values for models that are different by more than 2
units are interpreted as having importantly different predictive
performance (Anderson et al., 2000). In this case, we might select the
logistic model as it has the lowest AIC, but it is still within two
units of the theta-logistic model. However we do note that for small
sample sizes, a correction is recommended when the number of data
points, n, divided by the number of parameters, is small: <span
class="math inline">\(n/k&lt;40\)</span> (Burnham &amp; Anderson, 2004):
<span class="math inline">\(AIC_c=-2ln L
+2k+\frac{2k(k+1)}{n-k-1}\)</span>, which in this case would indicate
the exponential model and the logistic had the same support.</p>
<p>Finally, when the AIC differences are very small, the raw values
cannot tell us much about the extent to which the data support one model
over another. To look at this more closely we can calculate the
<strong>Akaike weights</strong>. For each model, we find the differences
in AIC with respect to the AIC of the best candidate model as: <span
class="math inline">\(\Delta_i(AIC)=AIC_i- min(AIC)\)</span>. We can
then obtain an estimate of the relative likelihood of each model <span
class="math inline">\(M_i\)</span> by the transform: <span
class="math inline">\(L(M_i|data)\propto exp (- \frac {1}{2}
\Delta_i(AIC))\)</span> where <span
class="math inline">\(\propto\)</span> stands for “is proportional to.”
Then, the relative model likelihoods are divided by the sum of the
likelihoods of all models to obtain Akaike weights, <span
class="math inline">\(w_i (AIC)\)</span> (e.g., Burnham &amp; Anderson,
2001), as: <span class="math display">\[w_i (AIC) = \frac {exp (- \frac
{1}{2} \Delta_i(AIC))}{\sum exp (\frac{1}{2}\Delta_k(AIC)
)}\]</span>.</p>
<table>
<thead>
<tr class="header">
<th>model</th>
<th># parameters</th>
<th>-ln <span class="math inline">\(L_{max}\)</span></th>
<th>AIC</th>
<th>w(AIC)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exponential</td>
<td>2</td>
<td>37.237</td>
<td>78.5</td>
<td>0.21</td>
</tr>
<tr class="even">
<td><strong>logistic</strong></td>
<td>3</td>
<td>35.225</td>
<td><strong>76.4</strong></td>
<td><strong>0.57</strong></td>
</tr>
<tr class="odd">
<td>theta-logistic</td>
<td>4</td>
<td>35.174</td>
<td>78.3</td>
<td>0.22</td>
</tr>
</tbody>
</table>
<p>Since these weights sum to 1, they can be interpreted as the
probability that a given model is the best one, given the data and the
set of candidate models (e.g., Burnham &amp; Anderson, 2001). Thus, the
strength of evidence in favor of one model over the other is obtained by
dividing their Akaike weights. So comparing the logistic model and
theta-logistic we have <span class="math display">\[\frac
{w_{Log}}{w_{Theta}}=\frac {.57}{.22}=2.6,\]</span> indicating that the
logistic model is about 2.6 times more likely than the next best
model.</p>
<h3 id="references-3">References</h3>
<p>Akaike, H. (1973). Information theory and an extention of the maximum
likelihood principle. In <em>2nd Inter. Symp. on information
Theory</em>. Akademiai Kiado.</p>
<p>Anderson, D. R., Burnham, K. P., &amp; Thompson, W. L. (2000). Null
hypothesis testing: problems, prevalence, and an alternative. <em>The
Journal of Wildlife Management</em>,<em>64</em>, 912-923.</p>
<p>Anderson, D., &amp; Burnham, K. (2004). Model selection and
multi-model inference. <em>Second edition</em>. NY: Springer-Verlag.</p>
<p>Burnham, K. P., &amp; Anderson, D. R. (2001). Kullback-Leibler
information as a basis for strong inference in ecological studies.
<em>Wildlife Research</em>, <em>28</em>(2), 111-119.</p>
<p>Edwards, A. W. (1974). The history of likelihood. <em>International
Statistical Review/Revue Internationale de Statistique</em>,<em>42</em>,
9-15.</p>
<p>Harrison, S. (1991). Local extinction in a metapopulation context: an
empirical evaluation. <em>Biological Journal of the Linnean
Society</em>, <em>42</em>(1-2), 73-88.</p>
<h1 id="structured-population-models">Structured population models</h1>
<h2 id="introduction-to-population-structure">Introduction to population
structure</h2>
<p>So far, we have limited our prediction of wild populations by
assuming that all individuals in a population are identical. However,
many plants and animals have distinct age or stage structure in their
populations. In fact, ecologists care about these particular parts of a
population as much as they do the population as a whole. To understand
and predict population growth, we cannot avoid discussing the dynamics
of these particular ages and stages.</p>
<h3 id="different-population-structures">Different population
structures</h3>
<p>In the same population, individuals can have markedly different
dynamics depending on their age. This is called <strong>age
structure</strong>. For example, Coulson et al. (2001) found that
individual susceptibility to changing environmental conditions differs
between Soay sheep of different ages. Young and old individuals are more
severely affected by adverse weather conditions than adults of prime
reproductive age.</p>
<figure>
<img src="soay.jpg"
alt="© Eileen Henderson, A pair of Soay sheep on Hirta, Creative Commons CC BY-SA 2.0 License" />
<figcaption aria-hidden="true">© Eileen Henderson, <a
href="https://www.geograph.org.uk/photo/493775">A pair of Soay sheep on
Hirta</a>, <a
href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons
CC BY-SA 2.0 License</a></figcaption>
</figure>
<p>While for many species (especially for amphibians, fish, and
insects), differences in vital rates in wild populations often depend on
developmental or morphological stages, rather than ages. This is
referred to as <strong>stage structure</strong>. For example, common
frogs can be divided into three stages according to their developmental
status: Pre-juvenile, juvenile, and adults. The vital rates within each
stage are relatively constant. (Biek et al., 2002)</p>
<p><strong>Size structure</strong> is another commonly used category.
For many fish species, age and body size (fork length) is highly
correlated. Since fish length is much easier to measure and obtain, it
is common to categorize fish into different size groups when building a
population matrix.</p>
<h3 id="life-tables">Life tables</h3>
<p>A <strong>life table</strong> is a record of survival and
reproductive rates in a population, broken out by age, size, or
developmental stage.</p>
<p>Consider the same common frog example we discussed above:</p>
<ul>
<li>Common frogs can be divided into three stages according to their
developmental status: Pre-juvenile, juvenile, and adults. We can record
the demographic vital rates and transition probabilities (the
probability of surviving and successfully transitioning to the next
developmental stage) for each stage in a table:</li>
</ul>
<table>
<caption>Demographic vital rates and tansition probabilities for
different common frog developmental stages (data from Biek et al.,
2002)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Stages</th>
<th style="text-align: center;">Survival</th>
<th style="text-align: center;">Transition</th>
<th style="text-align: center;">Reproduction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pre-juvenile</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0.019</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Juvenile</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adult</td>
<td style="text-align: center;">0.43</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">279.5</td>
</tr>
</tbody>
</table>
<h4 id="methods-to-construct-life-tables">Methods to construct life
tables:</h4>
<p><strong>Cohort-based approach</strong></p>
<p>The cohort analysis follows all individuals born during a time
period, determining the ages that they die and their birth rates as they
age. Life tables constructed from the segment-based method are often
called horizontal or cohort life tables. Cohort life tables allow
researchers to observe the changes in the survival and mortality rates
of a population over time. However, it is usually very challenging to
follow a cohort from birth to death of the last individual.</p>
<p><strong>Segment-based approach</strong></p>
<p>The segment-based approach looks at the births and deaths of all the
individuals in the population during some slice of time. Life tables
constructed from the segment-based method are often called vertical or
period life tables. It is often used when studying populations of
animals that are difficult to track over time.</p>
<ul>
<li>In summary, both are useful tools to study population dynamics.
Vertical life tables provide an accurate representation of a
population’s mortality rate and survivorship at a specific point in
time; while cohort life tables provide a more detailed understanding of
how a population’s mortality rate and survivorship change over
time.</li>
</ul>
<h3 id="life-history-stage-diagram">Life history stage diagram</h3>
<p>From the life table in the previous section, we can create a life
history diagram to represent the vital rates in different population
stages.</p>
<ul>
<li>In a life history diagram, different stages are represented by
different circles, Self-pointing arrows refer to the probability of
remaining in the current stage (survival); forward-points arrows refer
to the probability of transitioning to the next stage (transition);
backward-pointing arrows refer to the fecundity value
(reproduction).</li>
</ul>
<figure>
<img src="frog_diagram.jpeg"
alt="Life history stage diagram showing the vital rates of common frog in three different developmental stages. Dashed lines represent reproduction rates; solid lines represent trnasition probabilities. Data obtained from Biek et al., 2002." />
<figcaption aria-hidden="true">Life history stage diagram showing the
vital rates of common frog in three different developmental stages.
Dashed lines represent reproduction rates; solid lines represent
trnasition probabilities. Data obtained from Biek et al.,
2002.</figcaption>
</figure>
<h3 id="use-matrix-to-represent-population-dynamics">Use matrix to
represent population dynamics</h3>
<p>Compared to life tables and life history diagrams, population
matrices are more versatile and practical tools for presenting how
structure affects wildlife population dynamics.</p>
<p>A handy way to decipher the biological meaning of any matrix element
is to label the rows and columns of the matrix with the consecutive
stages of the target organism. Each element gives the transition from
the current column number to the current row number.</p>
<ul>
<li>For example, <span class="math inline">\(a_{i,j}\)</span> represents
the number of individuals contributed on average by each individual in
class j this year to class i next year.</li>
</ul>
<p>Consider the following matrix, common frog has three stages,
pre-juvenile, juvenile, and adult. The time step is 1 year.</p>
<ul>
<li><p>The first row (<span class="math inline">\(a_{1,2} = 52, a_{1,3}
= 279.5\)</span>) represents reproduction from each stage to the next
year.</p></li>
<li><p>The diagonal (<span class="math inline">\(a_{2,2} = 0.25, a_{3,3}
= 0.43\)</span>) represents the proportion of individuals in a stage
that will survive and still be in the same stage next year.</p></li>
<li><p>The sub-diagonal (<span class="math inline">\(a_{2,1} = 0.019,
a_{3,2} = 0.08\)</span>) represents the proportion surviving and
advancing to the next stage.</p></li>
</ul>
<table>
<caption>Anatomy of a female-based projection matrix for common fog
(adapted from Biek et al., 2002)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Pre-juvenile</th>
<th style="text-align: right;">Juvenile</th>
<th style="text-align: right;">Adult</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pre-juvenile</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: right;">279.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Juvenile</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adult</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.43</td>
</tr>
</tbody>
</table>
<p>Anatomy of a female-based projection matrix for common fog (adapted
from Biek et al., 2002)</p>
<h4 id="leslie-matrix---for-age-structure">Leslie Matrix - for age
structure</h4>
<ul>
<li><p>The Leslie Matrix is a discrete, age-structured model of
population growth. In a Leslie model, the population is divided into
groups based on age classes. The (i,j)th cell in the matrix indicates
how many individuals will be in the age class i at the next time step
for each individual in stage j. (Leslie, 1945; Leslie, 1948)</p></li>
<li><p>In a Leslie Matrix, an individual can only survive and transition
to the next stage, or die, so everything below the first row and not on
the subdiagonal of the matrix must be zero.</p></li>
</ul>
<span class="math display">\[\begin{bmatrix}
f_0 &amp; f_1 &amp; f_2 &amp; \cdots &amp; f_{m-1}&amp; f_{m} \\
s_0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
0 &amp; s_1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; s_2 &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots
\\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; s_{m-1} &amp; 0 \\
\end{bmatrix}\]</span>
<p>A leslie matrix consists of <span class="math inline">\(m+1\)</span>
rows and <span class="math inline">\(m+1\)</span> columns. <span
class="math inline">\(f\)</span> represents the reproductive rate of
that age class in the population, <span class="math inline">\(s\)</span>
represents the probability for surviving and transitioning to the next
age class.</p>
<h4 id="lefkovitch-matrix---for-stagesize-structure">Lefkovitch Matrix -
for stage/size structure</h4>
<ul>
<li><p>The use of Lefkovitch matrix is usually associated with stage
structure (or size structure), rather than age structure. (Lefkovitch,
1965)</p></li>
<li><p>Unlike age-structured population models, animals can remain in
some stages or size groups for multiple time steps. Therefore, a
Lefkovitch matrix appears to be a more accurate representation of these
population models.</p></li>
</ul>
<h2 id="projecting-a-population-matrix-through-time">Projecting a
population matrix through time</h2>
<h3 id="how-to-project-a-matrix">How to project a matrix</h3>
<p>Once the matrix model is filled with vital rates it can be projected
through time, keeping track of both total population size and numbers of
individuals in each stage.</p>
<p>To determine the population size vector next year <span
class="math inline">\(n(t+1)\)</span>, multiply the matrix <span
class="math inline">\(M\)</span> of vital rates by the vector of
individuals at current time <span
class="math inline">\(n(t)\)</span>:</p>
<p><span class="math display">\[n(t+1) = M*n(t)\]</span></p>
<p>Projecting the matrix through time requires you to understand the
fundemantals of matrix math. If you are unfamiliar with how to conduct
matrix multlipcation, please check out <a
href="https://www.khanacademy.org/math/precalculus/x9e81a4f98389efdf:matrices/x9e81a4f98389efdf:multiplying-matrices-by-matrices/a/multiplying-matrices">this
tutorial</a>.</p>
<p><strong>Example:</strong></p>
<p>Consider the population model of common frog we have been discussing.
The population can be divided into three developmental stages, and the
vital rates are reported in the matrix in the previous section. In 2010,
the population consists of <strong>70 pre-juveniles, 20 juveniles, and
10 adults</strong> (initial population), what is the population number
for each stage in 2011 (one time step later)?</p>
<p>By multiplying the number of frogs times the matrix of mean vital
rates, we project the population forward for a year.</p>
<ul>
<li>The matrix <span class="math inline">\(\times\)</span> Population
vector in 2010 = Population vector in 2011</li>
</ul>
<p><span class="math display">\[
\begin{bmatrix}0&amp;52&amp;279.5 \\0.019&amp;0.25&amp;0
\\0&amp;0.08&amp;0.43 \\\end{bmatrix} \times \begin{bmatrix}70 \\20 \\10
\\\end{bmatrix} =
\begin{bmatrix}
  (0 \times 70) + (52 \times 50) + (279.5 \times 10) \\
  (0.019 \times 70) + (0.25 \times 50) + (0 \times 10)  \\
  (0 \times 70) + (0.08 \times 50) + (0.43 \times 10) \\
\end{bmatrix} =
\begin{bmatrix}3835 \\6 \\6 \\\end{bmatrix}
\]</span> Projecting the population number of common frog through time
(adapted from Mills, 2013).</p>
<h3 id="stable-agestage-distribution">Stable age/stage distribution</h3>
<p>A property of a stage structured population is that, if all the vital
rates in the projection matrix remain constant, the population stage
structure will approach a stable stage distribution, in which the
relative number of individuals in each stage, and the population growth
rate <span class="math inline">\(\lambda\)</span> will be constant.</p>
<p>Consider the same common frog example. With constant vital rates, we
project the population for 14 year:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty matrix to store the population projection results</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>N.project <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> years<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the initial population for each stage</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>N.project[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">20</span>,<span class="dv">10</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a for loop to iterate through the time steps</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  N.project[, i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> X <span class="sc">%*%</span> N.project[,i]</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With the population abundance in each stage, we can calculate the
stage distribution in 2023:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the stage distribution for 2023</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>s<span class="fl">.2023</span> <span class="ot">&lt;-</span> <span class="fu">sum</span>(N.project[,<span class="dv">14</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-juvenile:</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>N.project[<span class="dv">1</span>,<span class="dv">14</span>]<span class="sc">/</span>s<span class="fl">.2023</span></span></code></pre></div>
<pre><code>[1] 0.9813586</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Juvenile:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>N.project[<span class="dv">2</span>,<span class="dv">14</span>]<span class="sc">/</span>s<span class="fl">.2023</span></span></code></pre></div>
<pre><code>[1] 0.01713166</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adult:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>N.project[<span class="dv">3</span>,<span class="dv">14</span>]<span class="sc">/</span>s<span class="fl">.2023</span></span></code></pre></div>
<pre><code>[1] 0.001509782</code></pre>
<p>Similarly, we can calculate the stage distribution in 2024:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the stage distribution for 2024</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>s<span class="fl">.2024</span> <span class="ot">&lt;-</span> <span class="fu">sum</span>(N.project[,<span class="dv">15</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-juvenile:</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>N.project[<span class="dv">1</span>,<span class="dv">15</span>]<span class="sc">/</span>s<span class="fl">.2024</span></span></code></pre></div>
<pre><code>[1] 0.9813508</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Juvenile:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>N.project[<span class="dv">2</span>,<span class="dv">15</span>]<span class="sc">/</span>s<span class="fl">.2024</span></span></code></pre></div>
<pre><code>[1] 0.0171394</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adult:</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>N.project[<span class="dv">3</span>,<span class="dv">15</span>]<span class="sc">/</span>s<span class="fl">.2024</span></span></code></pre></div>
<pre><code>[1] 0.001509771</code></pre>
<p>We can see that the relative proportion of individuals in each stage
class stays the same. The stage structure at SSD is:</p>
<p><span class="math display">\[
\begin{bmatrix}
98.1\% \\
1.7\%\\
0.2\% \\
\end{bmatrix}
\]</span> This result can also be demonstrated by plotting the log
number of individuals in each stage class versus time:</p>
<figure>
<img src="SSDplot-1.jpeg"
alt="Population numbers of common frog over 14 years as shown by stage class. The number of frogs is plotted on a logarithmic scale." />
<figcaption aria-hidden="true">Population numbers of common frog over 14
years as shown by stage class. The number of frogs is plotted on a
logarithmic scale.</figcaption>
</figure>
<p>At SSD, the population growth rate <span
class="math inline">\(\lambda\)</span> also stays constant. See the
calculations below for <span class="math inline">\(\lambda\)</span> at
year 14 and 15:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The population growth rate from year 2022-2023 is:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(N.project[,<span class="dv">14</span>])<span class="sc">/</span><span class="fu">sum</span>(N.project[,<span class="dv">13</span>])</span></code></pre></div>
<pre><code>[1] 1.338596</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The population growth rate from year 2023-2024 is:</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(N.project[,<span class="dv">15</span>])<span class="sc">/</span><span class="fu">sum</span>(N.project[,<span class="dv">14</span>])</span></code></pre></div>
<pre><code>[1] 1.337779</code></pre>
<h3 id="eigenanalysis">Eigenanalysis</h3>
<p>The asymptotic matrix properties (stage age distribution, population
growth rate <span class="math inline">\(\lambda\)</span>, and
reproductive value) can also be calculated analytically using matrix
math, instead of approximating these values by projecting an initial
population vector out many time steps.</p>
<h4 id="annual-population-growth-rate-at-ssd">Annual population growth
rate at SSD</h4>
<p>The asymptotic annual growth rate or finite rate of increase is the
dominant eigenvalue of the transition matrix.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the eigenanalysis</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>eigs.X <span class="ot">&lt;-</span> <span class="fu">eigen</span>(X)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the index position of the largest absolute value of the eigenvalues</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>dom.pos <span class="ot">&lt;-</span> <span class="fu">which.max</span>(eigs.X[[<span class="st">&quot;values&quot;</span>]])</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the dominant eigenvalue and retain only its real part</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">Re</span>(eigs.X[[<span class="st">&quot;values&quot;</span>]][dom.pos])</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>[1] 1.338048</code></pre>
<p><br></p>
<h4 id="stable-stage-distribution">Stable stage distribution</h4>
<p>The stage stage distribution is associated with the right eigenvector
<span class="math inline">\(w_1\)</span>. The distribution is defined
as:</p>
<p><span class="math display">\[
\frac{w_1}{\sum^{s}_{i=1}{w_1}}
\]</span> where <span class="math inline">\(s\)</span> is the number of
stages.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract w, keeping just the real part, and divide it by its sum to get the stable stage distribution</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">Re</span>(eigs.X[[<span class="st">&quot;vectors&quot;</span>]][, dom.pos])</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ssd <span class="ot">&lt;-</span> w<span class="sc">/</span><span class="fu">sum</span>(w)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ssd, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>[1] 0.981 0.017 0.002</code></pre>
<p><br></p>
<h4 id="reproductive-value">Reproductive value</h4>
<p>The reproductive value gives us one measure of the importance of an
individual in each stage. Reproductive value is the expected
contribution of each individual to present and future reproduction.</p>
<p>We can find each stage’s reproductive value by solving for the
dominant left eigenvector <span class="math inline">\(v\)</span>,
where</p>
<p><span class="math display">\[
vA = \lambda v
\]</span></p>
<p>Since this vector <span class="math inline">\(v\)</span> is
proportional to the reproductive values. We have the follow definition
for reproductive value:</p>
<p><span class="math display">\[
\frac{v_1}{\sum^{s}_{i=1}{v_1}}
\]</span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing eigenanalysis on the transpose of the projection matrix</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">t</span>(X))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the left eigenvalues and eigenvectors</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">Re</span>(M<span class="sc">$</span>vectors[, <span class="fu">which.max</span>(<span class="fu">Re</span>(M<span class="sc">$</span>values))])</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract just the dominant left eigenvector; we then scale it, so the stage 1 has a reproductive value of 1.0</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>RV <span class="ot">&lt;-</span> v<span class="sc">/</span>v[<span class="dv">1</span>]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>RV</span></code></pre></div>
<pre><code>[1]   1.00000  70.42358 307.80308</code></pre>
<h2 id="illustratin-of-current-application">Illustratin of current
application</h2>
<p>This literature example demonstrates how the use of stage-structured
population models can be applied to solving real-life ecological
management problems.</p>
<p><strong>Problem</strong>: There is an invasive guttural toad
(<em>Sclerophrys gutturalis</em>) population in Cape Town. With limited
budget and efforts, and prior knowledge that the vital rates of this
species are likely to differ significantly among developmental stages,
we would like to know what is the most efficient way to remove invasive
codes (what stage should we target)?</p>
<p><strong>Step 1:</strong></p>
<p>The first step is to create a stage-structured population model to
project the population dynamics. From Vimercati et al. (2017), we obtain
the life history stage diagram and population projection matrix (Note
that in our example, the density effects and spatial effects presented
in the original literature have been removed to simplify the
model.).</p>
<figure>
<img src="toad_diagram.jpeg"
alt="Life history diagram of invasive guttural toad population in Cape Town. All values are extracted from Vimercati et al. (2017), except for the survival rate of metamorph to juvenile, which is arbitrarily chosen as 0.2." />
<figcaption aria-hidden="true">Life history diagram of invasive guttural
toad population in Cape Town. All values are extracted from Vimercati et
al. (2017), except for the survival rate of metamorph to juvenile, which
is arbitrarily chosen as 0.2.</figcaption>
</figure>
<p><br> <span class="math display">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 780 \\
0.7 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0.8 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0.5 &amp; 0.15 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0.05 &amp; 0.6 \\
\end{bmatrix}
\]</span> <br> With an initial population of 20 adults (when the species
was first recorded in a single pond of Cape Town), we project the model
for 30 time steps to simulate the population dynamics from 2001 to
2030.</p>
<figure>
<img src="toads_projection-1.jpeg"
alt="Population numbers of invasive guttural toad over 30 years as shown by stage class. The number of frogs is plotted on a logarithmic scale." />
<figcaption aria-hidden="true">Population numbers of invasive guttural
toad over 30 years as shown by stage class. The number of frogs is
plotted on a logarithmic scale.</figcaption>
</figure>
<p><strong>Step 2:</strong></p>
<p>Knowing the population dynamics, the researchers ran different
management simulations by altering the mortality rate of different
stages to simulate the removal efforts targeted at these different
stages. They then calculated the efficiency for each strategy, as well
as projected population size at the end of the management to see which
one is the most efficient method to control toad population. The
methodology is complicated thus not discussed in details here.
(Vimercati et al., 2021)</p>
<table style="width:100%;">
<caption>Management removal strategy, population size at the end of
management and efficacy obtained by simulating different strategies with
a stage-structured model for the invasive population of guttural toad,
<em>Sclerophrys gutturalis</em>, in Cape Town. (values are taken from
Vimercati et al., 2021)</caption>
<colgroup>
<col style="width: 31%" />
<col style="width: 47%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Management removal strategy</th>
<th style="text-align: center;">Population size at the end of
management</th>
<th style="text-align: center;">Strategy efficacy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No removal</td>
<td style="text-align: center;">2973</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adult removal</td>
<td style="text-align: center;">2197</td>
<td style="text-align: center;">776</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pre-metamorphic removal</td>
<td style="text-align: center;">3318</td>
<td style="text-align: center;">-345</td>
</tr>
<tr class="even">
<td style="text-align: left;">Successfully eradication</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2973</td>
</tr>
</tbody>
</table>
<p><strong>Step 3:</strong></p>
<p>From the results, Vimercati et al.(2021) concluded that removing only
adults can maximize the reduction of population size and it is the most
effective strategy. Pre-metamorphic stages (egg and tadpole) should not
be targeted when making removal plans, as it is likely to cause opposite
effects.</p>
<h2
id="sensitivities-elasticities-and-management-applications">Sensitivities,
elasticities, and management applications</h2>
<p>Remember how populations which achieved a stable stage distribution
(SSD) maintain a constant proportion of organisms in each stage? Each of
these stages contributes differently to the overall population, which is
indicated by specific reproductive values. Thus, we can expect that
vital rates for a stage with more individuals and/or larger reproductive
values will have a greater impact to population growth rates.
<strong>Sensitivity and elasticity analyses</strong> are performed to
determine the importance of each vital rate (survival or reproduction)
within stages to the growth of a given population. While
<strong>sensitivities</strong> represent absolute differences,
<strong>elasticities</strong> enable a proportional comparison between
vital rates. The theory and mathematical notations used in this section
are based on Caswell (2001).</p>
<h3
id="why-are-sensivities-and-elasticities-important-to-population-ecology-studies">Why
are sensivities and elasticities important to population ecology
studies?</h3>
<p>By identifying the most important vital rates to population dynamics,
the analysis of sensitivities and elasticities has the potential to
guide management decisions in terms of targeting actions to specific
life stages. It enables life history comparisons, managing extinction
risk, and population growth control (Manlik, Lacy, &amp; Sherwin, 2018).
Such analyses are also useful for understanding how a given societal,
environmental, or policy change will affect wildlife, and how population
fitness evolves as a response to phenotypic changes (Caswell, 2019).</p>
<p>One of the first studies which applied sensitivity analysis found
that management strategies for endangered loggerhead sea turtles should
focus on young adults in the ocean more than hatchlings moving from the
sand to the sea. This is because elasticity values for young adult
survival are greater than elasticities for eggs and hatchlings. High
mortality for young adults was attributed to turtles accidentally
trapped in fishing gear. After implementing turtle excluder devices
(TED) as a management strategy, temporary population increases were
observed (Crouse, Crowder, &amp; Caswell, 1987). A more recent study
identified that this strategy has contributed to a deep reduction in
turtle mortality, including other endangered species (Finkbeiner et al.,
2011). Such findings contribute to the choice and application of
successful management strategies which result in population growth of
endangered species.</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/turtle.jpg"
data-fig.width="180" data-fig.height="120" data-dpi="300"
alt="© T. Moore, Loggerhead Turtle, Public use provided by the National Institute of Standards and Technology (NIST), US" />
<figcaption aria-hidden="true">© T. Moore, <a
href="https://commons.wikimedia.org/wiki/File:Loggerhead_Turtle_%285884715439%29.jpg">Loggerhead
Turtle</a>, Public use provided by the <a
href="https://www.nist.gov/">National Institute of Standards and
Technology (NIST), US</a></figcaption>
</figure>
<h3 id="sensitivity">Sensitivity</h3>
<p>How sensitive is population growth to small changes in different
vital rates? We can investigate this by looking at how <span
class="math inline">\(\lambda\)</span> is impacted (or how sensitive it
is) following a very small change in a vital rate within a given
population matrix, considering that all of the other matrix elements
remain unchanged. This is called analytical sensitivity, which is given
by the following:</p>
<p><span class="math display">\[a_{i,j} =
\frac{\partial\lambda}{\partial a_{i,j}} =
\frac{v_{i}*w_{j}}{\sum_{k=1}{(v_k*w_k)}}\]</span> Where: a(i,j) = a
given matrix element<br />
<span class="math inline">\(\partial\)</span> = partial derivative
denoting a very small change applied to rates while all other variables
are held constant<br />
<span class="math inline">\(\lambda\)</span> = rate of population
change<br />
v(i) = reproductive value<br />
w(j) = stable stage distribution (SSD) value<br />
v(k) = reproductive value for class k w(k) = stable stage distribution
(SSD) value for class k</p>
<h3 id="from-sensitivity-to-elasticity">From sensitivity to
elasticity</h3>
<p>Because the sensitivity analysis is based in absolute values, changes
applied to small values have a disproportional effect in comparison to
changes to larger values, which can make comparisons problematic. This
is especially true because fecundity rates are usually measured using
different units than survival rates. A solution is considering vital
rate sizes and making sensitivities proportional to them. Such rescaled
sensitivites are then called <strong>elasticities</strong> and can be
represented by:</p>
<p><span class="math display">\[\text{Elasticity of }a_{i,j} =
\text{(sensitivity of }a_{i,j})*\frac{a_{i,j}}{\lambda}\]</span></p>
<p>Soon you will learn how to calculate the sensitivities and
elasticities you see in the following plot. For now, try to focus on the
fact that absolute sensitivity values change when scaled into
elasticities. Matrix elements which are very sensitive (eg., survival of
9-16cm trees in our plot) seem to have the potential to greatly alter
<span class="math inline">\(\lambda\)</span> rates. But to compare vital
rates, we need elasticities. Our elasticities tell us that survival for
bigger trees is proportionally more significant in terms of impacting
growth rates. Thus, a very sensitive element may end up having a low
relative elasticity value. In this case, we could recommend to wildlife
managers looking at an endangered species to focus on taller individuals
first.</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/sensitivity_analysis_files/unnamed-chunk-6-1.jpeg"
data-dpi="300"
alt="Sensitivities and elasticities for several tree sizes (in cm) in an oak population" />
<figcaption aria-hidden="true">Sensitivities and elasticities for
several tree sizes (in cm) in an oak population</figcaption>
</figure>
<h3 id="component-sensitivity-and-elasticity">Component sensitivity and
elasticity</h3>
<p>Component sensitivity is a numerical approximation of sensitivity
which you have just learnt how to calculate. In addition to being used
as an approximation to analytical sensitivities, component sensitivities
can be used in cases in which both survival and reproduction rates
affect the same matrix elements or when a certain vital rate appears in
more than one matrix element. They can be calculated by changing the
<span class="math inline">\(\lambda\)</span> SSD by a small amount (eg.,
0.01 in the equation below), obtaining the resulting matrix, and
obtaining the new <span class="math inline">\(\lambda\)</span> SSD for
this changed matrix. Then, you proceed with this calculation for a given
vital rate x:</p>
<p><span class="math display">\[x =
\frac{\lambda_{x+0.01}-\lambda_{original}}{0.01}\]</span></p>
<p>And for the elasticity:</p>
<p><span class="math display">\[\text{Component elasticity of vital rate
x} = \text{(component sensitivity of vital rate x)
}*\frac{x}{\lambda_{original}}\]</span></p>
<h3
id="advantages-of-elasticities-as-compared-to-sensitivites">Advantages
of elasticities as compared to sensitivites</h3>
<p>Elasticities are useful in population biology studies due to the
following properties:</p>
<ul>
<li><p>Elasticities for several vital rates can be directly compared
within and between populations</p></li>
<li><p>The sum of elasticities of all matrix elements equals 1</p></li>
<li><p>The sum of 2 or more elasticities enable analyzing the grouped
effect of vital rates</p></li>
<li><p>General life history patterns can be considered when analyzing
elasticities. For instance, long-lived species tend to have a higher
elasticity for survival in comparison with reproduction. Thus, when
observing significant changes in population growth rates, adult survival
elasticities should be considered first.</p></li>
</ul>
<h3 id="limitations-of-sensitivity-and-elasticity-analyses">Limitations
of sensitivity and elasticity analyses</h3>
<p>Sensitivities and elasticities are calculated based on the assumption
that populations have a stable stage distribution. However, they are not
enough to describe vital rate dynamics under natural or management
conditions: this is because high and low sensitivities and elasticities
need to be considered together with the variance of vital rates.</p>
<p>Sensitivity analyses using a mean matrix can be misleading in some
situations, such as when environmental conditions have a large influence
on a given population. Mean matrices also disregard transient dynamics
following management actions. In this case, phenomena such as population
inertia may occur, in which growth occurs in opposite trends as the
predicted by asymptotic elasticity as a result of a large change to a
vital rate with a high elasticity. Our section entitled <a
href="https://www.ecotheory.ca/teach/BIOL652.html#structured-population-models"><strong>Temporal
environmental stochasticity in matrix models</strong></a> details
analyses considering sensitivities and elasticities for transients and
stochastic scenarios.</p>
<h3
id="analytical-sensitivity-and-elasticity-variance-in-vital-rates">Analytical
sensitivity and elasticity &amp; variance in vital rates</h3>
<p>A high elasticity and low variation in a vital rate may be less
important to population growth than another vital rate characterized by
a low elasticity but a great variability. An example is juvenile
survival for several species: even if a low elasticity is found for this
vital rate, it may be more variable than vital rates for adults, as
juveniles have more mortality due to predation, poor conditions, and
density-dependent factors. Mean matrices are not appropriate for this
type of analysis, as it requires knowing how much vital rates change in
nature or under management and how this change affects population
growth.</p>
<h3 id="sensitivity-analysis-methods">Sensitivity analysis methods</h3>
<p>The most common method for performing a sensitivity analysis is
called manual perturbation and consists of the technique described above
of manually changing vital rates and comparing the before and after
<span class="math inline">\(\lambda\)</span> SSD. In addition to vital
rates, this method allows assessing factors like density dependence,
immigration and emigration, age structure, and endogamy (breeding of
related individuals resulting in offspring performance reduction).</p>
<p>Another method which considers both sensitivity and variance in vital
rates is called life-stage simulation analysis. It is done by applying
realistic changes to averages and variances in field-collected rates to
simulate several potential future scenarios. Thus, several matrices are
built using the vital rates specified in a distribution function, and
<span class="math inline">\(\lambda\)</span> SSDs are calculated for
each matrix to investigate the probability of a population to increase
or decrease in time. By considering each matrix as a replicate, we can
compare ratings of elasticities across scenarios. To include
stochasticity, random vital rates can be used and <span
class="math inline">\(\lambda\)</span>S can be calculated instead of
<span class="math inline">\(\lambda\)</span> SSD.</p>
<p>Life-stage simulation analyses can also be done by regressing <span
class="math inline">\(\lambda\)</span> values against each vital rate
(for each replicate), considering that all other vital rates are also
changing at the same time. In this case, the coefficient of
determination (<span class="math inline">\(R^2\)</span>) corresponds to
how much variation in population growth is explained by variation in
that specified vital rate. The slope of line represents the analytical
sensitivity; if using log-transformed data, the slope corresponds to the
elasticity.</p>
<h3
id="practicing-the-calculation-of-sensitivities-and-elasticities">Practicing
the calculation of sensitivities and elasticities</h3>
<p>Now let’s use an actual population matrix to make a sensitivity
analysis and try to figure out the most important vital rates to an oak
tree (<em>Quercus mongolica</em>) population. In Asia, the native range
for this plant, populations have been suffering steep decreases in size
due to the spread of a fungal disease vectored by a beetle (Choi et al.,
2022).</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/oak.jpg"
data-fig.width="180" data-fig.height="120" data-dpi="300"
alt="A healthy (left) and an infected (right) oak tree; (left) © MPF, Quercus mongolica, Creative Commons CC BY-SA 3.0 license; (right) © William M. Ciesla, Oak wilt, Creative Commons CC BY-NC 3.0 license" />
<figcaption aria-hidden="true">A healthy (left) and an infected (right)
oak tree; (left) © MPF, <a
href="https://commons.wikimedia.org/wiki/File:Quercus_mongolica_in_June.jpg"><em>Quercus
mongolica</em></a>, <a
href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">Creative
Commons CC BY-SA 3.0 license</a>; (right) © William M. Ciesla, <a
href="https://www.invasive.org/browse/detail.cfm?imgnum=0758073#">Oak
wilt</a>, <a
href="https://creativecommons.org/licenses/by-nc/3.0/">Creative Commons
CC BY-NC 3.0 license</a></figcaption>
</figure>
<p>It is important to know life history aspects affecting the population
growth for this species when predicting disease impacts and planning
management actions. A mean matrix for this plant can be found on the <a
href="https://compadre-db.org/Species/47241">Compadre database</a>.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">5-8cm</th>
<th style="text-align: right;">9-16cm</th>
<th style="text-align: right;">17-32cm</th>
<th style="text-align: right;">33-64cm</th>
<th style="text-align: right;">&gt;64cm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5-8cm</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.606</td>
<td style="text-align: right;">0.606</td>
</tr>
<tr class="even">
<td>9-16cm</td>
<td style="text-align: right;">0.483</td>
<td style="text-align: right;">0.701</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td>17-32cm</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.239</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td>33-64cm</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.929</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td>&gt;64cm</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.977</td>
</tr>
</tbody>
</table>
<p>We first find the stable stage distribution through an eigen
analysis:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the eigenanalysis</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>eigen_L <span class="ot">&lt;-</span> <span class="fu">eigen</span>(L)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the index position of the largest absolute value of the eigenvalues</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">which.max</span>(eigen_L[[<span class="st">&quot;values&quot;</span>]])</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the dominant eigenvalue and retain only its real part</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">Re</span>(eigen_L[[<span class="st">&quot;values&quot;</span>]][position])</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the stable stage distribution</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>eigenvectors <span class="ot">&lt;-</span> <span class="fu">Re</span>(eigen_L[[<span class="st">&quot;vectors&quot;</span>]][, position])</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>ssd <span class="ot">&lt;-</span> eigenvectors<span class="sc">/</span><span class="fu">sum</span>(eigenvectors)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose projection matrix and do eigen analysis</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>eigenanalysis <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">t</span>(L))</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract left eigenvector corresponding to dominant eigenvalue</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">Re</span>(eigenanalysis<span class="sc">$</span>vectors[, <span class="fu">which.max</span>(<span class="fu">Re</span>(eigenanalysis<span class="sc">$</span>values))])</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the left eigenvector by the reproductive value of the first stage</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>repv <span class="ot">&lt;-</span> left<span class="sc">/</span>left[<span class="dv">1</span>]</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum the products of the vector of reproductive value and the stable stage distribution</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>S.dem<span class="ot">&lt;-</span><span class="fu">sum</span>(repv<span class="sc">*</span>ssd)</span></code></pre></div>
<p>And now we are ready to get the sensitivities and elasticities for
our oak population:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can use two loops to estimate the sensitivity for each matrix element</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span>L; n<span class="ot">=</span><span class="fu">dim</span>(L)[<span class="dv">1</span>];</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  s[i,j]<span class="ot">=</span>repv[i]<span class="sc">*</span>ssd[j]<span class="sc">/</span>S.dem;</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  }}</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># And we weight the sensitivities by the transition probabilities to get elasticities</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>elas<span class="ot">&lt;-</span><span class="fu">Re</span>(L<span class="sc">/</span><span class="fu">eigen</span>(L)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">*</span>s)</span></code></pre></div>
<p>Finally, we visualize sensitivities and elasticities for each vital
rate and stage in these bar plots:</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/sensitivity_analysis_files/r-1.jpeg"
data-dpi="300"
alt="Comparing sensitivities and elasticities for the reproduction and survival of several tree sizes (in cm) in an oak population" />
<figcaption aria-hidden="true">Comparing sensitivities and elasticities
for the reproduction and survival of several tree sizes (in cm) in an
oak population</figcaption>
</figure>
<p>By looking at the elasticities for survival and reproduction, we
conclude that <strong>adult survival</strong> for trees between the
sizes of 17 and 64 cm are the most important vital rates to the growth
of this population. Thus, such sizes can be prioritized in management
programs focused on disease prevention.</p>
<p>Alternatively, you can use the popbio package, which calculates
sensitivity and elasticity matrices in the same manner as we have just
done:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(popbio)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sensit <span class="ot">&lt;-</span> <span class="fu">sensitivity</span>(L, <span class="at">zero =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>elast <span class="ot">&lt;-</span> <span class="fu">elasticity</span>(L)</span></code></pre></div>
<h2 id="density-dependence-in-matrix-models">Density-dependence in
matrix models</h2>
<p>As populations increase in size, they compete for limited resources
and become targets of predators. This leads to lower rates of survival
and reproduction, which can be represented by linking vital rates to
population density. Similar to the unstructured models we discussed in
the first chapter, it is necessary to incorporate density dependence
into a structured model. However, there are two main factors that make
it more difficult to consider density dependence in a structured model
(Morris and Doak, 2002).</p>
<p>First of all, in reality, we have much less data for vital-rate
estimates in a demographic study due to the cost of marking and
following multiple individuals. Also, there are many more variables that
are potentially density-dependent, and here are some questions we need
to think about:</p>
<ul>
<li>What vital rates are density-dependent?</li>
<li>How do those rates change with density?</li>
<li>Which classes contribute to the density that each vital rate
“feels”?</li>
</ul>
<p>Typically, we won’t compare various density-dependent functions that
are fitted to each vital rate by using multiple combinations of classes
to measure density. Here, we will introduce two more practical ways.</p>
<h3 id="placing-a-limit-on-the-size-of-one-or-more-classes">Placing a
limit on the size of one or more classes</h3>
<p>When the focal species is territorial, the most common way to
introduce density dependence is by implementing caps (or limits) on
population density. A reasonable cap on the territory-holding
individuals, usually the breeding adults, can be estimated by dividing
the total available area of habitat by the average territory size needed
(for breeding). Setting such a cap can make the transition from the
pre-reproductive to productive stages density-dependent, even if no
other vital rates experience density-dependence.</p>
<h4 id="exmaple-on-iberian-lynx">Exmaple on Iberian lynx</h4>
<p>Gaona <em>et al</em>. (1998) investigated the population dynamics of
Iberian lynx in Donana National Park in Spain, and here we present a
simplified illustration (Morris and Doak, 2002), in which we track only
four stages of female lynx</p>
<ul>
<li>cubs (newborn)</li>
<li>juveniles (one year old)</li>
<li>floaters (old enough to breed but not in possession of a
territory)</li>
<li>breeders (territory-holding)</li>
</ul>
<figure>
<img src="iberian_lynx.jpg" style="width:50.0%"
alt="© Diego Delso, Iberian lynx (Lynx pardinus), Creative Commons CC BY-SA-4.0 license" />
<figcaption aria-hidden="true">© Diego Delso, <a
href="https://commons.wikimedia.org/wiki/File:Lince_ibérico_(Lynx_pardinus),_Almuradiel,_Ciudad_Real,_España,_2021-12-19,_DD_02.jpg">Iberian
lynx (<em>Lynx pardinus</em>)</a>, <a
href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons
CC BY-SA-4.0 license</a></figcaption>
</figure>
<p>The projection matrix <span class="math inline">\(\mathbf{A}\)</span>
is defined as follows <span
class="math display">\[\mathbf{A}=\begin{bmatrix}0 &amp; 0 &amp; 0 &amp;
f_4s_4\\s_1 &amp; 0 &amp; 0 &amp; 0\\0 &amp; s_2[1-g(\mathbf{n})] &amp;
s_3[1-g(\mathbf{n})] &amp; 0\\0 &amp; s_2g(\mathbf{n}) &amp;
s_3g(\mathbf{n}) &amp; s_4\end{bmatrix},\]</span> where <span
class="math inline">\(s_i\)</span> is the survival rate of stage <span
class="math inline">\(i\)</span>, <span
class="math inline">\(f_4\)</span> is the average number of female cubs
produced by a breeder. We let <span class="math inline">\(K\)</span> be
the maximum number of territories. <span
class="math inline">\(g=g(\mathbf{n})\)</span> is the probability that a
juvenile or a floater will acquire a territory (for breeding) next year,
which accounts for density dependence and is defined as follows: <span
class="math display">\[g(\mathbf{n})=\frac{K-s_4n_4(t)}{s_2n_2(t)+s_3n_3(t)}.\]</span>
It’s not hard to notice that <span class="math inline">\(g\)</span>
decreases when <span class="math inline">\(n_2\)</span>, <span
class="math inline">\(n_3\)</span> and <span
class="math inline">\(n_4\)</span> increase. When applying this method,
we should also notice the following two points:</p>
<ul>
<li><span class="math inline">\(n_4\)</span> should always be no larger
than <span class="math inline">\(K\)</span>. So if <span
class="math inline">\(n_4(t)&gt;K\)</span>, we should let <span
class="math inline">\(n_4(t)=K\)</span>, and update <span
class="math inline">\(n_3(t)\)</span> with <span
class="math inline">\(n_3(t)+K-n_4(t)\)</span>.</li>
<li>With the first point, we always have <span
class="math inline">\(g\geq 0\)</span>. It is still possible that <span
class="math inline">\(g&gt;1\)</span>, which is achieved when <span
class="math inline">\(K-s_4n_4(t)&gt;s_2n_2(t)+s_3n_3(t)\)</span>. So we
should always update <span class="math inline">\(g\)</span> with <span
class="math inline">\(\min\{g,1\}\)</span>.</li>
</ul>
<p>The R code below shows how thr breeder population and the total
population change when the maximum number of territories <span
class="math inline">\(K\)</span> is introduced:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the survival rates for each stage</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>s4 <span class="ot">&lt;-</span> <span class="fl">0.86</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproduction of a female breeder is calculated as</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (sex ratio)*(breeding prob)*(avg number of offsprings)</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.6</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the maximum number of territories</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Project forward for 50 years</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">51</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">51</span>, <span class="dv">0</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial population</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>n[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>n_total[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">+</span><span class="dv">2</span><span class="sc">+</span><span class="dv">0</span><span class="sc">+</span><span class="dv">5</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through 50 years of reproduction</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) {</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Force n4 to be at most K</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n[<span class="dv">4</span>, t] <span class="sc">&gt;</span> K) {</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    n[<span class="dv">4</span>, t] <span class="ot">&lt;-</span> K</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    n[<span class="dv">3</span>, t] <span class="ot">&lt;-</span> n[<span class="dv">3</span>, t] <span class="sc">+</span> (K <span class="sc">-</span> n[<span class="dv">4</span>, t])</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> (k <span class="sc">-</span> s4<span class="sc">*</span>n[<span class="dv">4</span>, t])<span class="sc">/</span>(s2<span class="sc">*</span>n[<span class="dv">2</span>, t] <span class="sc">+</span> s3<span class="sc">*</span>n[<span class="dv">3</span>, t])</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clip g between 0 and 1</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (g <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  A.data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, f4<span class="sc">*</span>s4,</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>              s1, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, s2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>g), s3<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>g), <span class="dv">0</span>,</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, s2<span class="sc">*</span>g, s3<span class="sc">*</span>g, s4)</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(A.data, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  n[, t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> A <span class="sc">%*%</span> n[, t]</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>  n_total[t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(n[, t<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<figure>
<img src="lynx.jpeg"
alt="(a) Number of breeders; (b) Total lynx population." />
<figcaption aria-hidden="true">(a) Number of breeders; (b) Total lynx
population.</figcaption>
</figure>
<h3
id="incorporating-density-dependent-functions-for-particular-vital-rates">Incorporating
density-dependent functions for particular vital rates</h3>
<p>Another way of incorporating density-dependence is to use
density-dependent functions to represent vital rates. Remember that in
an unstructured model, we can define a density-dependent model with a
differential equation (continuous) <span
class="math display">\[\frac{dN}{dt}=Ng(N),\]</span> or a difference
equation (discrete) <span
class="math display">\[N_{t+1}=N_t+N_tg(N_t)\]</span> where the per
capita growth rate <span class="math inline">\(g(N)\)</span> depends on
the population density <span class="math inline">\(N\)</span>. Two most
famous candidates for <span class="math inline">\(g(N)\)</span> are</p>
<ul>
<li>Beverton-Holt function: <span
class="math inline">\(g(N)=\frac{\alpha}{1+\beta N}\)</span>,</li>
<li>Ricker function: <span class="math inline">\(g(N)=\alpha e^{-\beta
N}.\)</span></li>
</ul>
<figure>
<img src="bh_ricker.jpeg"
alt="(a) Beverton-Holt function and Ricker function; (b) the corresponding recruitment functions. Here, we set \alpha=0.9 and \beta=0.05" />
<figcaption aria-hidden="true">(a) Beverton-Holt function and Ricker
function; (b) the corresponding recruitment functions. Here, we set
<span class="math inline">\(\alpha=0.9\)</span> and <span
class="math inline">\(\beta=0.05\)</span></figcaption>
</figure>
<p>Similarly, for a stage-structured model, we can also assume that one
or more vital rates depend on the number of individuals in one or more
stages. Let’s start with the simplest case. Consider a two-stage model
defined by the matrix <span
class="math display">\[\mathbf{A}=\begin{bmatrix}\sigma_1(1-\gamma)
&amp; \phi\\\sigma_1\gamma &amp; \sigma_2\end{bmatrix},\]</span> where
<span class="math inline">\(\sigma_1\)</span> and <span
class="math inline">\(\sigma_2\)</span> are survival rate at each stage,
<span class="math inline">\(\gamma\)</span> is the growth rate from
stage 1 to stage 2, and <span class="math inline">\(\phi\)</span> is the
fecundity rate from stage 2 to stage 1. Here we follow Caswell (2001),
but there is no difference between this and using a single variable to
represent each transition rate.</p>
<p>Let’s assume that vital rates are affected by the total population
<span class="math inline">\(N=n_1+n_2\)</span>. Here are some possible
density-dependent vital rates, using the Ricker function:</p>
<ul>
<li><em>Density-dependent fecundity</em>: <span
class="math inline">\(\phi\to\phi e^{-bN}\)</span></li>
<li><em>Density-dependent survival</em>: <span
class="math inline">\(\sigma_i\to \sigma_i e^{-bN},\
i\in\{1,2\}\)</span></li>
<li><em>Density-dependent growth</em>: <span
class="math inline">\(\gamma\to \gamma e^{-bN}\)</span></li>
<li>Combinations of the above rates</li>
</ul>
<h4 id="examples-with-density-dependent-fecunditygrowth">Examples with
density-dependent fecundity/growth</h4>
<p>Remember that when populations are changing according to the discrete
logistic equation, they can have qualitatively different dynamics,
depending on parameter values (monotonic approach to an equilibrium,
damped oscillations, limit cycles and chaos). Such phenomena exist in a
density-dependent matrix model as well.</p>
<p>We present an example with density-dependent fecundity where <span
class="math inline">\(\phi(N)=\phi e^{-N}\)</span>, and an example with
density-dependent growth where <span
class="math inline">\(\gamma(N)=\gamma e^{-N}\)</span>. We test
different values of <span
class="math inline">\(\phi=50,500,1800\)</span> for the
density-dependent fecundity model and <span
class="math inline">\(\phi=300\)</span> for the density-dependent growth
model. Other parameters are <span
class="math inline">\(\sigma_1=0.5\)</span>, <span
class="math inline">\(\sigma_2=0.1\)</span> and <span
class="math inline">\(\gamma=0.1\)</span>.</p>
<p>We will compare the following four projection matriceswith the same
initial population <span
class="math inline">\(\mathbf{n}(0)=[6,4]\)</span>: <span
class="math display">\[\mathbf{A}_1=\begin{bmatrix}0.45 &amp;
50e^{-N}\\0.05 &amp; 0.1\end{bmatrix},\ \mathbf{A}_2=\begin{bmatrix}0.45
&amp; 500e^{-N}\\0.05 &amp; 0.1\end{bmatrix},\
\mathbf{A}_3=\begin{bmatrix}0.5(1-0.1e^{-N}) &amp; 300\\0.5(0.1e^{-N})
&amp; 0.1\end{bmatrix},\ \mathbf{A}_4=\begin{bmatrix}0.45 &amp;
1800e^{-N}\\0.05 &amp; 0.1\end{bmatrix}.\]</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Project forward for 100 time steps</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">101</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">101</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">101</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>n4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">101</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial populations</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>n1[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>n2[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>n3[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>n4[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through 100 periods of reproduction</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.45</span>, <span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">sum</span>(n1[,t])), <span class="fl">0.05</span>, <span class="fl">0.1</span>),</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  A2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.45</span>, <span class="dv">500</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">sum</span>(n2[,t])), <span class="fl">0.05</span>, <span class="fl">0.1</span>),</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.5</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.1</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">sum</span>(n3[,t]))), <span class="dv">300</span>, </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>                 <span class="fl">0.5</span><span class="sc">*</span><span class="fl">0.1</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">sum</span>(n3[,t])), <span class="fl">0.1</span>),</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  A4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.45</span>, <span class="dv">1800</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">sum</span>(n4[,t])), <span class="fl">0.05</span>, <span class="fl">0.1</span>),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  n1[, t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> A1 <span class="sc">%*%</span> n1[, t]</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  n2[, t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> A2 <span class="sc">%*%</span> n2[, t]</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  n3[, t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> A3 <span class="sc">%*%</span> n3[, t]</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  n4[, t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> A4 <span class="sc">%*%</span> n4[, t]</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<figure>
<img src="attractors.jpeg" style="width:75.0%"
alt="(a,c,e,g) Attractors; (b,d,f,h) dynamics of corresponding attractors." />
<figcaption aria-hidden="true">(a,c,e,g) Attractors; (b,d,f,h) dynamics
of corresponding attractors.</figcaption>
</figure>
<h3
id="illustration-of-current-application-lake-sturgeon-population">Illustration
of current application: Lake sturgeon population</h3>
<p>Here we present a recent study on lake sturgeon population with
density-dependent effects:</p>
<p>Burchfield, J.D., McLaren, B.E., and McLeod, D.T. (2022). Sensitivity
analysis of a lake sturgeon population with early life stage
density-dependent effects, <em>Canadian Journal of Fisheries and Aquatic
Sciences</em>, <em>79</em>(11), 1992-2005.</p>
<figure>
<img src="lake_sturgeon.jpg"
alt="© USFWS, Lake sturgeon (Acipenser fulvescens), Public domain" />
<figcaption aria-hidden="true">© USFWS, <a
href="https://commons.wikimedia.org/wiki/File:Lake_sturgeon_(22582474091).jpg">Lake
sturgeon (<em>Acipenser fulvescens</em>)</a>, Public domain</figcaption>
</figure>
<p>The authors composed a Lefkovitch projection matrix (Lefkovitch,
1965) with six stages: age-0, juvenile, early subadult, late subadult,
early adult and late adult, with the following projection matrix <span
class="math display">\[\mathbf{A}=\begin{bmatrix}0 &amp; 0 &amp; 0 &amp;
S_3G_3f_4 &amp; S_4(1-G_4)f_4+S_4G_4f_5 &amp; S_5(1-G_5)f_5\\S_0G_0
&amp; S_1(1-G_1) &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; S_1G_1 &amp;
S_2(1-G_2) &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; S_2G_2 &amp;
S_3(1-G_3) &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; S_3G_3 &amp;
S_4(1-G_4) &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; S_4G_4 &amp;
S_5(1-G_5)\end{bmatrix},\]</span> where <span
class="math inline">\(S_i\)</span> is the survival rate at stage <span
class="math inline">\(i\)</span>, <span
class="math inline">\(G_i\)</span> is the transition rate from stage
<span class="math inline">\(i\)</span> to stage <span
class="math inline">\(i+1\)</span>, and <span
class="math inline">\(f_i\)</span> is the fecundity rate (only for
adults). Density dependence in lake sturgeon is found in the juvenile
stage (McDougall et at., 2018), and is introduced with a Ricker function
on <span class="math inline">\(G_0\)</span> <span
class="math display">\[G_0=\exp\left[r\left(1-\frac{S_0n_0+S_1n_1}{K_j}\right)\right],\]</span>
where <span class="math inline">\(K_j\)</span> is the juvenile carrying
capacity. Here is a sample simulation code (with parameter values
presented in the paper). We also plot the trajectories of adult
population as they are reproductive.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to calculate the stage transition rate</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using the age-structured method, shown in Burchfield et al. (2022)</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>growth <span class="ot">&lt;-</span> <span class="cf">function</span>(S, D) {</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S: survival rate</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># D: duration of the stage in years</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D) {</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> total <span class="sc">+</span> S<span class="sc">^</span>i</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (S<span class="sc">^</span>D<span class="sc">/</span>total)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Project forward for 150 years</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">151</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial population</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>n[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the survival rates</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.665</span><span class="sc">/</span><span class="dv">100</span>, <span class="fl">65.55</span><span class="sc">/</span><span class="dv">100</span>, <span class="fl">77.45</span><span class="sc">/</span><span class="dv">100</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">77.45</span><span class="sc">/</span><span class="dv">100</span>, <span class="fl">94.8</span><span class="sc">/</span><span class="dv">100</span>, <span class="fl">94.8</span><span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the duration of each stage</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">24</span>, <span class="dv">22</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the fecundity rates</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">13166</span>, <span class="dv">31656</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the carrying capacity for juvenile sturgeons</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>Kj <span class="ot">&lt;-</span> <span class="dv">9280</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through 100 years of reproduction</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>) {</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  G0 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">2.3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(S[<span class="dv">1</span>]<span class="sc">*</span>n[<span class="dv">1</span>,t]<span class="sc">+</span>S[<span class="dv">2</span>]<span class="sc">*</span>n[<span class="dv">2</span>,t])<span class="sc">/</span>Kj))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  G1 <span class="ot">&lt;-</span> <span class="fu">growth</span>(S[<span class="dv">2</span>], D[<span class="dv">2</span>])</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  G2 <span class="ot">&lt;-</span> <span class="fu">growth</span>(S[<span class="dv">3</span>], D[<span class="dv">3</span>])</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  G3 <span class="ot">&lt;-</span> <span class="fu">growth</span>(S[<span class="dv">4</span>], D[<span class="dv">4</span>])</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  G4 <span class="ot">&lt;-</span> <span class="fu">growth</span>(S[<span class="dv">5</span>], D[<span class="dv">5</span>])</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  G5 <span class="ot">&lt;-</span> <span class="fu">growth</span>(S[<span class="dv">6</span>], D[<span class="dv">6</span>])</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, S[<span class="dv">4</span>]<span class="sc">*</span>G3<span class="sc">*</span>f[<span class="dv">5</span>], S[<span class="dv">5</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G4)<span class="sc">*</span>f[<span class="dv">5</span>]<span class="sc">+</span>S[<span class="dv">5</span>]<span class="sc">*</span>G4<span class="sc">*</span>f[<span class="dv">6</span>], S[<span class="dv">6</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G5)<span class="sc">*</span>f[<span class="dv">6</span>],</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                S[<span class="dv">1</span>]<span class="sc">*</span>G0, S[<span class="dv">2</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G1), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>, S[<span class="dv">2</span>]<span class="sc">*</span>G1, S[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G2), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>, <span class="dv">0</span>, S[<span class="dv">3</span>]<span class="sc">*</span>G2, S[<span class="dv">4</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G3), <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, S[<span class="dv">4</span>]<span class="sc">*</span>G3, S[<span class="dv">5</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G4), <span class="dv">0</span>,</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, S[<span class="dv">5</span>]<span class="sc">*</span>G4, S[<span class="dv">6</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>G5)),</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  n[, t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> A <span class="sc">%*%</span> n[, t]</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<figure>
<img src="lake_sturgeon_simulation.jpeg" style="width:80.0%"
alt="Population trajectories of adult lake sturgeons, with an initial population of 10 early adults" />
<figcaption aria-hidden="true">Population trajectories of adult lake
sturgeons, with an initial population of 10 early adults</figcaption>
</figure>
<h4 id="snapshot-of-the-study-2">Snapshot of the study</h4>
<ul>
<li><p>In this study, density dependence is limited to the juvenile
stage. The adult population stabilizes at an equilibrium proportional to
the juvenile carrying capacity. The authors also argued that varying
juvenile carrying capacity in the model affects the equilibrium
abundance of adults in a slow process.</p></li>
<li><p>The authors emphasized the importance of including a
density-dependent factor in the modeling of the lake sturgeon’s early
life stages because it restricts the population’s unlimited exponential
growth. This highlights the need for caution when using
density-dependent models to estimate the time it will take for the
population to recover and increase.</p></li>
</ul>
<h2 id="environmental-stochasticity-in-matrix-models">Environmental
stochasticity in matrix models</h2>
<h3 id="environmental-conditions-are-not-constant-in-time">Environmental
conditions are not constant in time</h3>
<p>We saw in the section on unstructured population models,
environmental stochasticity can act to change the rate of population
increase. Similarly, we may expect impacts of temporal variation in
environmental conditions on structured populations (e.g., good years may
increase reproductive rate, bad years might decrease survivorship or
somatic growth rates)</p>
<p>In this case our population size and structure at time t+1 will
depend on a time varying projection matrix, A(t), as: <span
class="math display">\[\boldsymbol{n}(t+1)=\boldsymbol{A}(t)\boldsymbol{n}(t)=\boldsymbol{A}(t)\boldsymbol{A}(t-1)
\ldots \boldsymbol{A}(0)\boldsymbol{n}_0\]</span></p>
<h3
id="simplest-method-of-including-temporal-environmental-stochasticity">Simplest
method of including temporal environmental stochasticity</h3>
<p>The simplest method to add environmental variation is to use actual
projection matrices measured from a number of different time periods. We
can then randomly select a matrix to use for each projected time
interval, multiply by the population vector and repeat the process many
times. This method is analogous to randomly selecting a per capita
growth rate for each time interval in an unstructured model, and
similarly preserves any correlations between life history
components.</p>
<p>In addition, this simple process can accommodate autocorrelation or
regular cycles in environmental factors. For example we could randomly
sample from matrices appropriate to each part of a cycle or estimate the
correlation between different environmental conditions and ensure our
sampling routine takes this correlation into account</p>
<h3 id="other-methods-of-incorporating-temporal-stochasticity">Other
methods of incorporating temporal stochasticity</h3>
<p>There are at least two other methods of including environmental
stochasticity. So, we have our simple method:</p>
<ol type="1">
<li>assume a limited # of discrete environmental states, and randomly
draw a matrix that corresponds to the frequency and autocorrelation of
those environmental states (see Morris and Doak 2002). This is probably
only feasible for a small number of states (e.g. wet years vs dry
years)).</li>
</ol>
<p>However, if we know how vital rates depend on environmental variable
(e.g., thru thermal performance curves), we can</p>
<ol start="2" type="1">
<li>generate random environmental conditions with appropriate
autocorrelation or cycles, calculate life history rates from those
conditions, and then construct a projection matrix for that year. This
may requires lots of data!</li>
</ol>
<p>We can also, 3. form matrices by drawing vital rates from appropriate
statistical distributions (Caswell 2001, Morris and Doak 2002, Kaye and
Pyke 2003).</p>
<h3 id="stochastic-population-growth-rate">Stochastic population growth
rate</h3>
<p>Caswell (2019) provides proof that for small fluctuations, the long
run stochastic growth rate does exist. We can estimate the stochastic
population growth rate (<span class="math inline">\(\lambda_S\)</span>)
via simulation. To do so we need to 1. project population size for many
years using random matrices 2. calculate the arithmetic mean of <span
class="math inline">\(ln(N_{t+1}/N_t)\)</span> to approximate <span
class="math inline">\(\lambda_S\)</span> as:<br />
<span class="math display">\[log \lambda_S \approx \lim_{t \to
\infty}\frac{1}{t} log \left[\frac{N(t)}{N(0)}\right] \]</span></p>
<p>We will need tens of thousands of growth increments for reasonable
estimates</p>
<p>We can also estimate the stochastic population growth rate (<span
class="math inline">\(\lambda_S\)</span>) using Tuljapurkar’s small
fluctuation approximation. This method requires that we assume that
variation among the matrices for each time internal is not large, and
that the matrix elements are uncorrelated from one time interval to the
next. The formula is:<br />
<span class="math display">\[ ln \lambda_S \approx ln
\bar{\lambda}_1-\frac{1}{2}\left(\frac{\tau^2}{\bar{\lambda}_1^2}\right),
\]</span> where <span class="math inline">\(\bar{\lambda}_1\)</span> is
the dominant eigenvalue of the mean matrix <span
class="math inline">\(\bar{A}\)</span> which we would obtain by
averaging each element of our time interval specific matrices, where the
we weight this mean by the frequency with which they are expected to
occur. The quantity <span class="math inline">\(\tau^2\)</span> is given
as: <span class="math inline">\(\tau^2 =
\sum^{S}_{i=1}\sum^{S}_{j=1}\sum^{S}_{k=1}\sum^{S}_{l=1}Cov(a_{ij},
a_{k,l})\bar{S}_{ij}\bar{S}_{lk}.\)</span></p>
<p>The formula illustrates that for larger variance we have a smaller
population growth rate. The term <span
class="math inline">\(\left(\frac{\tau^2}{\bar{\lambda}_1^2}\right)\)</span>
approximates the temporal variance of the log population growth rate
caused by environmental stochasticity, and is the equivalent of <span
class="math inline">\(\sigma^2\)</span> for unstructured populations. We
can see from the equation <span class="math inline">\(ln \lambda_S
\approx ln
\bar{\lambda}_1-\frac{1}{2}\left(\frac{\tau^2}{\bar{\lambda}_1^2}\right)\)</span>
, that an increase in variance, as measured by <span
class="math inline">\(\left(\frac{\tau^2}{\bar{\lambda}_1^2}\right)\)</span>
will decrease the population growth rate.</p>
<p>Next, <span class="math inline">\(\bar{S_{ij}}\)</span> is the
sensitivity of <span class="math inline">\(\bar{\lambda}_1\)</span> to
changes in <span class="math inline">\(\bar{a_{ij}}\)</span>. So, we
expect variation in a given matrix element <span
class="math inline">\(a_{ij}\)</span> will contribute to variation in
the growth rate only to the extent that the population growth responds,
or is sensitive, to that matrix element, and the variation is relatively
large</p>
<h3 id="covariance-between-matrix-elements">Covariance between matrix
elements</h3>
<p>It is reasonable to expect both positive and negative covariance
between matrix elements (e.g., good years for reproduction in age 3
individuals also likely to be good for 4-year-olds). Further, good
environmental conditions may be good for both reproduction and survival,
or reproduction may come at a cost for somatic growth</p>
<p>In our equation the quantity <span
class="math inline">\(Cov(a_{ij}a_{kl})\)</span> is the covariance
between matrix elements <span class="math inline">\(a_{ij}\)</span> and
<span class="math inline">\(a_{kl}\)</span>. If <span
class="math inline">\(i \neq k\)</span> and <span
class="math inline">\(j \neq l\)</span> we have two different matrix
elements and <span class="math inline">\(Cov(a_{ij}a_{kl})\)</span> is a
measure of the tendency of the two elements to change in synchrony
across time intervals. If <span class="math inline">\(i=k\)</span> and
<span class="math inline">\(j=l\)</span>, then we have the same element,
and this is just a measure of variance over different time intervals</p>
<p>A positive correlation between two matrix elements mean that either
both will be high or low will tend to cause larger variation in the
population growth rate, while a negative correlation will cause a
tendency for the impacts of variation to to “cancel out” with reduced
variation on population growth rate.</p>
<h3 id="sensitivity-analysis-for-stochastic-matrix-models">Sensitivity
analysis for stochastic matrix models</h3>
<p>Caswell (2001) argued that deterministic sensitivity values for a
mean matrix are generally good approximations for stochastic matrix
models. This is probably reasonable for long-lived organisms that are
reasonably buffered from environmental stochasticity, but less likely to
be true for short-lived organisms highly influenced by environmental
conditions.</p>
<p>It is more complicated to complete sensitivity analysis for
stochastic models because we need to incorporate mean rates, variances,
covariances, and characterisitics of the environmental temporal
variation</p>
<p>### Sensitivity analysis of the long term growth rate</p>
<p>When calculating the sensitivities of a stochastic matrix model, we
will need to use the time‐specific stage distribution <span
class="math inline">\(\boldsymbol{w}(t)\)</span>, the time‐specific
reproductive value vector <span
class="math inline">\(\boldsymbol{v}(t)\)</span>, and the time-specific
population growth rate <span class="math inline">\(\lambda_t\)</span>.
This last term is calculated as <span
class="math inline">\(\lambda_t=\frac{e^T \boldsymbol{n}(t+1)}{e^T
\boldsymbol{n}(t)}\)</span> where <span
class="math inline">\(e^T\)</span> is a vector of ones
(Tuljapurkar 1990).</p>
<p>Caswell (2005) showed that the sensitivity of long‐run population
growth to a parameter <span class="math inline">\(\theta\)</span> (with
current value <span class="math inline">\(\\theta^*\)</span>) upon which
some demographic rates depend is: <span
class="math display">\[\frac{\partial ln \lambda_S}{\partial
\theta}=\lim_{L\to\infty}\frac{1}{L}\sum^{L-1}_{t=0}\frac{\boldsymbol{v}^T(1+1)\frac{\partial
\boldsymbol{A}(t)}{\partial \theta}\boldsymbol{w}(t)}{\lambda_t
\boldsymbol{v}^T(t+1)\boldsymbol{w}(t+1)} \]</span></p>
<p>which is a stochastic analog of the previous expression for
sensitivity analysis, where the derivative should be understood as
evaluated at <span class="math inline">\(\theta\)</span> =<span
class="math inline">\(\theta^*\)</span> .</p>
<p>The main approach to estimate <span
class="math inline">\(\frac{\partial ln \lambda_S}{\partial
\theta}\)</span> is via stochastic simulations (Caswell, 2001, Morris
&amp; Doak 2002)</p>
<h2 id="references-4">References</h2>
<p>Bialic-Murphy, L., Knight, T. M., Kawelo, K., &amp; Gaoue, O. G.
(2022). The Disconnect Between Short-and Long-Term Population
Projections for Plant Reintroductions. <em>Frontiers in Conservation
Science</em>, <em>2</em>, 124.</p>
<p>Biek, Roman, W. Chris Funk, Bryce A. Maxell, and L. Scott Mills.
2002. “What Is Missing in Amphibian Decline Research: Insights from
Ecological Sensitivity Analysis.” <em>Conservation Biology, 16</em> (3):
728–34.</p>
<p>Case, Ted J. 2000. <em>An Illustrated Guide to Theoretical
Ecology</em>. New York: Oxford University Press.</p>
<p>Caswell, H. (2001). <em>Matrix Population Models</em>. Sinauer
Associates, Sunderland, MA.</p>
<p>Caswell, H. (2019). Introduction: Sensitivity Analysis–What and Why?.
<em>Sensitivity Analysis: Matrix Methods in Demography and Ecology</em>,
3-12.</p>
<p>Choi, W. I., Lee, D. H., Jung, J. B., &amp; Park, Y. S. (2022). Oak
decline syndrome in Korean forests: History, biology, and prospects for
Korean oak wilt. <em>Forests, 13</em>(6), 964.</p>
<p>Coulson, T., E. A. Catchpole, S. D. Albon, B. J. T. Morgan, J. M.
Pemberton, T. H. Clutton-Brock, M. J. Crawley, and B. T. Grenfell. 2001.
“Age, Sex, Density, Winter Weather, and Population Crashes in Soay
Sheep.” <em>Science, 292</em> (5521): 1528–31.</p>
<p>Crouse, D. T., Crowder, L. B., &amp; Caswell, H. (1987). A
stage‐based population model for loggerhead sea turtles and implications
for conservation. <em>Ecology, 68</em>(5), 1412-1423.</p>
<p>Finkbeiner, E. M., Wallace, B. P., Moore, J. E., Lewison, R. L.,
Crowder, L. B., &amp; Read, A. J. (2011). Cumulative estimates of sea
turtle bycatch and mortality in USA fisheries between 1990 and 2007.
<em>Biological Conservation, 144</em>(11), 2719-2727.</p>
<p>Gaillard, Jean-Michel, Marco Festa-Bianchet, and Nigel G. Yoccoz.
2001. “Not All Sheep Are Equal.” <em>Science, 292</em> (5521):
1499–1500.</p>
<p>Gaona, P., Ferreras, P., and Delibes, M. (1998). Dynamics and
viability of a metapopulation of the endangered Iberian lynx (Lynx
pardinus). <em>Ecological Monographs</em>, <em>68</em>(3), 349-370.</p>
<p>Gonzalez de Leon, S., Herrera, I., &amp; Guevara, R. (2016). Mating
system, population growth, and management scenario for <em>Kalanchoe
pinnata</em> in an invaded seasonally dry tropical forest. <em>Ecology
and evolution, 6</em>(13), 4541-4550.</p>
<p>Kaye, T. N., &amp; Pyke, D. A. (2003). The effect of stochastic
technique on estimates of population viability from transition matrix
models. <em>Ecology</em>, <em>84</em>(6), 1464-1476.</p>
<p>Lefkovitch, L. P. 1965. “The Study of Population Growth in Organisms
Grouped by Stages.” <em>Biometrics, 21</em> (1): 1–18.</p>
<p>Leslie, P. H. 1945. “On the Use of Matrices in Certain Population
Mathematics.” <em>Biometrika, 33</em> (3): 183–212.</p>
<p>Leslie, P. H. 1948. “Some Further Notes on the Use of Matrices in
Population Mathematics.” <em>Biometrika, 35</em> (3/4): 213–45.
https://doi.org/10.2307/2332342.</p>
<p>Manlik, O., Lacy, R. C., &amp; Sherwin, W. B. (2018). Applicability
and limitations of sensitivity analyses for wildlife management.
<em>Journal of Applied Ecology, 55</em>(3), 1430-1440.</p>
<p>McDougall, C.A., Nelson, P.A. and Barth, C.C. (2018). Extrinsic
factors influencing somatic growth of lake sturgeon. <em>Trans. Am.
Fish. Soc.</em>, <em>147</em>, 459–479.</p>
<p>Mills, L. Scott. 2013. <em>Conservation of Wildlife Populations :
Demography, Genetics, and Management</em>. 2nd ed. Chichester, West
Sussex ; Wiley-Blackwell.</p>
<p>Morris, W.F. and Doak, D.F. (2002). <em>Quantitative Conservation
Biology</em>. Sinauer, Sunderland, MA.</p>
<p>Tuljapurkar, S. D. (1982). Population dynamics in variable
environments. II. Correlated environments, sensitivity analysis and
dynamics. <em>Theoretical Population Biology</em>, <em>21</em>(1),
114-140.</p>
<p>Tuljapurkar, S., &amp; Haridas, C. V. (2006). Temporal
autocorrelation and stochastic population growth. <em>Ecology
Letters</em>, <em>9</em>(3), 327-337.</p>
<p>Vimercati, Giovanni. 2017. “Exploring the Invasion of the Guttural
Toad Sclerophrys Gutturalis in Cape Town Through a Multidisciplinary
Approach.” {PhD} {Thesis}, Stellenbosch: Stellenbosch University.</p>
<p>Vimercati, Giovanni, Sarah J. Davies, Cang Hui, and John Measey.
2021. “Cost-Benefit Evaluation of Management Strategies for an Invasive
Amphibian with a Stage-Structured Model.” <em>NeoBiota, 70</em>:
87–105.</p>
<h1 id="integral-projection-models">Integral Projection Models</h1>
<p>This chapter covers a more advanced topic in (structured) population
modelling, integral projection models (IPM). We will first
<strong>derive the formula</strong> for IPM analogously to what we
learned in Chapter 2, matrix projection models (MPM). Next, we will
introduce the method to <strong>build simple IPM</strong> with case
studies. We will then move on to the analysis of IPM, including
<strong>asymptotic behaviors, sensitivity and elasticity</strong>.
Lastly, we will incorporate <strong>density-dependence and
stochasticity</strong> into our IPM, just as what we did in previous
chapters.</p>
<h2 id="learning-outcomes-1">Learning outcomes</h2>
<ul>
<li>Understand the analogy between IPM and MPM, and the mathematics
behind IPM</li>
<li>Being able to choose the proper model for different species based on
their life cycles, and construct simple IPM from data</li>
<li>Getting familiar with various numerical methods, such as regression,
numerical integration</li>
<li>Being able to perform basic analysis of IPM</li>
</ul>
<h2 id="introduction-mpm-vs.-ipm">Introduction: MPM vs. IPM</h2>
<p><strong>Matrix projection models (MPM)</strong> are widely used in
modelling structured biological populations. They are easy to understand
and are conceptually simple to represent population structures. A matrix
model divides the population into a set of classes, which give rise to
some potential problems (Ellner and Rees, 2006):</p>
<ul>
<li>Representing individuals with different characteristics as a
distinct stage or category is bound to introduce some amount of
inaccuracy</li>
<li>Increasing the number of stages leads to higher sampling error
because of fewer available data</li>
</ul>
<p>In fact, for some organisms, instead of dividing their life cycles
into discrete classes (e.g. juveniles and adults), it is more
appropriate to use continuous variables (e.g. body size) (Ellner and
Rees, 2006). Easterling et al. (2000) proposed <strong>integral
projection models (IPM)</strong> as an alternative to MPM for
populations in which demographic rates are primarily influenced by a
continuous variable. This kind of model was analogous to MPM, allowing
researchers to avoid inaccurate classifications.</p>
<h2 id="contruction-of-ipm">Contruction of IPM</h2>
<p>In this section, we will introduce the basic concepts underlying IPM.
We will make the assumption that differences between individuals in a
population are completely described by a <strong>continuous</strong>
variable <span class="math inline">\(z\)</span>, which could be some
continuous measure of body size (e.g. total mass and volume). <span
class="math inline">\(z\)</span> could also be unrelated to “size”, such
as the individual’s spatial location in a linear habitat. However, <span
class="math inline">\(z\)</span> must have finite limits.</p>
<h3 id="model-structure">Model structure</h3>
<p>Let <span class="math inline">\(n(z,t)\)</span> be the size
distribution of individuals at time <span
class="math inline">\(t\)</span>. The number of individuals with size
<span class="math inline">\(z\)</span> in the interval <span
class="math inline">\([a,b]\)</span> is <span
class="math display">\[\int_a^bn(z,t)\ dz.\]</span></p>
<p>This may seem a bit hard to follow. Here we present a more intuitive
description:</p>
<blockquote>
<p>The number of individuals in the size interval <span
class="math inline">\([a,b]\)</span> at time <span
class="math inline">\(t\)</span> is approximately <span
class="math inline">\(n(a,t)(b-a)\)</span>, given a very small
difference <span class="math inline">\(b-a\)</span>.</p>
</blockquote>
<p>This comes directly from the intuition behind an integral, which we
will show in the following figures:</p>
<figure>
<img src="integral.jpeg" style="width:80.0%"
alt="Illustration of an integral with its rectangular approximation" />
<figcaption aria-hidden="true">Illustration of an integral with its
rectangular approximation</figcaption>
</figure>
<p>The integral <span class="math inline">\(\int_a^bn(z,t)\ dz\)</span>
is equal to the area under the curve, which is shaded in red (stripe);
<span class="math inline">\(n(a,t)(b-a)\)</span> is equal to the
rectangular area shaded in red (stripe) <strong>and</strong> blue
(solid). When <span class="math inline">\(b\)</span> is close enough to
<span class="math inline">\(a\)</span>, the blue area is small enough to
be ignored, making <span class="math display">\[\int_a^bn(z,t)\
dz\approx n(a,t)(b-a).\]</span></p>
<p>Now if we assume the limit of <span class="math inline">\(z\)</span>
is from <span class="math inline">\(L\)</span> to <span
class="math inline">\(U\)</span> (i.e. <span
class="math inline">\(z\in[L,U]\)</span>), the total population is the
integral of <span class="math inline">\(n(z,t)\)</span> over the domain
<span class="math inline">\([L,U]\)</span>, <span
class="math display">\[N(t)=\int_L^Un(z,t)\ dz.\]</span> We should
notice that <span class="math inline">\(n(z,t)\)</span> is different
from a probability distribution, whose integral over the domain is
<strong>1</strong>. Another thing we should notice is that <span
class="math inline">\(n(z,t)\)</span> is <strong>NOT</strong> the number
of individuals of size <span class="math inline">\(z\)</span> at time
<span class="math inline">\(t\)</span>. If we want to know the number of
individuals in a size range, we have to calculate the integral.</p>
<h3 id="kernel">Kernel</h3>
<p>Similar to MPM, IPM also operates in discrete time. From <span
class="math inline">\(t\)</span> to <span
class="math inline">\(t+1\)</span>, individuals could die or change in
size. They could also produce offsprings that vary in size. We use two
functions, <span class="math inline">\(P(z&#39;,z)\)</span> and <span
class="math inline">\(F(z&#39;,z)\)</span>, to describe these two types
of size transitions (and for convenience, we further let <span
class="math inline">\(z&#39;\)</span> be the size at time <span
class="math inline">\(t+1\)</span>). The total transition is represented
by <span
class="math inline">\(K(z&#39;,z)=P(z&#39;,z)+F(z&#39;,z)\)</span>,
which is called the <strong>kernel</strong>.</p>
<h4 id="survivalgrowth-kernel">Survival/growth kernel</h4>
<p><span class="math inline">\(P(z&#39;,z)\)</span> is called the
<strong>survival/growth kernel</strong> (Merow et al., 2014), which is
often written as <span
class="math inline">\(P(z&#39;,z)=s(z)G(z&#39;,z)\)</span>, where <span
class="math inline">\(s(z)\)</span> is the survival rate and <span
class="math inline">\(G(z&#39;,z)\)</span> represents the size
transition. We can think of <span
class="math inline">\(G(z&#39;,z)\)</span> as the probability density
function of the subsequent size <span
class="math inline">\(z&#39;\)</span> of an size-<span
class="math inline">\(z\)</span> individual, so we always have <span
class="math display">\[\int_L^UG(z&#39;,z)\ dz&#39;=1.\]</span> The idea
can be explained with the following plot</p>
<figure>
<img src="size-dist.jpeg" style="width:80.0%"
alt="Illustration of size transitions and G(z&#39;,z)" />
<figcaption aria-hidden="true">Illustration of size transitions and
<span class="math inline">\(G(z&#39;,z)\)</span></figcaption>
</figure>
<p>Suppose that we have collected data of sizes at <span
class="math inline">\(t\)</span> and <span
class="math inline">\(t+1\)</span>, we assume that, for every <span
class="math inline">\(z\)</span>, the subsequent size <span
class="math inline">\(z&#39;\)</span> follows some probability
distribution, which is represented by the red curves.</p>
<h4 id="fecundity-kernel">Fecundity kernel</h4>
<p><span class="math inline">\(F(z&#39;,z)\)</span> is called the
<strong>fecundity kernel</strong> (Merow et al., 2014), which represents
reproduction of offsprings. <span
class="math inline">\(F(z&#39;,z)\)</span> is analogous to a probability
density function. It is the size distribution of offsprings produced by
a size-<span class="math inline">\(z\)</span> individual. In other
words, the number of the offsprings of size <span
class="math inline">\(z&#39;\)</span> in the interval <span
class="math inline">\([a,b]\)</span> by a size-<span
class="math inline">\(z\)</span> individual is <span
class="math display">\[\int_a^bF(z&#39;,z)\ dz&#39;.\]</span> That is,
it follows a similar idea of <span
class="math inline">\(n(z,t)\)</span>.</p>
<p>Now, putting everything together, the population size distribution at
time <span class="math inline">\(t+1\)</span> can be calculated as the
integral <span
class="math display">\[n(z&#39;,t+1)=\int_L^UK(z&#39;,z)n(z,t)\
dz.\]</span> The kernel <span class="math inline">\(K(z&#39;,z)\)</span>
in the IPM is analogous to the projection matrix in MPM.</p>
<h3 id="from-life-cycle-to-model">From life cycle to model</h3>
<p>An essential step of building an IPM is to translate population
census data into the vital rates in the kernel.</p>
<h4 id="population-census">Population census</h4>
<p>First, we introduce two different census methods:</p>
<ul>
<li><em>Pre-reproductive census</em>: Census takes place before
reproduction. This is common in plants, as the size of offsprings are
hard to collect before growth to noticeable small individuals.</li>
</ul>
<p><img src="pre-repro.jpg" style="width:70.0%" /></p>
<ul>
<li><em>Post-reproductive census</em>: Census takes place after
reproduction. This is more common in animals, when we can easily
distinguish newborns from adults and measure their sizes.</li>
</ul>
<p><img src="post-repro.jpg" style="width:70.0%" /></p>
<h4 id="building-kernels">Building kernels</h4>
<p>Once we decided the census method, and collected data at each time
point, it’s time to build the kernel for our IPM, which will be divided
into two parts:</p>
<ul>
<li><em>Survival</em>: After we observed the number of individuals
survived from each census to the next, we can estimate the survival rate
<span class="math inline">\(s\)</span>. By recording the size changes,
we can also obtain the distribution of size transition <span
class="math inline">\(G\)</span>.</li>
<li><em>Reproduction</em>: We can estimate some basic parameters: per
capita offspring number <span class="math inline">\(b\)</span>, and
probability of successful recruitment <span
class="math inline">\(p_r\)</span>. When we are able to distinguish
breeders and non-breeders, we can further define the probability of
reproducing <span class="math inline">\(p_b\)</span>. Similarly, by
recording the recruit sizes, we can also obtain the size distribution of
recruits, <span class="math inline">\(C\)</span>.</li>
</ul>
<p>For different census methods, kernels are defined differently. Here
we present the most basic situations for both census methods.</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 41%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Pre-reproductive census</th>
<th style="text-align: left;">Post-reproductive census</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Survival kernel</strong></td>
<td style="text-align: left;"><span
class="math inline">\(s(z)G(z&#39;,z)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(s(z)G(z&#39;,z)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Fecundity kernel</strong></td>
<td style="text-align: left;"><span
class="math inline">\(p_b(z)b(z)p_rC(z&#39;,z)\)</span></td>
<td style="text-align: left;"><span
class="math inline">\(s(z)p_b(z)b(z)C(z&#39;,z)\)</span></td>
</tr>
</tbody>
</table>
<p>The survival kernel is pretty much the same, while the fecundity
kernel is slightly different between two census methods. This is
because</p>
<ul>
<li>In a <strong>post-reproductive census</strong>, new recruits are
censused before mortality, so every new recruit is essentially
“successful”, making <span class="math inline">\(p_r=1\)</span> in the
fecundity kernel.</li>
<li>In a <strong>pre-reproductive census</strong>, since the census
happens right before reproduction, it is usually assumed that no death
occurs between census and reproduction, making <span
class="math inline">\(s(z)=1\)</span> in the fecundity kernel.</li>
</ul>
<p>Now, let’s first look at the total population at the time <span
class="math inline">\(t+1\)</span>, <span
class="math inline">\(N(t+1)\)</span>. It can be calculated as <span
class="math display">\[N(t+1)=\int_L^U\underbrace{[s(z)+p_b(z)b(z)p_r]}_{\text{kernel}}n(z,t)\
dz\]</span> in a pre-reproductive census. Considering the size
transition, we further have <span
class="math display">\[n(z&#39;,t+1)=\int_L^U\underbrace{[s(z)G(z&#39;,z)+p_b(z)b(z)p_rC(z&#39;,z)]}_{\text{kernel}}n(z,t)\
dz.\]</span></p>
<p>Similarly, in a post-reproductive census, we have <span
class="math display">\[n(z&#39;,t+1)=\int_L^U\underbrace{[s(z)G(z&#39;,z)+s(z)p_b(z)b(z)C(z&#39;,z)]}_{\text{kernel}}n(z,t)\
dz.\]</span></p>
<p><em>Note</em>: based on different census methods, the recruit size
distribution <span class="math inline">\(C(z&#39;,z)\)</span> will be
different. For <strong>pre-reproductive census</strong>, <span
class="math inline">\(C(z&#39;,z)\)</span> is the size distribution of
new recruits at age 1 (after they grow to noticeable individuals after
one year), so we denote it as <span
class="math inline">\(C_1(z&#39;,z)\)</span>; for
<strong>post-reproductive census</strong>, <span
class="math inline">\(C(z&#39;,z)\)</span> is the size distribution of
new recruits at age 0 (immediately after they are born), so we denote it
as <span class="math inline">\(C_0(z&#39;,z)\)</span>.</p>
<h3 id="vital-rates-with-examples">Vital rates with examples</h3>
<p>Here, we present some examples of kernels based on life cycles of
different species.</p>
<h4 id="example-1-long-lived-perennial-plant-with-no-seed-bank">Example
1: long-lived perennial plant with no seed bank</h4>
<p>This example comes from Merow et al. (2014) and it represents the
most basic case. For plants, key life history transitions usually depend
more on size than on age (Ellner et al., 2016). We assume that once
seeds germinate, individuals grow until they are large enough to produce
seeds, after which they continue to reproduce until they die. The
survival/growth kernel is <span
class="math display">\[P(z&#39;,z)=s(z)G(z&#39;,z),\]</span> and the
fecundity kernel is <span
class="math display">\[F(z&#39;,z)=p_b(z)b(z)p_rC_1(z&#39;).\]</span>
The kernel is just the sum <span
class="math display">\[K(z&#39;,z)=s(z)G(z&#39;,z)+p_b(z)b(z)p_rC_1(z&#39;).\]</span>
We should notice that</p>
<ul>
<li><span class="math inline">\(p_r\)</span> describes the ratio of
recruits observed at <span class="math inline">\(t+1\)</span> compared
to the seeds produced at <span class="math inline">\(t\)</span> (Metcalf
et al., 2008).</li>
<li><span class="math inline">\(C_1(z&#39;)\)</span> is size
distribution of recruits observed at time <span
class="math inline">\(t+1\)</span>. It does not depend on <span
class="math inline">\(z\)</span>, since we do not know the parental
size.</li>
</ul>
<h4 id="example-2-monocarpic-perennial">Example 2: monocarpic
perennial</h4>
<p>The following two examples were discussed in Ellner et al. (2016). We
will also use them as case studies in the next section. This example is
based on <em>Oenothera glazioviana</em>, a monocarpic plant that often
occurs in sand dune areas. For a monocarpic plant, we should keep in
mind that reproduction is fatal. The kernel function we will study is
<span
class="math display">\[K(z&#39;,z)=(1-p_b(z))s(z)G(z&#39;,z)+p_b(z)b(z)p_rC_1(z&#39;).\]</span>
We should notice that</p>
<ul>
<li>The factor <span class="math inline">\((1-p_b(z))\)</span> in the
survival/growth kernel represents the proportion of non-flowering
plants, as flowering plants die after reproduction.</li>
<li>Similar to Example 1, since we are unable to track parentage, the
recruit size distribution is independent of parental size <span
class="math inline">\(z\)</span>.</li>
</ul>
<figure>
<img src="oenothera-glazioviana.jpg"
alt="© Bernd Sauerwein, Oenothera glazioviana, Creative Commons CC BY-SA-3.0 license" />
<figcaption aria-hidden="true">© Bernd Sauerwein, <a
href="https://commons.wikimedia.org/wiki/File:Oenothera_glazioviana.jpg"><em>Oenothera
glazioviana</em></a>, <a
href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons
CC BY-SA-3.0 license</a></figcaption>
</figure>
<h4 id="example-3-ungulate">Example 3: ungulate</h4>
<p>Let’s look at a classic animal example, in which we are able to track
parental sizes. For animals, age or life stage (e.g. mature
vs. immature) plays a more important role in life history transitions.
Here we present a example of Soay sheep (<em>Ovis aries</em>), whose
demographic rates are assumed to be functions of body mass. The kernel
function is <span
class="math display">\[K(z&#39;,z)=s(z)G(z&#39;,z)+s(z)p_b(z)p_r\left(\frac{C_0(z&#39;,z)}{2}\right).\]</span>
We should notice that</p>
<ul>
<li>We are using post-reproduction census, so the survival rate <span
class="math inline">\(s(z)\)</span> appears in both survival/growth and
fecundity kernels.</li>
<li>We assume that a single lamb is born at each reproductive event, so
<span class="math inline">\(b(z)=1\)</span>.</li>
<li>The factor <span class="math inline">\(1/2\)</span> appears in the
fecundity kernel because we only track female population and an equal
sex ratio is assumed.</li>
<li>Since we know the parents of each newborn, the recruit size
distribution should be dependent on both <span
class="math inline">\(z\)</span> and <span
class="math inline">\(z&#39;\)</span>.</li>
</ul>
<figure>
<img src="soay-sheep.jpg"
alt="© gailhampshire, Soay sheep (Ovis aries), Creative Commons CC BY-2.0 license" />
<figcaption aria-hidden="true">© gailhampshire, <a
href="https://commons.wikimedia.org/wiki/File:Soay_Sheep._Ovis_aries_-_Flickr_-_gailhampshire.jpg">Soay
sheep (<em>Ovis aries</em>)</a>, <a
href="https://creativecommons.org/licenses/by/2.0/">Creative Commons CC
BY-2.0 license</a></figcaption>
</figure>
<h3
id="illustration-of-current-application-spatial-integral-projection-model">Illustration
of current application: spatial integral projection model</h3>
<p>As we mentioned earlier, the continuous variable <span
class="math inline">\(z\)</span> could be unrelated to “size”. Also,
<span class="math inline">\(z\)</span> could be multidimensional (Ellner
et al., 2016). Here we present a paper about spatial integral projection
models (SIPM) that include both demography and dispersal with continuous
variables.</p>
<blockquote>
<p>Jongejans, E., Shea, K., Skarpaas, O., Kelly, D. and Ellner, S.P.
(2011), Importance of individual and environmental variation for
invasive species spread: a spatial integral projection model.
<em>Ecology</em>, 92: 86-97.</p>
</blockquote>
<figure>
<img src="carduus-nutans.jpg"
alt="© Baykedevries, Carduus nutans, Creative Commons CC BY-SA-3.0 license" />
<figcaption aria-hidden="true">© Baykedevries, <a
href="https://commons.wikimedia.org/wiki/File:Carduus_nutans_NP_Schiermonnikoog.jpg"><em>Carduus
nutans</em></a>, <a
href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons
CC BY-SA-3.0 license</a></figcaption>
</figure>
<h4 id="snapshot-of-the-study-3">Snapshot of the study</h4>
<ul>
<li>The authors developed an SIPM by combining IPM with an analytical
method for modelling spatial spread, Neubert-Caswell Model (NCM). They
tested the SIPM on the invasive monocarpic thistle <em>Carduus
nutans</em> in New Zealand.</li>
<li>For the demographic process, the population is described by the size
distribution of rosettes, <span class="math inline">\(R(z,t)\)</span>,
<span class="math display">\[R(z&#39;,t+1)=\int_Z
K_{dem}(z&#39;,z)R(z,t)\ dz.\]</span></li>
<li>The vital rates underlie the demographic kernel <span
class="math inline">\(K_{dem}(z&#39;,z)\)</span> are <span
class="math display">\[K_{dem}=\underbrace{s(z)(1-p_b(z))G(z&#39;,z)}_{\text{survival/growth
kernel }P(z&#39;,z)}+\underbrace{s(z)p_b(z)b(z)p_r\omega(z)\phi
C_1(z&#39;)}_{\text{fecundity kernel }F(z&#39;,z)}.\]</span> Compared to
the above example of monocarpic perennials, the kernel is defined
differently;
<ul>
<li>Survival rate also appears in the fecundity kernel</li>
<li>Two more variables are introduced. <span
class="math inline">\(\omega(z)\)</span> is a size-dependent potential
flower head production term, and <span
class="math inline">\(\phi\)</span> is the probability that a potential
seed escapes florivory and becomes a seed.</li>
</ul></li>
<li>A seed bank is also considered in the model. Basically, the
existence of a seed bank requires the addition of a separate
discrete-state variable that is linked to <span
class="math inline">\(K_{dem}\)</span> by the proportion of newly
produced seeds that enter the seed bank, and the proportion of seeds in
the seed bank that survive and become seedlings. We will not discuss the
details, but Merow et al. (2014) provides some examples of plants with
seed banks.</li>
<li>Spatial population spread requires a dispersal kernel <span
class="math inline">\(K_{disp}(r)\)</span>, which is the probability
density function for seed dispersal distance <span
class="math inline">\(r\)</span>. The authors used an inverse Gaussian
distribution.</li>
<li>The SIPM that combines both demographic kernel and dispersal kernel
is described as a double integral <span
class="math display">\[\mathbf{n}(x&#39;,z&#39;,t+1)=\iint
K(x&#39;,z&#39;,x,z)\mathbf{n}(x,z,t)\ dxdz,\]</span> where <span
class="math inline">\(\mathbf{n}(x,z,t)\)</span> is the structured
population stage vectors at location <span
class="math inline">\(x\)</span> with size <span
class="math inline">\(z\)</span> at time <span
class="math inline">\(t\)</span>. <span
class="math inline">\(K(x&#39;,z&#39;,x,z)\)</span> is the combined
demography and dispersal kernel, which is defined as follows <span
class="math display">\[K(x&#39;,z&#39;,x,z)=K_{disp}(x&#39;-x)F(z&#39;,z)+\delta(x&#39;-x)P(z&#39;,z),\]</span>
with <span class="math inline">\(\delta(\cdot)\)</span> the <a
href="https://mathworld.wolfram.com/DeltaFunction.html">Dirac delta
function</a> (<span class="math inline">\(\delta(x&#39;-x)=0\)</span>
for all <span class="math inline">\(x&#39;\neq x\)</span> and <span
class="math inline">\(\delta(x&#39;-x)=1\)</span> for <span
class="math inline">\(x&#39;=x\)</span>)
<ul>
<li><em>Note</em>: Only new seeds disperse, while all other life stages
are sessile.</li>
</ul></li>
</ul>
<h3 id="reference">Reference</h3>
<p>Easterling, M.R., Ellner, S.P. and Dixon, P.M. (2000), Size-specific
sensitivity: applying a new structured population model.
<em>Ecology</em>, 81: 694-708.</p>
<p>Ellner, S.P. and Rees, M. (2006), Integral projection models for
species with complex demography. <em>Am Nat.</em>, 167(3): 410-28.</p>
<p>Ellner, S.P., Childs, D.Z. and Rees, M. (2016), <em>Data-driven
Modelling of Structured Populations</em>. Springer Cham.</p>
<p>Merow, C., Dahlgren, J.P., Metcalf, C.J.E., Childs, D.Z., Evans,
M.E.K., Jongejans, E., Record, S., Rees, M., Salguero-Gómez, R. and
McMahon, S.M. (2014), Advancing population ecology with integral
projection models: a practical guide. <em>Methods Ecol Evol</em>, 5:
99-110.</p>
<p>Metcalf, C., Rose, K., Childs, D., Sheppard, A., Grubb, P. and Rees,
M. (2008), Evolution of flowering decisions in a stochastic,
density-dependent environment. <em>Proceedings of the National Academy
of Sciences</em>, 105: 10466.</p>
<h3 id="the-first-step-of-ipms-regressions">The first step of IPMs:
regressions</h3>
<p>To perform an IPM model, regression models are commonly fit to vital
rate data relative to relevant state variables. Such models include
linear or logistic regressions, or non-linear models such as generalized
additive models (GAMs). Candidate models can be assessed using the
Akaike information criteria (AIC), which you were introduced to in the
section <a
href="https://www.ecotheory.ca/teach/BIOL652.html#model-selection-how-do-we-tell-which-model-to-use-for-our-data">Model
Selection</a>. The dynamics for each vital rate can be modelled by the
commonly used examples below:</p>
<table>
<caption>Functions commonly used for vital rates</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Vital_rate</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Survival</td>
<td style="text-align: left;">Logistic regression (generalized linear
model with binomial link function)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Growth</td>
<td style="text-align: left;">Linear model with normal error
distribution</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Probability of life-history transition
(eg., flowering)</td>
<td style="text-align: left;">Poisson regression (generalized linear
model with log link function)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Offspring number (eg., fruit number)</td>
<td style="text-align: left;">Logistic regression (generalized linear
model with binomial link function)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recruit size distribution</td>
<td style="text-align: left;">Normal or log-normal distribution</td>
</tr>
</tbody>
</table>
<p>→ Note that it is not always necessary to use the above mentioned
regressions. For example, functions can be used when there is no data
available for growth. One illustration is the IPM model for grass carp
developed by Erickson et al. (2017), where the growth function consisted
of a normal distribution with 2 variables centered around a modified von
Bertalanffy function of fish length at each time step. A derivative was
then calculated to map length changes as a function of length.</p>
<h3
id="how-do-we-go-about-implementing-an-ipm-for-our-species-of-interest">How
do we go about implementing an IPM for our species of interest?</h3>
<p>This diagram shows the main steps to implement an IPM. You have
already learnt about the steps in blue (first, second, and last
step).</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/flowchart.jpg"
data-dpi="300" alt="Flowchart of the key steps to build an IPM" />
<figcaption aria-hidden="true">Flowchart of the key steps to build an
IPM</figcaption>
</figure>
<p>In addition to using regression models for vital rates, performing an
IPM involves combining functions into a projection kernel, dividing
kernels into classes (bins), and integrating between them to calculate
transition rates. An iterative analysis of IPMs output ensures the model
is improved so that it is biologically plausible. After obtaining the
overall kernel corresponding to a large matrix, the same population
analyses performed for matrix projection models (MPMs) can be carried
out, such as stable distribution and sensitivity analyses.</p>
<h3 id="numerical-integration-methods-midpoint-rule">Numerical
integration methods: midpoint rule</h3>
<p>A projection kernel obtained in IPMs is analogous to projection
matrices of MPMs, as <span class="math inline">\(hK(z_j, z_i)\)</span>
is an <span class="math inline">\(m\times m\)</span> matrix (Gonzalez et
al., 2021). To create an IPM kernel, we need to put vital rate functions
together. To calculate the probability of transitioning to the next size
within each group (or bin), the midpoint rule is a commonly used
integration technique consisting of dividing the size range into several
groups <em>m</em> with an equal length <em>h</em>.
<em>z<sub>i</sub></em> is the midpoint of the <em>i<sub>th</sub></em>
size class:</p>
<p><span class="math display">\[n(z_j,t+1)\approx
h\sum_{i=1}^mK(z_j,z_i)n(z_i,t)\]</span></p>
<h3 id="model-diagnostics-and-improvement">Model diagnostics and
improvement</h3>
<p>During the iterative process of model output analysis, we can improve
specific functions to better correspond to the observed patterns in our
data. Consider these possibilities:</p>
<ul>
<li><p>If size measurements become more variable in larger individuals,
growth variance can be added as a function of size</p></li>
<li><p>A fecundity function can be changed to add the probability of
reproduction, which is more realistic considering that we do not observe
reproduction in all individuals (Merow et al, 2014).</p></li>
</ul>
<p>In these cases, population analyses can be re-done and compared to
previously run IPMs, where we can check how such improvements affect
population dynamics projections.</p>
<ul>
<li><p>In terms of survival, an important error to check for is called
<strong>eviction</strong>:</p></li>
<li><p>Eviction consists of individuals transitioning to size classes
which are outside the range selected for the model, thus impacting
survival projections.</p></li>
<li><p>To diagnose eviction, you can plot the relevant matrix elements
against the fitted survival model and check for discrepancies. Misplaced
individuals can then be returned to the next size class within the
established range for the IPM (Merow et al, 2014).</p></li>
</ul>
<p>To verify if a given IPM model is biologically realistic, we can
calculate several life history events such as life expectancy and
maximum size, and observe how well the model describes our species.</p>
<h3 id="case-study-an-ipm-for-snapping-turtles">Case study: an IPM for
snapping turtles</h3>
<p>Armstrong and colleagues (2018) studied the importance of
indeterminate growth to ectotherm population dynamics. We used the <a
href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.2j05h">dataset</a>
provided in their publication to obtain growth, reproduction and
survival information for a female population of North American snapping
turtles (<em>Chelydra serpentina</em>).</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/IPM_implementation_files/turtle.jpg"
data-fig.width="180" data-fig.height="120" data-dpi="300"
alt="Common snapping turtle, Creative Commons Attribution-Share Alike 3.0 Unported license" />
<figcaption aria-hidden="true"><a
href="https://commons.wikimedia.org/wiki/File:Common_Snapping_Turtle_%28Chelydra_serpentina%29.jpg">Common
snapping turtle</a>, <a
href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">Creative
Commons Attribution-Share Alike 3.0 Unported license</a></figcaption>
</figure>
<p>Because measurements were made across several years, we selected the
2 greatest size measurements and the largest fecundity measurement for
surviving individuals, and the latest measurement for non-surviving
individuals. New recruits (eg., individual in the 3rd row below) are
individuals initially measured at the latest years of the data
collection process.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the dataset</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/kcudding/kcudding.github.io/main/teach/snapping_turtles.csv&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>,<span class="at">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>NA    ID surv size sizeNext   fec
NA 1 767    1 26.3     26.4 300.4
NA 2 C15    1 26.9     26.9 365.0
NA 3 J09   NA   NA     27.3    NA
NA 4 H04    1 30.2     30.3    NA
NA 5 T19    1 25.7     26.0    NA
NA 6 H18    1 28.5     28.5    NA</code></pre>
<p>We will demonstrate the regression for reproduction:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After setting up an empty data frame to store model parameters, we proceed with our Poisson regression for reproduction</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>fec.reg<span class="ot">=</span><span class="fu">glm</span>(fec<span class="sc">~</span>size,<span class="at">data=</span>d,<span class="at">family=</span><span class="fu">poisson</span>())</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>params<span class="sc">$</span>offsp.int<span class="ot">=</span><span class="fu">coefficients</span>(fec.reg)[<span class="dv">1</span>]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>params<span class="sc">$</span>offsp.slope<span class="ot">=</span><span class="fu">coefficients</span>(fec.reg)[<span class="dv">2</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fec.reg)</span></code></pre></div>
<pre><code>NA 
NA Call:
NA glm(formula = fec ~ size, family = poisson(), data = d)
NA 
NA Deviance Residuals: 
NA     Min       1Q   Median       3Q      Max  
NA -35.189   -1.742    1.345    4.119   16.884  
NA 
NA Coefficients:
NA             Estimate Std. Error z value Pr(&gt;|z|)    
NA (Intercept) 2.880108   0.039448   73.01   &lt;2e-16 ***
NA size        0.110536   0.001365   80.99   &lt;2e-16 ***
NA ---
NA Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
NA 
NA (Dispersion parameter for poisson family taken to be 1)
NA 
NA     Null deviance: 28996  on 247  degrees of freedom
NA Residual deviance: 22496  on 246  degrees of freedom
NA   (50 observations deleted due to missingness)
NA AIC: 24272
NA 
NA Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you can continue creating regressions for survival and growth</span></span></code></pre></div>
<p>Here are the observations and the model fit:</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/IPM_implementation_files/unnamed-chunk-5-1.jpeg"
data-dpi="300"
alt="Reproduction regression for snapping turtles. Bullets are observations and the regression is shown as a curve displaying the relationship between size and clutch mass at time t." />
<figcaption aria-hidden="true">Reproduction regression for snapping
turtles. Bullets are observations and the regression is shown as a curve
displaying the relationship between size and clutch mass at time
t.</figcaption>
</figure>
<p>Now it is time to define a function to predict the reproduction of
our population (and the same should be done for the other vital
rates):</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>f.yx<span class="ot">=</span><span class="cf">function</span>(xp,x,params) {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>params<span class="sc">$</span>establishment.prob<span class="sc">*</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(xp,<span class="at">mean=</span>params<span class="sc">$</span>recruit.size.mean,<span class="at">sd=</span>params<span class="sc">$</span>recruit.size.sd)<span class="sc">*</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(params<span class="sc">$</span>offsp.int<span class="sc">+</span>params<span class="sc">$</span>offsp.slope<span class="sc">*</span>x)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To make a kernel, define the matrix size, size range, boundary
points, mesh points, and step size:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>min.size<span class="ot">=</span>.<span class="dv">9</span><span class="sc">*</span><span class="fu">min</span>(<span class="fu">c</span>(d<span class="sc">$</span>size,d<span class="sc">$</span>sizeNext),<span class="at">na.rm=</span>T)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>max.size<span class="ot">=</span><span class="fl">1.1</span><span class="sc">*</span><span class="fu">max</span>(<span class="fu">c</span>(d<span class="sc">$</span>size,d<span class="sc">$</span>sizeNext),<span class="at">na.rm=</span>T)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span> <span class="co"># amount of cells in the matrix</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>min.size<span class="sc">+</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n)<span class="sc">*</span>(max.size<span class="sc">-</span>min.size)<span class="sc">/</span>n <span class="co"># boundary points (edges of matrix)</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fl">0.5</span><span class="sc">*</span>(b[<span class="dv">1</span><span class="sc">:</span>n]<span class="sc">+</span>b[<span class="dv">2</span><span class="sc">:</span>(n<span class="sc">+</span><span class="dv">1</span>)]) <span class="co"># mesh points (matrix points for midpoint evaluation)</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>h<span class="ot">=</span>y[<span class="dv">2</span>]<span class="sc">-</span>y[<span class="dv">1</span>] <span class="co"># step size  (widths)</span></span></code></pre></div>
<p>The IPM matrices can now be created using the regression parameters
and the settings we have just defined. First, individual matrices are
created for growth, reproduction, and survival. The function outer() is
used to create the kernels for growth and fecundity by evaluating all
pairwise combinations of vectors y in the 2 step sizes. Next, the full
matrix is obtained by matrix multiplication and addition:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>G<span class="ot">=</span>h<span class="sc">*</span><span class="fu">outer</span>(y,y,g.yx,<span class="at">params=</span>params) <span class="co"># growth matrix</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>S<span class="ot">=</span><span class="fu">s.x</span>(y,<span class="at">params=</span>params) <span class="co"># survival matrix</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>F<span class="ot">=</span>h<span class="sc">*</span><span class="fu">outer</span>(y,y,f.yx,<span class="at">params=</span>params) <span class="co"># reproduction matrix</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>P<span class="ot">=</span>G <span class="co"># placeholder; P is redefined on the next line</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) P[,i]<span class="ot">=</span>G[,i]<span class="sc">*</span>S[i] <span class="co"># growth/survival matrix</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>K<span class="ot">=</span>P<span class="sc">+</span>F <span class="co"># full matrix</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>K[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>NA            [,1]        [,2]        [,3]        [,4]
NA [1,] 0.01356862 0.006496844 0.002771060 0.001054831
NA [2,] 0.02704795 0.014710977 0.007123565 0.003073257
NA [3,] 0.04685952 0.028954228 0.015925250 0.007799033
NA [4,] 0.07055157 0.049528484 0.030947537 0.017213692</code></pre>
<p>IPMs can also be obtained by using R packages, such as IPMpack:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;IPMpack&quot;</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a regression object for each vital rate, such as:</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>survival_object<span class="ot">&lt;-</span><span class="fu">makeSurvObj</span>(my_dataset,surv<span class="sc">~</span>size)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This package has built-in functions to evaluate different models within each vital rate</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create an IPM matrix</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>IPMmatrix<span class="ot">&lt;-</span><span class="fu">makeIPMPmatrix</span>(<span class="at">survObj=</span>survival_object,<span class="at">growObj=</span>growth_object,</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">minSize=</span>minSize,<span class="at">maxSize=</span>maxSize)</span></code></pre></div>
<p>After obtaining an IPM matrix, population analyses can be performed
in a similar fashion as in MPMs, such as asymptotic population growth
rate, stable stage structure, reproductive values, sensitivities and
elasticities, which you have already learnt about here: <a
href="hhttps://www.ecotheory.ca/teach/BIOL652.html#structured-population-models">Structured
Population Models</a></p>
<p>Now let’s exemplify one of the possible quality checks to our IPM:
checking for eviction, or individuals outside the size range impacting
our survival model. For the sake of this example, we excluded a few
large non-surviving individuals to reduce the variance and improve the
model fit when doing the regression.</p>
<p>We begin by plotting probabilities and observed values:</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/IPM_implementation_files/unnamed-chunk-9-1.jpeg"
data-dpi="300"
alt="Eviction check: plotting probability of survival and model values. The line shows the fitted survival model and the dots display observed values from model (column sums of growth/survival matrix)" />
<figcaption aria-hidden="true">Eviction check: plotting probability of
survival and model values. The line shows the fitted survival model and
the dots display observed values from model (column sums of
growth/survival matrix)</figcaption>
</figure>
<p>And here we see that eviction is mostly occurring among large
individuals. To correct this, we can modify our matrix to place evicted
individuals at the closest bin within the model boundaries (eg.,
individuals which are too small are placed in the bin for the smallest
size, and individuals who are too big are placed in the bin for the
largest size).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loop to fix eviction of small individuals</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)) {</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>G[<span class="dv">1</span>,i]<span class="ot">&lt;-</span>G[<span class="dv">1</span>,i]<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(G[,i])</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>P[,i]<span class="ot">&lt;-</span>G[,i]<span class="sc">*</span>S[i]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># loop to fix eviction of large individuals</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> (n<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>G[n,i]<span class="ot">&lt;-</span>G[n,i]<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(G[,i])</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>P[,i]<span class="ot">&lt;-</span>G[,i]<span class="sc">*</span>S[i]</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ...and we recalculate our kernels:</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>F<span class="ot">=</span>h<span class="sc">*</span><span class="fu">outer</span>(y,y,f.yx,<span class="at">params=</span>params) <span class="co"># reproduction</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>K<span class="ot">=</span>P<span class="sc">+</span>F <span class="co"># full matrix</span></span></code></pre></div>
<p>Let’s plot our new column sums and see if our data looks better
now:</p>
<figure>
<img
src="https://raw.github.com/kcudding/kcudding.github.io/main/teach/IPM_implementation_files/unnamed-chunk-11-1.jpeg"
data-dpi="300"
alt="Eviction check: plotting probability of survival and model values. The line shows the fitted survival model and the dots display observed values from model (column sums of growth/survival matrix)" />
<figcaption aria-hidden="true">Eviction check: plotting probability of
survival and model values. The line shows the fitted survival model and
the dots display observed values from model (column sums of
growth/survival matrix)</figcaption>
</figure>
<h2 id="references-5">References</h2>
<p>Armstrong, D. P., Keevil, M. G., Rollinson, N., &amp; Brooks, R. J.
(2018). Subtle individual variation in indeterminate growth leads to
major variation in survival and lifetime reproductive output in a
long‐lived reptile. <em>Functional Ecology, 32</em>(3), 752-761.</p>
<p>Doak, D. F., Waddle, E., Langendorf, R. E., Louthan, A. M., Isabelle
Chardon, N., Dibner, R. R., … &amp; DeMarche, M. L. (2021). A critical
comparison of integral projection and matrix projection models for
demographic analysis. <em>Ecological Monographs, 91</em>(2), e01447.</p>
<p>Erickson, R. A., Eager, E. A., Brey, M. K., Hansen, M. J., &amp;
Kocovsky, P. M. (2017). An integral projection model with YY-males and
application to evaluating grass carp control. Ecological Modelling, 361,
14-25.</p>
<p>Gonzalez, E.J., Childs, D.Z., Quintana-Ascencio, P.F. and
Salguero-Gomez, R. (2021), Integral projection models. In:
<em>Demographic Methods Across the Tree of Life</em>. Edited by Roberto
Salguero-Gomez and Marlene Gamelon, Oxford University Press.</p>
<p>Merow, C., Dahlgren, J. P., Metcalf, C. J. E., Childs, D. Z., Evans,
M. E., Jongejans, E., … &amp; McMahon, S. M. (2014). Advancing
population ecology with integral projection models: a practical guide.
<em>Methods in Ecology and Evolution, 5</em>(2), 99-110.</p>
<h2 id="density-dependence-in-ipm">Density dependence in IPM</h2>
<p>Like in unstructured population models and matrix population models,
density-dependence also occurs in integral projection models. However, a
general guide to building density-dependent IPMs is impossible, as there
are too many possibilities. Any demographic rate can be affected by
competition, and the dependence can take many possible forms. So
instead, we will present this section by first introducing a famous
example of density-dependent recruitment on Platte thistle (<em>Cirsium
canescens</em>). Then, we will explain the theories behind the model
construction.</p>
<h3 id="modeling-density-dependence">Modeling density dependence</h3>
<p>Platte thistle (<em>Cirsium canescens</em>) is a native thistle
species endemic to North America. Its population demography is strongly
affected by an invasive herbivore insect <em>Rhinocyllus conicus</em>.
Rose et al. (2005) tried to determine how demographic rates of Platte
thistle varied with plant size and damage by <em>R. conicus</em>.</p>
<figure>
<img src="platte_thistle_1.jpg" style="width:70.0%"
alt="© Jerry Oldenettel, Cirsium canescens. AKA(Platt Thistle)., Creative Commons CC BY-NC-SA 2.0 license" />
<figcaption aria-hidden="true">© Jerry Oldenettel, <a
href="https://www.flickr.com/photos/jroldenettel/1734332992">Cirsium
canescens. AKA(Platt Thistle).</a>, <a
href="https://creativecommons.org/licenses/by-nc-sa/2.0/">Creative
Commons CC BY-NC-SA 2.0 license</a></figcaption>
</figure>
<h4 id="recruitment-with-density-dependence">Recruitment with density
dependence</h4>
<p>For a plant that reproduces by seeds, the number of new recruits in a
given year is proportional to the number of seeds produced the previous
year. Based on Rose et al. (2005), <span class="math inline">\(Recruits
= Seeds^{0.67}\)</span> for <em>Cirsium canescens</em>.</p>
<p><img src="plant_dd_ipm.jpeg"
alt="Relationship between the number of recruits at time t+1 and the number of seeds at time t." />
{width=80%}</p>
<p>The seed set number of Platte thistle (<em>Cirsium canescens</em>) is
affected by two different factors:</p>
<ul>
<li><p>Plant size.</p></li>
<li><p>The egg number of inflorescence-feeding weevil <em>R.
conicus</em>.</p></li>
</ul>
<p>Therefore, the seed set function <span
class="math inline">\(b(z)\)</span> can be defined as a result of two
submodels: A function of plant size; and a negative binomial
distribution for the number of <em>R. conicus</em> eggs with mean
depending on plant size.</p>
<p><span class="math display">\[ b(z) =
e^{(-0.55+2.02z)}\times(1+\frac{ε(z)}{16})^{-0.32} \]</span> where <span
class="math inline">\(z\)</span> is the size measure, <span
class="math inline">\(ε\)</span> is the mean number of <em>R.
conicus</em> eggs oviposited on a plant of size <span
class="math inline">\(z\)</span>.</p>
<p>All the other demographic rates are density-independent: (Rose et
al., 2005)</p>
<ul>
<li><p>Flowering probability <span
class="math inline">\(p_b(z)\)</span>: logit <span
class="math inline">\(p_b = −10.22 + 4.25z\)</span></p></li>
<li><p>Mean <em>R. conicus</em> eggs per plant: <span
class="math inline">\(ε(z) = exp(e0 + 1.71z)\)</span></p></li>
<li><p>Seedling size <span class="math inline">\(c_0(z&#39;)\)</span>:
<span class="math inline">\(z&#39; ∼ Norm(μ = 0.75, σ^2 =
0.17)\)</span></p></li>
<li><p>Survival <span class="math inline">\(s(z)\)</span>: logit <span
class="math inline">\(s = −0.62 + 0.85z\)</span></p></li>
<li><p>Growth <span class="math inline">\(G(z&#39;,z)\)</span>: <span
class="math inline">\(z&#39; ∼ Norm(μ = 0.83 + 0.69z, σ^2 =
0.19)\)</span></p></li>
</ul>
<p><br></p>
<h4 id="fit-an-ipm-model-with-density-dependent-recruitment">Fit an IPM
model with density-dependent recruitment</h4>
<p>Now we can construct an IPM with density-dependent recruitment. The
survival kernel P is density-independent,</p>
<p><span class="math display">\[ P(z&#39;,z) = (1-p_b(z))s(z)G(z&#39;,z)
\]</span></p>
<p>The total number of seeds is</p>
<p><span class="math display">\[ S(t) =
\int_L^U{p_b(z)b(z)n(z,t)}dz\]</span></p>
<p>and they will produce <span
class="math inline">\(S(t)^{0.67}\)</span> recruits whose size
distribution is <span class="math inline">\(c_0(z&#39;)\)</span>.</p>
<p>Combining the recruits and the survivors, we have</p>
<p><span class="math display">\[ n(z&#39;,t+1) = c_0(z&#39;)S(t)^{0.67}
+ \int_L^U{P(z&#39;,z)n(z,t)}dz\\
= c_0(z&#39;)(\int_L^U{p_b(z)b(z)n(z,t)}dz)^{0.67} +
\int_L^U{(1-p_b(z))s(z)G(z&#39;,z)n(z,t)}dz \]</span></p>
<h3 id="theories-behind-density-dependent-ipm-models">Theories behind
density-dependent IPM models</h3>
<p>From the previous example, we built an IPM with density-dependent
recruitment. For IPMs, recall that the kernel <span
class="math inline">\(K\)</span> is consisted of two components:
survival <span class="math inline">\(P\)</span> and reproduction <span
class="math inline">\(F\)</span>. We can incorporate density-dependence
into either one of these two kernels, or both of them.</p>
<h4 id="ipms-with-density-dependent-reproduction">IPMs with
density-dependent reproduction</h4>
<p>For plants such as platte thistle, where competition only affects
seedling establishment. The survival kernel <span
class="math inline">\(P\)</span> is density-independent and the
reproduction kernel <span class="math inline">\(K\)</span> is
density-dependent. They can be written as</p>
<p><span class="math display">\[ P(z&#39;,z) = (1-p_b(z))s(z)G(z&#39;,z)
\]</span></p>
<p><span class="math display">\[ F(z&#39;,z,N) =
p_r(N)c_0(z&#39;)p_b(z)b(z) \]</span></p>
<p>To generalize, this type of density-dependent IPM can be written
as</p>
<p><span class="math display">\[ n(z&#39;,t+1) =
c_0(z&#39;)p_r(N(t))N(t) + \int_L^U{P(z&#39;,z)n(z,t)dz} \]</span></p>
<p>where <span class="math inline">\(N(t)\)</span> is the total seed
production</p>
<p><span class="math display">\[ N(t) = \int_L^U{p_b(z)b(z)n(z,t)}dz
\]</span></p>
<p>and <span class="math inline">\(p_r\)</span> is the density-dependent
recruitment probability, generally a decreasing function of population
density <span class="math inline">\(N\)</span>.</p>
<h4 id="ipms-with-density-dependent-survival">IPMs with
density-dependent survival</h4>
<p>IPMs with density-dependent survival kernel are far less common, but
can be constructed the same way. Recall that the survival kernel <span
class="math inline">\(P(z&#39;,z)\)</span> can be further separated into
survival probability <span class="math inline">\(s(z)\)</span> and size
transition <span class="math inline">\(G(z&#39;,z)\)</span>.
Biologically speaking, individual survival is more likely to be affected
by population density, so we incorporate density-dependence in the
survival probability component.</p>
<p><span class="math display">\[ P(z&#39;,z, N) = s(z,N)G(z&#39;,z)
\]</span></p>
<p>where <span class="math inline">\(s(z,N)\)</span> can be written as a
function of size and population density</p>
<p><span class="math display">\[ logit (s(z,N)) = \alpha_s +
\alpha_{s,z} + \beta_s^z*z + \beta_s^N*N \]</span></p>
<h3
id="application-of-density-dependent-ipm-to-an-ecological-problem">Application
of density-dependent IPM to an ecological problem</h3>
<p>Here we go back to the same soay sheep example that we have been
discussing. In the soay sheep population, density affects three
processes in the kernel:</p>
<ul>
<li><p>The probability that a newborn lamb successfully recruits into
the population, <span class="math inline">\(p_r\)</span>.</p></li>
<li><p>The size distribution of new recruits, <span
class="math inline">\(C_0\)</span>.</p></li>
<li><p>The survival of adults <span
class="math inline">\(s\)</span>.</p></li>
</ul>
<figure>
<img src="soay_ipm_dd.jpeg"
alt="(a) Density-dependent adult survival (solid line), and recruitment probability (dashed line) plotted over the observed range of female densities. (b) Offspring mean mass (as a proxy for offspring mean size) plotted over the observed range of female densities. Note that adult survival and offspring size are plotted for a typical-size adult female, z = 2.9. (code adapted from Ellner et al., 2016)" />
<figcaption aria-hidden="true">(a) Density-dependent adult survival
(solid line), and recruitment probability (dashed line) plotted over the
observed range of female densities. (b) Offspring mean mass (as a proxy
for offspring mean size) plotted over the observed range of female
densities. Note that adult survival and offspring size are plotted for a
typical-size adult female, z = 2.9. (code adapted from Ellner et al.,
2016)</figcaption>
</figure>
<p>To construct a density-dependent IPM model on soay sheep, we first
define the true population parameters (data and code from Ellner et al.,
2016):</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>m.par.true <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="do">## survival (density dependent)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">surv.int  =</span>  <span class="fl">1.06e+0</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">surv.z    =</span>  <span class="fl">2.09e+0</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">surv.Nt   =</span> <span class="sc">-</span><span class="fl">1.80e-2</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                <span class="do">## growth (NOT density dependent)</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">grow.int  =</span>  <span class="fl">1.41e+0</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">grow.z    =</span>  <span class="fl">5.57e-1</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">grow.sd   =</span>  <span class="fl">7.99e-2</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                <span class="do">## reproduce or not (NOT density dependent)</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">repr.int  =</span> <span class="sc">-</span><span class="fl">7.23e+0</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">repr.z    =</span>  <span class="fl">2.60e+0</span>,                </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>                <span class="do">## recruit or not (density dependent)</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">recr.int  =</span>  <span class="fl">4.43e+0</span>,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">recr.Nt   =</span> <span class="sc">-</span><span class="fl">9.19e-3</span>,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>                <span class="do">## recruit size (density dependent)</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">rcsz.int  =</span>  <span class="fl">5.40e-1</span>,</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">rcsz.z    =</span>  <span class="fl">7.10e-1</span>,</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">rcsz.Nt   =</span> <span class="sc">-</span><span class="fl">6.42e-4</span>,</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">rcsz.sd   =</span>  <span class="fl">1.59e-1</span>)</span></code></pre></div>
<p>From literature data we can define the three density-dependent
demographic functions:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Recruitment function (N.B - from birth in spring to first summer), logistic regression</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>pr_z <span class="ot">&lt;-</span> <span class="cf">function</span>(Nt, m.par) {</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    linear.p <span class="ot">&lt;-</span> m.par[<span class="st">&quot;recr.int&quot;</span>] <span class="sc">+</span> m.par[<span class="st">&quot;recr.Nt&quot;</span>] <span class="sc">*</span> Nt</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>linear.p))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Recruit size function</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>c_z1z <span class="ot">&lt;-</span> <span class="cf">function</span>(z1, z, Nt, m.par) {</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    mean <span class="ot">&lt;-</span> m.par[<span class="st">&quot;rcsz.int&quot;</span>] <span class="sc">+</span> m.par[<span class="st">&quot;rcsz.Nt&quot;</span>] <span class="sc">*</span> Nt <span class="sc">+</span> m.par[<span class="st">&quot;rcsz.z&quot;</span>] <span class="sc">*</span> z</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    sd <span class="ot">&lt;-</span> m.par[<span class="st">&quot;rcsz.sd&quot;</span>]</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    p.den.rcsz <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z1, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p.den.rcsz)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival function, logistic regression</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>s_z <span class="ot">&lt;-</span> <span class="cf">function</span>(z, Nt, m.par) {</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    linear.p <span class="ot">&lt;-</span> m.par[<span class="st">&quot;surv.int&quot;</span>] <span class="sc">+</span> m.par[<span class="st">&quot;surv.Nt&quot;</span>] <span class="sc">*</span> Nt <span class="sc">+</span> m.par[<span class="st">&quot;surv.z&quot;</span>] <span class="sc">*</span> z </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>linear.p))                                                 </span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The growth and reproduction function are density-independent, we
define them as:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Growth function, given you are size z now returns the pdf of size z1 next time</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>g_z1z <span class="ot">&lt;-</span> <span class="cf">function</span>(z1, z, m.par) {</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    mean <span class="ot">&lt;-</span> m.par[<span class="st">&quot;grow.int&quot;</span>] <span class="sc">+</span> m.par[<span class="st">&quot;grow.z&quot;</span>] <span class="sc">*</span> z           </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    sd <span class="ot">&lt;-</span> m.par[<span class="st">&quot;grow.sd&quot;</span>]                                    </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    p.den.grow <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z1, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p.den.grow)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Reproduction function, logistic regression</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>pb_z <span class="ot">&lt;-</span> <span class="cf">function</span>(z, m.par) {</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    linear.p <span class="ot">&lt;-</span> m.par[<span class="st">&quot;repr.int&quot;</span>] <span class="sc">+</span> m.par[<span class="st">&quot;repr.z&quot;</span>] <span class="sc">*</span> z       </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>linear.p))                                 </span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With all the demographic function defined, now we can construct build
the IPM kernels P, F, and K:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the survival kernel</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>P_z1z <span class="ot">&lt;-</span> <span class="cf">function</span> (z1, z, Nt, m.par) {</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">s_z</span>(z, Nt, m.par) <span class="sc">*</span> <span class="fu">g_z1z</span>(z1, z, m.par) )</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the reproduction kernel</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>F_z1z <span class="ot">&lt;-</span> <span class="cf">function</span> (z1, z, Nt, m.par) {</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fl">0.5</span><span class="sc">*</span> <span class="fu">s_z</span>(z, Nt, m.par) <span class="sc">*</span> <span class="fu">pb_z</span>(z, m.par) <span class="sc">*</span> <span class="fu">pr_z</span>(Nt, m.par) <span class="sc">*</span>             <span class="fu">c_z1z</span>(z1, z, Nt, m.par) )</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="references-6">References</h3>
<p>Ellner, Stephen P., Dylan Z. Childs, and Mark Rees. 2016.
<em>Data-Driven Modelling of Structured Populations: A Practical Guide
to the Integral Projection Model.</em> Lecture Notes on Mathematical
Modelling in the Life Sciences. Switzerland: Springer.</p>
<p>“Example of a Simple, Stochastic, Kernel-Resampled Model with Density
Dependence.” n.d. Accessed March 27, 2023.</p>
<p>Rose, Karen E., Svata M. Louda, and Mark Rees. 2005. “Demographic and
Evolutionary Impacts of Native and Invasive Insect Herbivores on Cirsium
Canescens.” <em>Ecology (Durham) 86</em> (2): 453–65.
https://doi.org/10.1890/03-0697.</p>
<h3 id="environmental-stochasticity-in-ipms">Environmental stochasticity
in IPMs</h3>
<p>Vital rate functions can readily accommodate covariates, such as
environmental conditions, that help to predict individuals’ vital rates
above and beyond the state variable. For example, plant growth may be
determined both by its previous size, and the nutrient conditions in its
habitat.</p>
<figure>
<img src="plants-12-01367-g001.png"
alt="L. gibba plants grown under high and low total nitrogen and total phosphorus concentrations in nutrient solution (Varga et al. 2023) Open access MDPI" />
<figcaption aria-hidden="true"><em>L. gibba</em> plants grown under high
and low total nitrogen and total phosphorus concentrations in nutrient
solution (Varga et al. 2023) Open access MDPI</figcaption>
</figure>
<p>In the case, the growth kernal G is then a function fof the state
variable of size and nutrients as: <span
class="math inline">\(G(z&#39;|z, nutrients)\)</span>. Or, if these
nutrients vary through time we could then state that time dependence as
<span class="math inline">\(G(z&#39;|z, nutrients_t)\)</span></p>
<h3
id="example-temperature-dependent-growth-of-gilthead-seabream">Example:
Temperature dependent growth of gilthead seabream</h3>
<p>Heather et al. (2018) used this approach to explore how temperatures
in the Mediterranean might affect growth rates of gilthead seabream, an
important aquaculture species</p>
<figure>
<img src="Sparus_aurata_Sardegna.jpg"
alt="Roberto Pillon, CC BY 3.0 https://creativecommons.org/licenses/by/3.0, via Wikimedia Commons" />
<figcaption aria-hidden="true">Roberto Pillon, CC BY 3.0 <a
href="https://creativecommons.org/licenses/by/3.0"
class="uri">https://creativecommons.org/licenses/by/3.0</a>, via
Wikimedia Commons</figcaption>
</figure>
<p>The authors obtained 11 years of growth increments by examining the
otoliths of wild juvenile and adult fish caught between 2008–2011, and
water temperature from several locations in the Mediterranean.</p>
<figure>
<img src="otoliths.jpg" style="width:50.0%"
alt="Arne Hendriks, Attribution (CC BY 2.0)(https://creativecommons.org/licenses/by/2.0/)" />
<figcaption aria-hidden="true">Arne Hendriks, Attribution (CC BY
2.0)(https://creativecommons.org/licenses/by/2.0/)</figcaption>
</figure>
<p>Then they fitted a series of mixed effects models to account for
intrinsic (e.g. random individual effects) and extrinsic (e.g. water
temperature, random year effects) effects on the rate of otolith growth.
The best model (selected by AIC) included random effects of fish and
year, and fixed effects of otolith size at previous year and mean
Mediterranean summer temperature.</p>
<p>They subsequently used otolith annual increment width as a proxy for
individual-level growth within specified years, which was then coupled
with an allometry model to estimate fish body growth, to project the
impacts on growth under climate warming. The authors found about an ~8%
reduction in individual growth with a 1°C increase in mean summer water
temperature (Heather et al. 2018).</p>
<h3 id="general-stochastic-ipm">General stochastic IPM</h3>
<p>Of course, any of the kernels, or even multiple components of the
same kernel, could be dependent on environmental covariates that
fluctuate through time. More generally, we can note that the kernel is
dependent on time varying parameters in the vector, <span
class="math inline">\(\theta\)</span>, as:</p>
<p><span class="math display">\[n(z&#39;, t+1)=\int^U_L
K(z&#39;,z;\theta(t))n(z,t)dz\]</span></p>
<h3 id="two-methods-for-ipm-stochasticity">Two methods for IPM
stochasticity</h3>
<p>There are two basic approaches to building an IPM with environmental
stochasticity: 1. Kernel selection, or 2. Parameter selection</p>
<p>These methods are analogous to those used for matrix population
models, where one either chooses from a set of transition matrices at
random, or one chooses life history parameters from some relevant
distribution. However, for IPMs parameter selection must be followed by
constructing the relevant kernel.</p>
<h3 id="kernel-selection">Kernel Selection</h3>
<p>If we are starting from data: for each year in the study, a fitted
fixed-effects model gives us a vector of year-specific values for each
parameter, and a fitted mixed-effects model gives us a vector of fitted
values or posterior modes for each parameter. In either case, we
construct a set of kernels using each of the year-specific sets of
parameters, and then simulate the model by selecting from the set of
kernels at random.</p>
<p><strong>Kernel selection process</strong></p>
<ol type="1">
<li>Construct set of yearly kernels → 2) Select a kernel at random → 3)
Project the population forward one time step, and then repeat from
2).</li>
</ol>
<h3 id="parameter-selection">Parameter Selection</h3>
<p>If you have characterized the between-year variation in the
parameters using mixed-effects models, then you can sample from the
fitted distributions and build a unique kernel for each year that you
simulate.</p>
<p><strong>Parameter selection process</strong> 1) Simulate a parameter
vector from fitted distributions → 2) Construct kernel → 3) Project the
population forward one time step, then repeat from 1).</p>
<h3 id="advantages-and-disadvantages">Advantages and disadvantages</h3>
<p><strong>Kernel selection:</strong> An IPM using kernel selection runs
much faster than one using parameter selection, as all the kernels can
be constructed before iterating the model. Parameter estimation is
easier for kernel selection as you don’t have to worry about
correlations between different demographic processes. These correlations
are already “built in” to the year-specific parameter estimates.</p>
<p><strong>Parameter selection:</strong> Parameter selection is a little
slower, since for every year simulated we need to both randomly select
the kernel parameters, and then construct the kernel. It is unusual to
have sufficiently long datasets to characterize some times of important
environmental stochasticity, or we may wish to estimate the impacts of
future climate conditions, and parameter selection is important in these
cases. If we have functions that describe how parameters vary with
environmental variation we can take advantage of long term climate
datasets or climate projections</p>
<h3 id="examples">Examples</h3>
<p>Models in which demographic rates are functions of environmental
covariates are an important example of parameter selection. for example,
Dalgleish et al. (2011) modeled effects of precipitation and temperature
on all vital rates of three sage-brush steppe plants, including effects
of climate in previous years. Simmonds and Coulson (2015) linked vital
rates of Soay sheep on St. Kilda to the NAO (North Atlantic Oscillation)
index, based on previous studies of NAO effects.</p>
<h3 id="analysis-of-stochastic-ipms">Analysis of stochastic IPMS</h3>
<p>Much of the same analysis that we completed for stochastic matrix
models can be completed for stochastic IPMS We can: 1. estimate the long
run stochastic growth rate 2. determine how variance or covariance in
various model components impacts the growth rate 3. calculate
stochasticity sensitivity</p>
<h3 id="long-run-stochastic-growth-rate-lambda_s">Long run stochastic
growth rate, <span class="math inline">\(\lambda_S\)</span></h3>
<p>There are four main things to know about <span
class="math inline">\(\lambda_S\)</span>:</p>
<ol type="1">
<li><p>it exists,</p></li>
<li><p>it can be computed by simulation,</p></li>
<li><p>it can be approximated, and</p></li>
<li><p>there is a perturbation theory</p></li>
</ol>
<p>Overall, just about any analysis you could do for a
density-independent deterministic IPM or matrix model can also be done
for a density-independent stochastic IPM.</p>
<h3 id="lambda_s-does-exist"><span
class="math inline">\(\lambda_S\)</span> does exist</h3>
<p><span class="math inline">\(\lambda_S\)</span> is the long-term
growth rate of total population size N(t), exactly as in stochastic
matrix models:</p>
<p><span class="math display">\[\lim\limits_{t \to \infty}
\frac{1}{t}log(\frac{N(t+1)}{N(t)})=log \lambda_S\]</span></p>
<p>which exists, if the following assumptions hold: 1. the parameter
vectors <span class="math inline">\(\theta(t)\)</span> in equation must
be stationary, ergodic random variables (e.g. finite-order
autoregressive processes) 2. the kernel <span
class="math inline">\(K(z&#39;,z,\theta)\)</span> is a positive,
continuous function of its three arguments (piecewise functions are also
okay) 3. the distributions of all model parameters are bounded. (e.g.,
we may need to truncate Gaussian distributions at 99.99%
percentiles)</p>
<h3 id="we-can-compute-lambda_s">We can compute <span
class="math inline">\(\lambda_S\)</span></h3>
<p><span class="math inline">\(\lambda_S\)</span> is equal to the
average annual growth rate,</p>
<p><span class="math inline">\(log(\lambda_S)
=E[log(\frac{N(t+1)}{N(t)})]\)</span> where N(t) is total population
size at time t.</p>
<h3
id="we-can-approximate-lambda_s-using-tuljapurkars-small-fluctuations-approximation">We
can approximate <span class="math inline">\(\lambda_S\)</span> using
Tuljapurkar’s small fluctuations approximation</h3>
<p>The long run stochastic growth rate can be approximated using the IPM
version of Tuljapurkar’s small fluctuations approximation, which is
analogous to the approximation for matrix models: <span
class="math display">\[log \lambda_S \approx log \lambda_1 -
\frac{Var⟨v,K_tw⟩}{2\lambda^2_1}+\sum^\infty_{j=1} c_j,\]</span> where
the first term, <span class="math inline">\(\lambda_1\)</span>, is the
dominant eigenvalue of the mean kernel <span
class="math inline">\(\overline{K}\)</span>, in the second term, <span
class="math inline">\(K_t\)</span> is equal to <span
class="math inline">\(K(z&#39;,z;\theta(t))\)</span>, <span
class="math inline">\(v\)</span> and <span
class="math inline">\(w\)</span> are the left and right eigenvectors of
<span class="math inline">\(\overline{K}\)</span> scaled so that <span
class="math inline">\(\langle v,w\rangle = 1\)</span>, and <span
class="math inline">\(K_tw =\int_{Z} K_t(z&#39;,z)w(z)dz\)</span>.</p>
<p>The small fluctuation approximation is not only useful on its own, it
provides some insight into the impact of environmental stochasticity.
Most obviously, it demonstrates the importance of covariance amoung the
life history components.</p>
<h3 id="covariance-in-life-history-components">Covariance in life
history components</h3>
<p>Some recent studies have shown, for stochastic matrix models, that
both the between-year and within-year correlations among matrix entries
can have a significant impact on model predictions—it is not enough to
correctly specify the marginal distribution of each matrix entry. The
same issue occurs for stochastic IPM models</p>
<p>The second term in our approximation <span
class="math inline">\(-\frac{Var\langle v, K_t w
\rangle}{2\lambda^2_1}\)</span> indicates that variance in the life
history parameters is always going to decrease our growth rates.</p>
<p>We can write this term as:</p>
<p><span class="math display">\[-\frac{1}{2\lambda^2_1}\int\int\int\int
\boldsymbol{s}(z&#39;_2, z_2)\boldsymbol{s}(z&#39;_1,
z_1)Cov(K_t(z&#39;_2, z_2)K_t(z&#39;_1,
z_1))dz_1dz_2dz&#39;_1dz&#39;_2,\]</span></p>
<p>So that, analogous to our work in stochastic matrix models, we can
see that the impact of stochasticity in an IPM will be determined both
by covariance in the model elements and the sensitivity, <span
class="math inline">\(\boldsymbol{s}\)</span> of the mean kernel, to
these variance elements, where we need to integrate over all Z.</p>
<h3 id="correlation-in-environmental-fluctuations">Correlation in
environmental fluctuations</h3>
<p>The third term of our approximation <span
class="math inline">\(c_j\)</span> is the effect of environmental
correlations at time-lag j (i.e., between <span
class="math inline">\(\theta(t)\)</span> and <span
class="math inline">\(\theta(t - j)\)</span>). The formula for this term
is <span class="math display">\[c_j =E\langle v,M_jD^{l-1}M_0w
\rangle\]</span> where <span class="math inline">\(M_t = (K_t
-\overline{K})/\lambda_1\)</span> and <span class="math inline">\(D^m =
(\overline{K}/\lambda_1)^m -P_0\)</span> where <span
class="math inline">\(P_0(z&#39;,z) = v(z&#39;)w(z)\)</span> for <span
class="math inline">\(v,w\)</span> scaled so that <span
class="math inline">\(\langle v,w \rangle = 1\)</span> (see Rees and
Ellner (2009, Appendix C), which is a translation from Tuljapurkar
(1990) and Tuljapurkar and Haridas (2006) into IPM notation.</p>
<h4 id="stochastic-sensitivitivty">Stochastic sensitivitivty</h4>
<p>To calculate time-varying sensitivity we can use: <span
class="math display">\[\frac{\partial log \lambda_S}{\partial \epsilon}
= \frac{1}{\lambda_S}\frac{\partial log \lambda_S}{{\partial \epsilon}
}=E\left[\frac{\langle v_{t+1}, C_tw_t\rangle}{{\langle v_{t+1}, K_tw_t
\rangle}}\right]\]</span>, which is an IPM version of the matrix formula
from Tuljapurkar (1990). The formula describes a general perturbation of
<span class="math inline">\(K_t\)</span> to <span
class="math inline">\(K_t + \epsilon C_t\)</span> where <span
class="math inline">\(C_t = C(z&#39;, z; \theta_t)\)</span> is a
sequence of kernels such that the perturbed IPM satisfies the small
perturbation requirements.</p>
<p>The terms <span class="math inline">\(v_t\)</span>, and <span
class="math inline">\(w_t\)</span> are calculated from <span
class="math inline">\(t=0\)</span> to large time as: <span
class="math display">\[\tilde{w}_{t+1}=K_tw_t, w_{t+1}=\tilde{w}_{t+1}/
\int_Z \tilde{w}_{t+1}(z)dz\]</span> <span
class="math display">\[\tilde{v}_{t-1}=v_tK_t = \int_Z
v_{z&#39;}K_{t-1}(z&#39;,z)dz&#39;,\]</span> <span
class="math display">\[v_{t-1}=\tilde{v}_{t-1}/ \int_Z
\tilde{v}_{z}(z)dz\]</span>.</p>
<p>However, we note that for IPMs every possible perturbation to a
deterministic model is now tripled. We can examine: 1. a change in mean
2. a change in the standard deviation, or 3. do a fractional
perturbation (e.g., a 5% higher value each year) that changes both the
mean and the standard deviation (Tuljapurkar et al. 2003, 2004).</p>
<p>Therefore our stochasticity sensitivity equations can be used to
generate a giant list of perturbation formulas for changes to kernel
entries, demographic functions, and parameter values (see Table 7.2 in
Ellne, Rees and Ellner (2009; Appendices E and F))</p>
<p>We also note that the equation for sensitivity isn’t informative when
the right-hand side is 0, which will be true whenever the fluctuations
<span class="math inline">\(C_t\)</span> have zero mean and are
independent of the unperturbed kernel. In this case, we need to carry
the expansion out to second order in <span
class="math inline">\(\epsilon\)</span> for these cases.</p>
<h3 id="references-7">References</h3>
<p>Dalgleish, H. J., Koons, D. N., Hooten, M. B., Moffet, C. A., &amp;
Adler, P. B. (2011). Climate influences the demography of three dominant
sagebrush steppe plants. <em>Ecology</em>, <em>92</em>(1), 75-85.</p>
<p>Ellner, S. P., &amp; Rees, M. (2007). Stochastic stable population
growth in integral projection models: theory and application.
<em>Journal of mathematical biology</em>, <em>54</em>(2), 227-256.
https://link.springer.com/content/pdf/10.1007/s00285-006-0044-8.pdf</p>
<p>Heather, F. J., Childs, D. Z., Darnaude, A. M., &amp; Blanchard, J.
L. (2018). Using an integral projection model to assess the effect of
temperature on the growth of gilthead seabream Sparus aurata. PloS one,
13(5), e0196092.</p>
<p>Levin, S. C., Childs, D. Z., Compagnoni, A., Evers, S., Knight, T.
M., &amp; Salguero‐Gómez, R. (2021). ipmr: Flexible implementation of
Integral Projection Models in R. <em>Methods in Ecology and
Evolution</em>, <em>12</em>(10), 1826-1834.</p>
<p>Lindell, T., Ehrlén, J., &amp; Dahlgren, J. P. (2022). Weather‐driven
demography and population dynamics of an endemic perennial plant during
a 34‐year period. <em>Journal of Ecology</em>, <em>110</em>(3),
582-592.</p>
<p>Rees, M., &amp; Ellner, S. P. (2009). Integral projection models for
populations in temporally varying environments. <em>Ecological
Monographs</em>, <em>79</em>(4), 575-594.</p>
<p>Simmonds, E. G., &amp; Coulson, T. (2015). Analysis of phenotypic
change in relation to climatic drivers in a population of Soay sheep
Ovis aries. <em>Oikos</em>, <em>124</em>(5), 543-552.</p>
<p>Varga, M., Žuna Pfeiffer, T., Begović, L., Mlinarić, S., Horvatić,
J., Miloloža, T., &amp; Štolfa Čamagajevac, I. (2023). Physiological
response of nutrient-stressed <em>Lemna gibba</em> to pulse colloidal
silver treatment. <em>Plants</em>, <em>12</em>(6), 1367.</p>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
